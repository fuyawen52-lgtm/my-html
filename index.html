<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>集团每日日报</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
        }

        /* 确保页面内容容器自动伸展 */
        #pageContent {
            flex: 1;
        }

        header {
            background: #fff;
            box-shadow: 0 2px 8px rgba(200, 16, 46, 0.15);
            padding: 8px 30px;
            display: flex;
            align-items: center;
            position: sticky;
            top: 48px;
            z-index: 100;
            border-bottom: 1px solid #e8a4ad;
        }

        .logo {
            flex-shrink: 0;
        }

        .logo-img {
            width: auto;
            height: 50px;
            border-radius: 8px;
            object-fit: contain;
        }

        .search-box {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            max-width: 400px;
            width: 100%;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #f5c6cb;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
            background: #fff url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23c8102e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') no-repeat right 15px center;
        }

        .search-box input:focus {
            border-color: #c8102e;
            box-shadow: 0 0 10px rgba(200, 16, 46, 0.3);
        }

        .search-box input::placeholder {
            color: #999;
        }

        /* 顶部导航栏样式 */
        .top-nav {
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            box-shadow: 0 2px 10px rgba(200, 16, 46, 0.3);
            position: sticky;
            top: 0;
            z-index: 101;
        }

        /* 架构目录样式 */
        .architecture-menu {
            position: relative;
            width: 200px;
            min-height: 700px;
            height: 80vh;
            margin: 0;
            z-index: 1000;
            flex-shrink: 0;
        }

        .architecture-btn {
            width: 100%;
            padding: 15px 20px;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: #fff;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .architecture-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .architecture-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(200, 16, 46, 0.3);
            background: linear-gradient(135deg, #a80818 0%, #e85a2b 100%);
        }

        .architecture-btn:hover::before {
            left: 100%;
        }

        .dropdown-icon {
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        .architecture-btn.active .dropdown-icon {
            transform: rotate(180deg);
        }

        .architecture-dropdown {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.2);
            overflow: visible;
            max-height: 0;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .architecture-btn {
            position: relative;
            z-index: 1001;
        }

        .architecture-dropdown.active {
            max-height: 1000px;
            overflow-y: auto;
            opacity: 1;
            visibility: visible;
        }

        /* 滚动条样式 */
        .architecture-dropdown::-webkit-scrollbar {
            width: 8px;
        }

        .architecture-dropdown::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .architecture-dropdown::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        .architecture-dropdown::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .architecture-dropdown ul {
            list-style: none;
            margin: 0;
            padding: 10px 0;
        }

        .architecture-dropdown li {
            margin: 0;
        }

        .architecture-dropdown a {
            display: block;
            padding: 12px 20px;
            color: #fff;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .architecture-dropdown a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .architecture-dropdown a:hover {
            background: linear-gradient(135deg, #a80818 0%, #e85a2b 100%);
            transform: translateX(5px);
        }

        .architecture-dropdown a:hover::before {
            left: 100%;
        }

        /* 二级菜单样式 */
        .has-submenu {
            position: relative;
        }

        .submenu {
            position: static;
            width: 100%;
            background: #fff;
            border: 1px solid rgba(200, 16, 46, 0.2);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: none;
            transition: all 0.3s ease;
            z-index: 1000;
            padding: 0;
            margin: 0;
        }

        .submenu.active {
            display: block;
        }

        .submenu li {
            margin: 0;
        }

        .submenu a {
            display: block;
            padding: 10px 15px 10px 30px;
            color: #c8102e;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .submenu a:hover {
            background: rgba(200, 16, 46, 0.1);
            transform: translateX(5px);
        }

        .submenu a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(200, 16, 46, 0.1), transparent);
            transition: left 0.5s;
        }

        .submenu a:hover::before {
            left: 100%;
        }

        /* 三级菜单样式 */
        .submenu .has-submenu {
            position: relative;
        }

        .submenu .submenu {
            position: static;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(200, 16, 46, 0.1);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            display: none;
            transition: all 0.3s ease;
            z-index: 1000;
            padding: 0;
            margin: 0;
        }

        .submenu .submenu.active {
            display: block;
        }

        .submenu .submenu li {
            margin: 0;
        }

        .submenu .submenu a {
            display: block;
            padding: 8px 15px 8px 45px;
            color: #c8102e;
            text-decoration: none;
            font-size: 12px;
            font-weight: 400;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .submenu .submenu a:hover {
            background: rgba(200, 16, 46, 0.05);
            transform: translateX(3px);
        }

        .submenu .submenu a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(200, 16, 46, 0.05), transparent);
            transition: left 0.5s;
        }

        .submenu .submenu a:hover::before {
            left: 100%;
        }

        /* 组织页面布局 */
        .organization-layout {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            justify-content: center;
            width: 100%;
            max-width: none;
            margin: 0 auto;
            padding: 0 10px;
            min-height: 80vh;
        }

        /* 内容容器块样式 */
        .content-container {
            flex: 1;
            min-width: 300px;
            min-height: 700px;
            height: 80vh;
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            border: 2px solid rgba(200, 16, 46, 0.2);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.1);
        }

        /* 响应式布局 */
        @media (max-width: 1500px) {
            .info-box {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .organization-layout {
                flex-direction: column;
            }
            
            .architecture-menu {
                width: 100%;
            }
            
            .content-container {
                width: 100%;
                height: 500px;
            }
            
            .info-box {
                display: none;
            }
        }

        /* 知识图谱容器 */
        .knowledge-graph {
            width: 3000px;
            height: 3000px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
        }

        .knowledge-graph:active {
            cursor: grabbing;
        }

        .connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .connections line {
            stroke: url(#connectionGradient);
            stroke-width: 2;
            fill: none;
        }

        /* 画布包装器 */
        .canvas-wrapper {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        /* 节点样式 */
        .node {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
        }

        .ceo-node {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .coo-node,
        .cto-node,
        .cpo-node,
        .chro-node {
            transform: translate(-50%, -50%);
        }

        .node-text {
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            line-height: 1.3;
            position: relative;
            z-index: 1;
        }

        .node:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 10px 20px rgba(200, 16, 46, 0.4), 0 0 0 2px rgba(255, 255, 255, 0.2);
            z-index: 10;
        }

        .ceo-node:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .coo-node:hover,
        .cto-node:hover,
        .cpo-node:hover,
        .chro-node:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .f-node,
        .g-node,
        .c-node,
        .e-node,
        .pa-node,
        .td-node,
        .dc-node,
        .ob-node,
        .hr-node,
        .pb-node {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #e57373 0%, #ff8a65 100%);
            transform: translate(-50%, -50%);
        }

        .f-node:hover,
        .g-node:hover,
        .c-node:hover,
        .e-node:hover,
        .pa-node:hover,
        .td-node:hover,
        .dc-node:hover,
        .ob-node:hover,
        .hr-node:hover,
        .pb-node:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .support-node {
            width: 75px;
            height: 75px;
            background: linear-gradient(135deg, #ffab91 0%, #ffccbc 100%);
            transform: translate(-50%, -50%);
        }

        .support-node:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .node.selected {
            animation: glow 1.5s ease-in-out infinite;
        }

        .node.related-active {
            animation: glowRelated 1.5s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 30px rgba(200, 16, 46, 0.6), 0 0 60px rgba(255, 107, 53, 0.4);
            }
            50% {
                box-shadow: 0 0 40px rgba(200, 16, 46, 0.8), 0 0 80px rgba(255, 107, 53, 0.6);
            }
        }

        @keyframes glowRelated {
            0%, 100% {
                box-shadow: 0 0 20px rgba(255, 193, 7, 0.6), 0 0 40px rgba(255, 152, 0, 0.4);
            }
            50% {
                box-shadow: 0 0 30px rgba(255, 193, 7, 0.8), 0 0 60px rgba(255, 152, 0, 0.6);
            }
        }

        /* 连接线样式 */
        .connection-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, rgba(200, 16, 46, 0.4) 0%, rgba(255, 107, 53, 0.4) 100%);
            transform-origin: left center;
            z-index: 0;
        }

        /* 信息框样式 */
        .info-box {
            width: 450px;
            min-height: 700px;
            height: 80vh;
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            border: 2px solid rgba(200, 16, 46, 0.2);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.1);
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        .info-tabs {
            display: flex;
            border-bottom: 2px solid rgba(200, 16, 46, 0.2);
        }

        .info-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            position: relative;
        }

        .info-tab:hover {
            background: rgba(200, 16, 46, 0.05);
            color: #c8102e;
        }

        .info-tab.active {
            color: #c8102e;
        }

        .info-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
        }

        .info-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .info-panel {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #999;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .empty-state p {
            font-size: 14px;
            margin: 0;
        }

        .node-detail {
            display: none;
        }

        .node-detail.active {
            display: block;
        }

        .node-detail-title {
            font-size: 20px;
            font-weight: 700;
            color: #c8102e;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(200, 16, 46, 0.2);
        }

        .node-detail-section {
            margin-bottom: 25px;
        }

        .node-detail-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }

        .node-detail-section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            margin-right: 8px;
            border-radius: 2px;
        }

        .node-detail-content {
            font-size: 14px;
            color: #666;
            line-height: 1.8;
            padding-left: 12px;
        }

        .node-detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .node-detail-tag {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .node-detail-tag.subjective {
            background: rgba(200, 16, 46, 0.1);
            border: 1px solid rgba(200, 16, 46, 0.3);
            color: #c8102e;
        }

        .node-detail-tag.objective {
            background: rgba(0, 188, 212, 0.1);
            border: 1px solid rgba(0, 188, 212, 0.3);
            color: #00bcd4;
        }

        .node-detail-tag.abstract {
            background: rgba(156, 39, 176, 0.1);
            border: 1px solid rgba(156, 39, 176, 0.3);
            color: #9c27b0;
        }

        .node-detail-tag.concrete {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            color: #ffc107;
        }

        .node-detail-tag.cause {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            color: #2196f3;
        }

        .node-detail-tag.result {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid rgba(255, 152, 0, 0.3);
            color: #ff9800;
        }

        .node-detail-tag.intangible {
            background: rgba(233, 30, 99, 0.1);
            border: 1px solid rgba(233, 30, 99, 0.3);
            color: #e91e63;
        }

        .node-detail-tag.tangible {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }

        .top-nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .top-nav-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .top-nav-item {
            flex: 1;
            text-align: center;
        }

        .top-nav-link {
            display: block;
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .top-nav-item.active .top-nav-link {
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
            font-weight: 600;
        }

        .top-nav-item:hover .top-nav-link {
            color: #fff;
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .top-nav-item.active .top-nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 3px;
            background: #fff;
            border-radius: 3px;
        }

        .container {
            flex: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .organization-container {
            max-width: 100%;
            padding: 40px 10px;
        }

        /* 会议页面样式 */
        .meeting-container {
            position: relative;
            min-height: 80vh;
        }

        /* 文档档案库样式 */
        .document-archive {
            display: flex;
            gap: 40px;
            margin-top: 40px;
            min-height: 600px;
        }

        /* 文档位容器 */
        .document-slots {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 300px;
            flex-shrink: 0;
        }

        /* 文档位样式 */
        .document-slot {
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* 鼠标悬停效果 - 提起文档 */
        .document-slot:hover {
            transform: translateY(-8px) translateX(10px);
            z-index: 10;
        }

        /* 文档文件夹样式 */
        .document-folder {
            position: relative;
            width: 100%;
            height: 130px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px 12px 0 0;
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.1),
                0 1px 3px rgba(0, 0, 0, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            overflow: hidden;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
        }

        /* 文件夹悬停效果 */
        .document-folder:hover {
            transform: translateY(-5px) rotateX(2deg);
            box-shadow: 
                0 12px 24px rgba(0, 0, 0, 0.15),
                0 4px 8px rgba(0, 0, 0, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        /* 文件夹标签 */
        .folder-tab {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 25px;
            background: linear-gradient(90deg, #c8102e 0%, #ff6b35 100%);
            border-radius: 8px 12px 0 0;
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            z-index: 2;
        }

        /* 文件夹侧面 */
        .folder-side {
            position: absolute;
            top: 25px;
            left: 0;
            width: 15px;
            height: 105px;
            background: linear-gradient(180deg, #e63946 0%, #c1121f 100%);
            z-index: 1;
            transform: skewY(-3deg);
            transform-origin: top left;
            box-shadow: inset -2px 0 4px rgba(0, 0, 0, 0.1);
        }

        /* 文件夹内容 */
        .folder-content {
            position: absolute;
            top: 25px;
            left: 15px;
            width: calc(100% - 15px);
            height: 105px;
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            padding: 20px 25px;
            border: 1px solid #dee2e6;
            border-top: none;
            border-left: none;
            z-index: 0;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        /* 文件夹折角效果 */
        .document-folder::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 30px 30px 0;
            border-color: transparent #e9ecef transparent transparent;
            z-index: 3;
        }

        /* 文件夹折角阴影 */
        .document-folder::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 28px 28px 0;
            border-color: transparent #c8102e transparent transparent;
            z-index: 2;
        }

        /* 文档预览 */
        .document-preview {
            display: flex;
            align-items: center;
            gap: 15px;
            height: 100%;
            justify-content: flex-start;
        }

        /* 文档图标 */
        .document-icon {
            font-size: 24px;
            margin-right: 10px;
            flex-shrink: 0;
        }

        /* 文档信息 */
        .document-info {
            flex: 1;
        }

        /* 文档标题 */
        .document-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 文档日期 */
        .document-date {
            font-size: 12px;
            color: #999;
        }

        /* 右侧文档详情 */
        .document-details {
            flex: 1;
            min-width: 400px;
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            border: 2px solid rgba(200, 16, 46, 0.2);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.1);
            overflow: hidden;
        }

        /* 文档详情内容 */
        .document-details-content {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* 文档详情头部 */
        .document-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            background: linear-gradient(90deg, rgba(200, 16, 46, 0.1) 0%, rgba(255, 107, 53, 0.1) 100%);
            border-bottom: 1px solid rgba(200, 16, 46, 0.2);
        }

        .document-details-header h3 {
            margin: 0;
            color: #c8102e;
            font-size: 18px;
            font-weight: 600;
        }

        /* 关闭按钮 */
        .close-details {
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(200, 16, 46, 0.1);
            color: #c8102e;
            font-size: 18px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-details:hover {
            background: rgba(200, 16, 46, 0.2);
            transform: rotate(90deg);
        }

        /* 文档详情主体 */
        .document-details-body {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        /* 文档详情内容 */
        .document-content {
            animation: fadeIn 0.5s ease;
        }

        .document-content h4 {
            color: #c8102e;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(200, 16, 46, 0.2);
        }

        .document-content p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .document-content .meta-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .document-content .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
        }

        .document-content .meta-item .icon {
            color: #c8102e;
        }

        /* 文档飞出动画 */
        @keyframes documentFly {
            0% {
                transform: translateY(0) translateX(0) rotate(0);
                opacity: 1;
            }
            50% {
                transform: translateY(-50px) translateX(200px) rotate(15deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(0) translateX(0) rotate(0);
                opacity: 1;
            }
        }

        .document-slot.flying {
            animation: documentFly 1s ease;
        }

        /* 响应式布局 */
        @media (max-width: 768px) {
            .document-archive {
                flex-direction: column;
            }

            .document-slots {
                width: 100%;
                flex-direction: row;
                flex-wrap: wrap;
            }

            .document-slot {
                width: calc(50% - 8px);
            }

            .document-details {
                min-width: 100%;
                margin-top: 20px;
            }
        }

        .section-title {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px 0;
        }

        .title-decoration {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .decoration-line {
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, #c8102e 50%, transparent 100%);
        }

        .decoration-line.left {
            background: linear-gradient(90deg, transparent 0%, #c8102e 100%);
        }

        .decoration-line.right {
            background: linear-gradient(90deg, #c8102e 0%, transparent 100%);
        }

        .decoration-icon {
            color: #c8102e;
            font-size: 18px;
            margin: 0 15px;
        }

        .section-title h2 {
            font-size: 32px;
            color: #c8102e;
            font-weight: bold;
            letter-spacing: 8px;
            margin-bottom: 12px;
            text-shadow: 1px 1px 2px rgba(200, 16, 46, 0.1);
        }

        .section-title .subtitle {
            color: #666;
            font-size: 14px;
            letter-spacing: 4px;
            margin: 0;
        }

        .bookshelf {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 30px;
            padding: 20px;
        }

        .newspaper-card {
            background: #fff;
            border: 2px solid #e8a4ad;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.15);
        }

        .newspaper-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(200, 16, 46, 0.25);
            border-color: #c8102e;
        }

        .newspaper-cover {
            background: linear-gradient(135deg, #c8102e 0%, #8b0000 100%);
            height: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            position: relative;
            overflow: hidden;
        }

        .newspaper-cover::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.15) 50%, transparent 60%);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .newspaper-cover .issue {
            font-size: 48px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .newspaper-cover .label {
            font-size: 16px;
            margin-top: 10px;
            opacity: 0.9;
        }

        .newspaper-info {
            padding: 15px;
            background: #fef0f2;
        }

        .newspaper-info h3 {
            font-size: 16px;
            color: #c8102e;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .newspaper-info .date {
            font-size: 12px;
            color: #666;
        }

        .newspaper-info .tags {
            margin-top: 10px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .newspaper-info .tag {
            background: #fff;
            color: #c8102e;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            border: 1px solid #e8a4ad;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
            animation: fadeIn 0.3s;
            padding: 30px 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            background: #fff;
            width: 600px;
            height: 1100px;
            margin: 0 auto;
            position: relative;
            animation: slideUp 0.3s;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .newspaper-header {
            background: #fff;
            color: #c8102e;
            padding: 5px 25px 5px;
            text-align: center;
            position: relative;
            border-bottom: 3px solid #c8102e;
        }

        .newspaper-header .logo-area {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 5px;
            padding: 0 10px;
        }

        .newspaper-header .logo-area img {
            height: 40px;
            width: auto;
        }

        .newspaper-header .logo-area img:first-child {
            order: 1;
        }

        .newspaper-header .logo-area img:last-child {
            order: 2;
        }

        .newspaper-header .newspaper-name {
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 8px;
            flex: 1;
            text-align: center;
            padding-right: 50px;
            background: linear-gradient(135deg, #c8102e 0%, #e74c3c 50%, #c8102e 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            filter: drop-shadow(1px 1px 1px rgba(200, 16, 46, 0.3));
            font-family: 'SimHei', 'Microsoft YaHei', 'STHeiti', sans-serif;
        }

        .newspaper-header .divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, #c8102e, transparent);
            margin: 5px 0;
        }

        .newspaper-header .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            padding: 0 10px;
        }

        .newspaper-header .info-bar .issue {
            font-weight: bold;
            background: #c8102e;
            color: #fff;
            padding: 3px 12px;
            border-radius: 3px;
        }

        .newspaper-header .info-bar .slogan {
            font-size: 11px;
            letter-spacing: 2px;
            color: #666;
        }

        /* 调整info-bar布局，添加右侧操作区域 */
        .info-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .info-bar-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .share-btn {
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .share-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(200, 16, 46, 0.3);
        }

        /* 确保转发按钮在移动设备上也不会遮挡内容 */
        @media (max-width: 767px) {
            .info-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .info-bar-actions {
                width: 100%;
                justify-content: space-between;
                margin-top: 5px;
            }
            
            .share-btn {
                padding: 5px 12px;
                font-size: 12px;
            }
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: #fff;
            font-size: 18px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.4);
            transform: rotate(90deg);
        }

        .newspaper-body {
            padding: 40px 20px 15px;
            background: #fafafa;
            height: calc(100% - 100px);
            overflow: auto;
        }

        .section-block {
            background: #fff;
            border: 1px solid #e8e8e8;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: hidden;
            position: relative;
        }

        .section-block::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #c8102e 0%, #ff6b35 50%, #c8102e 100%);
            z-index: 1;
        }

        .section-block::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #c8102e 0%, #ff6b35 50%, #c8102e 100%);
            z-index: 1;
        }

        .section-block:last-child {
            margin-bottom: 0;
        }

        .section-block.party-section {
            height: 350px;
        }

        .section-block.party-section .section-content {
            height: 305px;
            overflow: hidden;
        }

        .two-columns .section-block {
            height: 285px;
        }

        .two-columns .section-block .section-content {
            height: 240px;
            overflow: hidden;
        }

        .section-title-bar {
            background: linear-gradient(90deg, 
                rgba(200, 16, 46, 0.15) 0%, 
                rgba(255, 255, 255, 0.7) 30%, 
                rgba(255, 255, 255, 0.7) 70%, 
                rgba(200, 16, 46, 0.15) 100%);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            color: #c8102e;
            padding: 0 15px;
            height: 45px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-top: 1px solid rgba(200, 16, 46, 0.25);
            border-bottom: 1px solid rgba(200, 16, 46, 0.25);
            position: relative;
            box-shadow: 
                0 2px 8px rgba(200, 16, 46, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        .section-title-bar::before {
            content: '★';
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #c8102e;
            font-size: 14px;
            text-shadow: 0 0 8px rgba(200, 16, 46, 0.4);
        }

        .section-title-bar::after {
            content: '★';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #c8102e;
            font-size: 14px;
            text-shadow: 0 0 8px rgba(200, 16, 46, 0.4);
        }

        .section-title-bar .icon {
            font-size: 16px;
            margin-left: 25px;
            color: #c8102e;
            text-shadow: 0 0 10px rgba(200, 16, 46, 0.3);
        }

        .section-title-bar .title {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 6px;
            color: #c8102e;
            flex: 1;
            font-family: 'PingFang SC', 'Microsoft YaHei UI', 'Source Han Sans SC', 'Noto Sans SC', sans-serif;
        }

        /* SVG艺术字红橙渐变效果 */
        .svg-title {
            font-size: 16px;
            font-weight: bold;
            letter-spacing: 4px;
            fill: url(#redOrangeGradientV);
        }

        .svg-title-main {
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 8px;
            fill: url(#redOrangeGradient);
        }

        .section-title-bar .tag {
            background: #c8102e;
            color: #fff;
            padding: 3px 10px;
            font-size: 10px;
            border-radius: 12px;
            letter-spacing: 1px;
            white-space: nowrap;
            box-shadow: 0 2px 4px rgba(200, 16, 46, 0.3);
            margin-right: 25px;
        }

        .section-content {
            padding: 15px;
        }

        .news-item {
            padding: 10px 0;
            border-bottom: 1px dashed #e0e0e0;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-item h4 {
            color: #c8102e;
            font-size: 13px;
            margin-bottom: 6px;
            line-height: 1.4;
        }

        .news-item p {
            color: #444;
            font-size: 11px;
            line-height: 1.6;
            text-align: justify;
        }

        .news-item .author {
            color: #888;
            font-size: 9px;
            margin-top: 6px;
            text-align: right;
        }

        .two-columns {
            display: grid;
            grid-template-columns: 3fr 7fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .two-columns.equal {
            grid-template-columns: 1fr 1fr;
        }

        .two-columns:last-child {
            margin-bottom: 0;
        }

        .two-columns .section-block {
            margin-bottom: 0;
        }

        .video-placeholder {
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 30px 10px;
            text-align: center;
            color: #888;
            font-size: 12px;
        }

        .video-placeholder .play-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.6;
        }

        .video-container {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-container:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(200, 16, 46, 0.2);
        }

        .video-container video {
            cursor: pointer;
        }

        .video-container .video-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            color: #fff;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .video-container:hover .video-hint {
            opacity: 1;
        }

        .video-expand-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .video-expand-modal.active {
            display: flex;
            opacity: 1;
        }

        .video-expand-content {
            width: 90%;
            max-width: 1000px;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .video-expand-modal.active .video-expand-content {
            transform: scale(1);
        }

        .video-expand-header {
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            color: #fff;
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-expand-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .video-expand-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .video-expand-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .video-expand-body {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: #fafafa;
        }

        .video-expand-body video {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            pointer-events: auto !important;
        }

        .video-expand-body video::-webkit-media-controls-panel {
            pointer-events: auto !important;
        }

        .video-expand-body video::-webkit-media-controls-timeline {
            pointer-events: auto !important;
        }

        .video-expand-body video::-webkit-media-controls-current-time-display,
        .video-expand-body video::-webkit-media-controls-time-remaining-display {
            pointer-events: auto !important;
        }

        .danmu-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - 40px);
            overflow: hidden;
            pointer-events: none;
            z-index: 10;
        }

        .danmu-item {
            position: absolute;
            white-space: nowrap;
            font-size: 18px;
            font-weight: 500;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8), 0 0 10px rgba(0, 0, 0, 0.5);
            padding: 5px 12px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            animation: danmuMove linear forwards;
        }

        @keyframes danmuMove {
            from {
                left: 100%;
            }
            to {
                left: -100%;
            }
        }

        .qa-item {
            background: #fef9f9;
            border-left: 3px solid #c8102e;
            padding: 8px 10px;
            margin-bottom: 8px;
        }

        .qa-item:last-child {
            margin-bottom: 0;
        }

        .qa-item .q {
            color: #c8102e;
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 4px;
        }

        .qa-item .a {
            color: #444;
            font-size: 10px;
            line-height: 1.5;
        }

        .practice-item {
            background: #f5f5f5;
            border-radius: 6px;
            padding: 8px 10px;
            margin-bottom: 8px;
        }

        .practice-item:last-child {
            margin-bottom: 0;
        }

        .practice-item .question {
            color: #333;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 6px;
        }

        .practice-item .options {
            font-size: 10px;
            color: #555;
            line-height: 1.6;
        }

        .practice-item .options div {
            margin: 2px 0;
        }

        .party-pages {
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .party-page {
            display: none;
            gap: 15px;
            flex: 1;
            animation: fadeIn 0.3s ease;
            align-items: center;
        }

        .party-page.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .party-page.active .content-left {
            animation: slideInLeft 0.5s ease forwards;
        }

        .party-page.active .media-right {
            animation: slideInRight 0.5s ease forwards;
        }

        .party-page h4 {
            transition: all 0.3s ease;
        }

        .party-page h4:hover {
            transform: translateX(5px);
            text-shadow: 2px 2px 4px rgba(200, 16, 46, 0.3);
        }

        .party-page p span {
            transition: all 0.3s ease;
            display: inline-block;
        }

        .party-page p span:hover {
            transform: scale(1.1);
            background: linear-gradient(180deg,transparent 60%,rgba(200,16,46,0.4) 60%) !important;
        }

        .media-placeholder {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .media-placeholder:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(200, 16, 46, 0.2);
            border: 2px solid #c8102e;
        }

        .media-placeholder .icon {
            transition: all 0.3s ease;
        }

        .media-placeholder:hover .icon {
            animation: pulse 1s ease infinite;
            color: #c8102e;
        }

        .party-dot {
            transition: all 0.3s ease;
        }

        .party-dot:hover {
            transform: scale(1.3);
            background: #ff6b35;
        }

        .party-dot.active {
            animation: pulse 2s ease infinite;
        }

        .party-image {
            position: relative;
            overflow: hidden;
        }

        .party-image img {
            transition: transform 0.5s ease;
        }

        .party-image:hover img {
            transform: scale(1.1);
        }

        .party-image .like-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(200, 16, 46, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .party-image.liked .like-overlay {
            opacity: 1;
            animation: likePop 0.6s ease forwards;
        }

        @keyframes likePop {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .like-particles {
            position: absolute;
            pointer-events: none;
        }

        .like-particle {
            position: absolute;
            color: #c8102e;
            font-size: 20px;
            animation: particleFloat 1s ease forwards;
        }

        @keyframes particleFloat {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-50px) scale(0.5); opacity: 0; }
        }

        @keyframes floatUp {
            0% { 
                transform: translate(-50%, -50%) scale(0.5); 
                opacity: 0;
            }
            20% { 
                transform: translate(-50%, -60%) scale(1.2); 
                opacity: 1;
            }
            40% { 
                transform: translate(-50%, -70%) scale(1); 
                opacity: 1;
            }
            100% { 
                transform: translate(-50%, -150%) scale(0.8); 
                opacity: 0;
            }
        }

        .like-float-text {
            background: linear-gradient(135deg, #c8102e, #ff6b35);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(200, 16, 46, 0.4);
        }

        .danmu-stats {
            animation: fadeIn 0.5s ease;
        }

        .danmu-tag {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .danmu-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(200, 16, 46, 0.3);
            background: linear-gradient(135deg, #c8102e, #ff6b35) !important;
            color: #fff !important;
            border-style: solid !important;
        }

        .danmu-tag.active {
            animation: tagPulse 0.5s ease;
            background: linear-gradient(135deg, #c8102e, #ff6b35) !important;
            color: #fff !important;
            border-style: solid !important;
        }

        @keyframes tagPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        .danmu-tag b {
            transition: all 0.3s ease;
        }

        /* AI新闻轮播样式 */
        .ai-news-container {
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .ai-news-pages {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .ai-news-page {
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            transition: all 0.5s ease;
            overflow: hidden;
        }

        .ai-news-page.active {
            opacity: 1;
            visibility: visible;
        }

        .ai-news-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 8px 0;
            background: #fafafa;
            border-top: 1px solid #f0f0f0;
            flex-shrink: 0;
        }

        .ai-news-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-news-dot.active {
            background: #c8102e;
            width: 20px;
            border-radius: 4px;
        }

        /* 新闻标题链接样式 */
        .news-link {
            color: #c8102e;
            text-decoration: underline;
            text-decoration-color: rgba(200, 16, 46, 0.3);
            text-underline-offset: 3px;
            transition: all 0.3s ease;
            position: relative;
            display: inline-block;
        }

        .news-link:hover {
            color: #ff6b35;
            text-decoration-color: #ff6b35;
            transform: translateX(3px);
        }

        .news-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #c8102e, #ff6b35);
            transition: width 0.3s ease;
        }

        .news-link:hover::after {
            width: 100%;
        }

        /* 实践题测验样式 */
        .practice-quiz-container {
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-quiz-container:hover {
            background: rgba(200, 16, 46, 0.02);
        }

        /* 放大弹窗样式 */
        .quiz-expand-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .quiz-expand-modal.active {
            display: flex;
            opacity: 1;
        }

        .quiz-expand-content {
            width: 600px;
            max-width: 90%;
            max-height: 80%;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .quiz-expand-modal.active .quiz-expand-content {
            transform: scale(1);
        }

        .quiz-expand-header {
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            color: #fff;
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quiz-expand-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quiz-expand-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .quiz-expand-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .quiz-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 10001;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .quiz-detail-modal.active {
            display: flex;
            opacity: 1;
        }

        .quiz-detail-content {
            width: 700px;
            max-width: 90%;
            max-height: 85%;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .quiz-detail-header {
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .quiz-detail-header h3 {
            margin: 0;
            font-size: 18px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quiz-detail-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .quiz-detail-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .quiz-detail-body {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
        }

        .quiz-detail-summary {
            background: linear-gradient(135deg, rgba(200, 16, 46, 0.05) 0%, rgba(255, 107, 53, 0.05) 100%);
            border: 1px solid #e8a4ad;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-detail-summary .score {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .quiz-detail-item {
            background: #fafafa;
            border: 1px solid #e8e8e8;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            transition: all 0.3s;
        }

        .quiz-detail-item:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quiz-detail-item.correct {
            border-left: 4px solid #52c41a;
            background: linear-gradient(90deg, rgba(82, 196, 26, 0.05) 0%, transparent 100%);
        }

        .quiz-detail-item.wrong {
            border-left: 4px solid #ff4d4f;
            background: linear-gradient(90deg, rgba(255, 77, 79, 0.05) 0%, transparent 100%);
        }

        .quiz-detail-question {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .quiz-detail-answer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: #666;
        }

        .quiz-detail-answer .label {
            font-weight: 500;
        }

        .quiz-detail-answer .value {
            color: #333;
        }

        .quiz-detail-answer .correct {
            color: #52c41a;
            font-weight: 600;
        }

        .quiz-detail-answer .wrong {
            color: #ff4d4f;
            font-weight: 600;
        }

        .quiz-expand-body {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
        }

        .quiz-expand-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
            color: #fff;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .practice-section:hover .quiz-expand-hint {
            opacity: 1;
        }

        .quiz-progress {
            flex-shrink: 0;
        }

        .quiz-question-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .quiz-options-wrapper {
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .quiz-option {
            position: relative;
            overflow: hidden;
            padding: 8px 12px !important;
            font-size: 12px !important;
            line-height: 1.4 !important;
        }

        .quiz-option.selected {
            border-color: #c8102e !important;
            background: rgba(200, 16, 46, 0.05) !important;
        }

        .quiz-option.correct {
            border-color: #52c41a !important;
            background: rgba(82, 196, 26, 0.1) !important;
            color: #52c41a !important;
        }

        .quiz-option.wrong {
            border-color: #ff4d4f !important;
            background: rgba(255, 77, 79, 0.1) !important;
            color: #ff4d4f !important;
        }

        .quiz-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .quiz-feedback {
            animation: fadeIn 0.3s ease;
            flex-shrink: 0;
            margin-top: 10px !important;
            padding: 8px 12px !important;
        }

        .quiz-feedback.correct {
            background: rgba(82, 196, 26, 0.1);
            border: 1px solid #52c41a;
            color: #52c41a;
        }

        .quiz-feedback.wrong {
            background: rgba(255, 77, 79, 0.1);
            border: 1px solid #ff4d4f;
            color: #ff4d4f;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .party-page .content-left {
            flex: 1;
        }

        .party-page .media-right {
            width: 140px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .media-placeholder {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            border: 1px dashed #c8102e;
            border-radius: 4px;
            padding: 20px 5px;
            text-align: center;
            font-size: 10px;
            color: #888;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .media-placeholder .icon {
            font-size: 24px;
            margin-bottom: 5px;
            opacity: 0.5;
        }

        .party-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 5px 0 0;
            margin-top: -10px;
            position: relative;
            z-index: 10;
        }

        .party-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .party-dot.active {
            background: #c8102e;
            width: 20px;
            border-radius: 4px;
        }

        .ai-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 8px;
            vertical-align: middle;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            display: none;
        }

        .empty-state.active {
            display: block;
        }

        .empty-state .icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            color: #c8102e;
            margin-bottom: 10px;
        }

        .empty-state p {
            color: #666;
        }

        footer {
            background: linear-gradient(135deg, #c8102e 0%, #a80818 100%);
            text-align: center;
            padding: 25px;
            color: rgba(255,255,255,0.9);
            border-top: 2px solid #8b0000;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 60px;
            padding: 30px;
            background: linear-gradient(135deg, #fef0f2 0%, #fff 100%);
            border-bottom: 1px solid #e8a4ad;
        }

        .stat-item {
            text-align: center;
        }

        .stat-item .number {
            font-size: 32px;
            font-weight: bold;
            color: #c8102e;
        }

        .stat-item .label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
                padding: 10px 15px;
            }

            .search-box {
                width: 100%;
                max-width: 100%;
                margin: 0;
                position: static;
                transform: none;
            }

            .search-box input {
                padding: 10px 15px;
                font-size: 14px;
            }

            .bookshelf {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 15px;
                padding: 10px;
            }

            .stats-bar {
                flex-wrap: wrap;
                gap: 20px;
                padding: 15px 10px;
            }

            .stat-item .number {
                font-size: 24px;
            }

            .stat-item .label {
                font-size: 12px;
            }

            .newspaper-cover {
                height: 180px;
            }

            .newspaper-cover-title {
                font-size: 18px;
            }

            .newspaper-cover-subtitle {
                font-size: 10px;
            }

            .newspaper-info {
                padding: 10px;
            }

            .newspaper-issue {
                font-size: 12px;
            }

            .newspaper-date {
                font-size: 11px;
            }

            .top-nav-link {
                padding: 10px 8px;
                font-size: 13px;
            }

            #dailyPage .container {
                padding: 20px 10px;
            }

            .organization-layout {
                flex-direction: column;
                gap: 15px;
                padding: 10px;
            }

            .architecture-menu {
                width: 100%;
                min-height: auto;
                height: auto;
            }

            .content-container {
                width: 100%;
                min-height: 400px;
                height: 500px;
            }

            .info-box {
                display: none;
            }

            .section-title {
                margin-bottom: 10px;
            }

            .section-title svg {
                width: 220px;
                height: 35px;
            }

            .subtitle {
                font-size: 12px;
            }

            .modal-content {
                width: 100%;
                height: 100vh;
                border-radius: 0;
                margin: 0;
            }

            .modal-body {
                padding: 15px 10px;
            }

            .two-columns {
                flex-direction: column;
                gap: 15px;
            }

            .section-box {
                padding: 12px;
            }

            .section-title-bar {
                padding: 8px 10px;
            }

            .section-title-bar .icon {
                font-size: 14px;
            }

            .section-title-bar .tag {
                font-size: 10px;
                padding: 2px 6px;
            }

            .party-content {
                padding: 10px;
            }

            .party-page-title {
                font-size: 14px;
            }

            .party-page-desc {
                font-size: 11px;
            }

            .party-image {
                height: 150px;
            }

            .ai-qa-item {
                padding: 8px 10px;
            }

            .ai-qa-question {
                font-size: 12px;
            }

            .ai-qa-answer {
                font-size: 11px;
            }

            .ai-video-container {
                height: 150px;
            }

            .ai-video-desc {
                font-size: 11px;
                padding: 8px;
            }

            .ai-news-item {
                padding: 8px 10px;
            }

            .ai-news-title {
                font-size: 12px;
            }

            .ai-news-desc {
                font-size: 11px;
            }

            .practice-quiz-container {
                padding: 10px;
            }

            .quiz-option {
                padding: 8px 10px;
                font-size: 12px;
            }

            .close-btn {
                top: 10px;
                right: 10px;
                width: 32px;
                height: 32px;
                font-size: 18px;
            }

            .share-btn {
                bottom: 15px;
                right: 15px;
                width: 45px;
                height: 45px;
                font-size: 20px;
            }

            .logo-img {
                height: 40px;
            }

            .modal-header {
                padding: 12px 15px;
            }

            .modal-header h2 {
                font-size: 16px;
            }

            .modal-header p {
                font-size: 11px;
            }
        }

        @media (max-width: 480px) {
            .bookshelf {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .newspaper-cover {
                height: 150px;
            }

            .newspaper-cover-title {
                font-size: 16px;
            }

            .top-nav-link {
                padding: 8px 6px;
                font-size: 12px;
            }

            .stats-bar {
                gap: 15px;
            }

            .stat-item .number {
                font-size: 20px;
            }

            .section-title svg {
                width: 180px;
                height: 30px;
            }

            .subtitle {
                font-size: 11px;
            }

            .modal-body {
                padding: 10px 8px;
            }

            .section-box {
                padding: 10px;
            }

            .party-image {
                height: 120px;
            }

            .ai-video-container {
                height: 120px;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .bookshelf {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 20px;
            }

            .newspaper-cover {
                height: 220px;
            }

            .modal-content {
                width: 90%;
                max-width: 700px;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="top-nav">
        <div class="top-nav-container">
            <ul class="top-nav-menu">
                <li class="top-nav-item active" data-page="daily">
                    <a href="javascript:void(0)" class="top-nav-link" onclick="switchPage('daily')">日报</a>
                </li>
                <li class="top-nav-item" data-page="organization">
                    <a href="javascript:void(0)" class="top-nav-link" onclick="switchPage('organization')">组织</a>
                </li>
                <li class="top-nav-item" data-page="meeting">
                    <a href="javascript:void(0)" class="top-nav-link" onclick="if(confirm('待开发')) { switchPage('daily'); } else { return false; }">会议</a>
                </li>
                <li class="top-nav-item" data-page="project">
                    <a href="javascript:void(0)" class="top-nav-link" onclick="if(confirm('待开发')) { switchPage('daily'); } else { return false; }">项目</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- SVG艺术字定义 -->
    <svg width="0" height="0" style="position:absolute;">
        <defs>
            <!-- 红橙渐变 -->
            <linearGradient id="redOrangeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#c8102e;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#ff6b35;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#c8102e;stop-opacity:1" />
            </linearGradient>
            <!-- 红橙渐变垂直 -->
            <linearGradient id="redOrangeGradientV" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#ff6b35;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#c8102e;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#8b0000;stop-opacity:1" />
            </linearGradient>
        </defs>
    </svg>
    <header>
        <div class="logo">
            <img src="images/985fb8e021cb545bbb56779357129d7.png?v=1.0" class="logo-img" alt="公司Logo">
        </div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="搜索期数，如：第 100 期" onkeyup="searchNewspaper()">
        </div>
        <div class="organization-title" style="display:none;position:absolute;left:50%;transform:translateX(-50%);max-width:400px;width:100%;">
            <svg width="400" height="40" viewBox="0 0 400 40" style="display:block;margin:0 auto;">
                <linearGradient id="orangeYellowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#ff6b35;stop-opacity:1" />
                    <stop offset="50%" style="stop-color:#ffd93d;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ff6b35;stop-opacity:1" />
                </linearGradient>
                <text x="200" y="30" text-anchor="middle" fill="url(#orangeYellowGradient)" style="font-family:'SimHei','Microsoft YaHei','STHeiti',sans-serif;font-size:24px;font-weight:bold;">超职无忧组织架构</text>
            </svg>
        </div>
    </header>

    <!-- 页面内容容器 -->
    <div id="pageContent">
        <!-- 日报页面内容 -->
        <div id="dailyPage" class="page-content">
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="number" id="totalIssues">0</div>
                    <div class="label">总期数</div>
                </div>
                <div class="stat-item">
                    <div class="number" id="totalViews">0</div>
                    <div class="label">累计浏览</div>
                </div>
                <div class="stat-item">
                    <div class="number" id="totalCompleted">0</div>
                    <div class="label">累计完成量</div>
                </div>
            </div>

            <div class="container">
                <div class="section-title" style="margin-bottom:15px;padding:10px 0;">
                    <div class="title-decoration" style="margin-bottom:8px;">
                        <span class="decoration-line left"></span>
                        <span class="decoration-icon">★</span>
                        <span class="decoration-line right"></span>
                    </div>
                    <svg width="300" height="45" viewBox="0 0 300 45" style="display:block;margin:0 auto;">
                        <text x="150" y="35" text-anchor="middle" class="svg-title-main" style="font-family:'SimHei','Microsoft YaHei','STHeiti',sans-serif;">集团智能日报</text>
                    </svg>
                    <p class="subtitle" style="margin-top:5px;">智创侨乡 · 牢记使命 · 砥砺前行</p>
                </div>

                <div class="bookshelf" id="bookshelf">
                </div>

                <div class="empty-state" id="emptyState">
                    <div class="icon">🔍</div>
                    <h3>未找到相关日报</h3>
                    <p>请尝试其他期数搜索</p>
                </div>
            </div>
        </div>

        <!-- 组织页面内容 -->
        <div id="organizationPage" class="page-content" style="display:none;">
            <div class="container organization-container">
                <div class="organization-layout">
                    <!-- 架构目录按钮 -->
                    <div class="architecture-menu">
                        <div style="position:relative;">
                            <button class="architecture-btn" onclick="toggleArchitectureMenu()">
                                <span>架构目录</span>
                                <span class="dropdown-icon">▼</span>
                            </button>
                            <div class="architecture-dropdown" id="architectureDropdown">
                        <ul>
                            <li class="has-submenu">
                                <a href="javascript:void(0)" onclick="toggleSubmenu(this)">战略决策层 ▶</a>
                                <ul class="submenu">
                                    <li><a href="#">首席执行官（CEO)</a></li>
                                    <li><a href="#">首席运营官（COO)</a></li>
                                    <li><a href="#">首席技术官(CTO）</a></li>
                                    <li><a href="#">首席产品官（CPO）</a></li>
                                    <li><a href="#">首席人力资源官(CHRO)</a></li>
                                </ul>
                            </li>
                            <li class="has-submenu">
                                <a href="javascript:void(0)" onclick="toggleSubmenu(this)">业务经营层 ▶</a>
                                <ul class="submenu">
                                    <li><a href="#">F端事业部</a></li>
                                    <li><a href="#">E端事业部</a></li>
                                    <li><a href="#">C端事业部</a></li>
                                    <li><a href="#">G端事业部</a></li>
                                    <li><a href="#">客服中心</a></li>
                                    <li><a href="#">保障服务部</a></li>
                                    <li><a href="#">商务合作部</a></li>
                                    <li><a href="#">培训服务部</a></li>
                                    <li><a href="#">电商服务部</a></li>
                                    <li><a href="#">调解仲裁中心</a></li>
                                </ul>
                            </li>
                            <li class="has-submenu">
                                <a href="javascript:void(0)" onclick="toggleSubmenu(this)">技术支撑层 ▶</a>
                                <ul class="submenu">
                                    <li class="has-submenu">
                                        <a href="javascript:void(0)" onclick="toggleSubmenu(this)">产品中台 ▶</a>
                                        <ul class="submenu">
                                            <li><a href="#">产品架构组</a></li>
                                            <li><a href="#">功能协调组</a></li>
                                            <li><a href="#">用户体验组</a></li>
                                            <li><a href="#">账户权限组</a></li>
                                            <li><a href="#">交易订单组</a></li>
                                            <li><a href="#">任务匹配组</a></li>
                                            <li><a href="#">消息管理组</a></li>
                                        </ul>
                                    </li>
                                    <li class="has-submenu">
                                        <a href="javascript:void(0)" onclick="toggleSubmenu(this)">技术中台 ▶</a>
                                        <ul class="submenu">
                                            <li><a href="#">技术开发中心</a></li>
                                            <li><a href="#">研发效能组</a></li>
                                            <li><a href="#">云端数据组</a></li>
                                            <li><a href="#">基础设施组</a></li>
                                            <li><a href="#">中间件与架构组</a></li>
                                            <li><a href="#">安全与风控组</a></li>
                                        </ul>
                                    </li>
                                    <li class="has-submenu">
                                        <a href="javascript:void(0)" onclick="toggleSubmenu(this)">数据中台 ▶</a>
                                        <ul class="submenu">
                                            <li><a href="#">数据中心</a></li>
                                            <li><a href="#">数据治理组</a></li>
                                            <li><a href="#">API接口组</a></li>
                                            <li><a href="#">算法优化组</a></li>
                                            <li><a href="#">数据研发组</a></li>
                                            <li><a href="#">数仓维护组</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="has-submenu">
                                <a href="javascript:void(0)" onclick="toggleSubmenu(this)">运营管理层 ▶</a>
                                <ul class="submenu">
                                    <li><a href="#">董事办公室</a></li>
                                    <li><a href="#">行政部</a></li>
                                    <li><a href="#">人力资源部</a></li>
                                    <li><a href="#">财务部</a></li>
                                    <li><a href="#">法务部</a></li>
                                    <li><a href="#">采购部</a></li>
                                    <li><a href="#">战略发展部</a></li>
                                    <li><a href="#">传讯部</a></li>
                                    <li><a href="#">工会</a></li>
                                    <li><a href="#">审计及风控委员会</a></li>
                                    <li><a href="#">公共事业部</a></li>
                                    <li><a href="#">物流部</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                        </div>
                    </div>
                    <!-- 内容容器块 -->
                    <div class="content-container" id="contentContainer">
                        <div class="canvas-wrapper" id="canvasWrapper">
                            <div class="knowledge-graph" id="knowledgeGraph">
                                <svg class="connections" id="connections">
                                    <defs>
                                        <linearGradient id="connectionGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" style="stop-color:rgba(200, 16, 46, 0.4);stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:rgba(255, 107, 53, 0.4);stop-opacity:1" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                
                                <div class="node ceo-node" onclick="selectNode(this)" 
                                     data-title="首席执行官（CEO）" 
                                     data-intro="首席执行官（CEO）是公司的最高行政负责人，负责制定公司的整体战略方向，领导管理团队，确保公司实现其商业目标和长期愿景。"
                                     data-responsibilities="1. 制定和执行公司整体战略规划<br>2. 领导高级管理团队，协调各部门运作<br>3. 代表公司对外进行重要商务谈判和合作<br>4. 监督公司财务状况和业务绩效<br>5. 塑造企业文化，推动创新和变革"
                                     data-goals="1. 实现公司年度营收和利润目标<br>2. 提升市场竞争力和品牌影响力<br>3. 建立可持续发展的商业模式<br>4. 培养和保留核心人才<br>5. 推动技术创新和业务拓展"
                                     data-tags='[{"name":"战略领导","type":"subjective"},{"name":"团队管理","type":"objective"},{"name":"创新驱动","type":"abstract"},{"name":"业务拓展","type":"concrete"},{"name":"战略制定","type":"cause"},{"name":"商业成功","type":"result"},{"name":"企业愿景","type":"intangible"},{"name":"组织建设","type":"tangible"}]'
                                     data-relationships='[{"target":"cto-node","forward":"提供方向","backward":"提供方案"},{"target":"coo-node","forward":"提供目标","backward":"提供指标"},{"target":"cpo-node","forward":"提供战略","backward":"提供规划"},{"target":"chro-node","forward":"提供规模","backward":"提供体系"}]'>
                                    <span class="node-text">首席执行官（CEO）</span>
                                </div>
                                
                                <div class="node coo-node" onclick="selectNode(this)"
                                     style="top: 35%; left: 35%;"
                                     data-title="首席运营官（COO）"
                                     data-intro="首席运营官（COO）负责公司的日常运营管理，确保各项业务流程高效运转，协调各部门资源，推动公司战略的有效执行。"
                                     data-responsibilities="1. 监督和管理公司日常运营活动<br>2. 优化业务流程，提高运营效率<br>3. 协调各部门之间的工作配合<br>4. 制定运营策略和执行计划<br>5. 监控运营指标，及时调整策略"
                                     data-goals="1. 提升运营效率，降低成本<br>2. 确保服务质量达到标准<br>3. 建立高效的运营管理体系<br>4. 推动数字化转型和流程优化<br>5. 提升客户满意度和忠诚度"
                                     data-tags='[{"name":"运营思维","type":"subjective"},{"name":"流程管理","type":"objective"},{"name":"体系优化","type":"abstract"},{"name":"效率提升","type":"concrete"},{"name":"流程改进","type":"cause"},{"name":"运营成功","type":"result"},{"name":"运营文化","type":"intangible"},{"name":"成本降低","type":"tangible"}]'>
                                    <span class="node-text">首席运营官（COO）</span>
                                </div>
                                
                                <div class="node cto-node" onclick="selectNode(this)"
                                     style="top: 35%; left: 65%;"
                                     data-title="首席技术官（CTO）"
                                     data-intro="首席技术官（CTO）负责公司的技术战略制定和技术团队管理，推动技术创新，确保技术架构能够支撑业务发展需求。"
                                     data-responsibilities="1. 制定公司技术发展战略<br>2. 领导技术团队进行产品研发<br>3. 评估和引入新技术方案<br>4. 管理技术架构和系统安全<br>5. 推动技术创新和数字化转型"
                                     data-goals="1. 建立领先的技术架构<br>2. 提升产品技术竞争力<br>3. 确保系统稳定和安全<br>4. 培养技术人才团队<br>5. 推动技术创新应用"
                                     data-tags='[{"name":"技术视野","type":"subjective"},{"name":"架构管理","type":"objective"},{"name":"创新思维","type":"abstract"},{"name":"技术实现","type":"concrete"},{"name":"技术选型","type":"cause"},{"name":"技术突破","type":"result"},{"name":"技术文化","type":"intangible"},{"name":"系统交付","type":"tangible"}]'>
                                    <span class="node-text">首席技术官（CTO）</span>
                                </div>
                                

                                
                                <div class="node pa-node" onclick="selectNode(this)"
                                     style="top: 75%; left: 25%;"
                                     data-title="产品架构组"
                                     data-intro="产品架构组负责设计和管理公司产品的技术架构，确保系统架构的稳定性、可扩展性和安全性。"
                                     data-responsibilities="1. 设计产品技术架构<br>2. 优化系统性能和稳定性<br>3. 制定技术规范和标准<br>4. 评估技术方案可行性<br>5. 推动架构创新和升级"
                                     data-goals="1. 建立高可用架构体系<br>2. 实现99.99%系统可用性<br>3. 建立标准化技术规范<br>4. 支持10倍业务扩展<br>5. 打造行业领先架构"
                                     data-tags='[{"name":"架构思维","type":"subjective"},{"name":"系统设计","type":"objective"},{"name":"稳定意识","type":"abstract"},{"name":"架构优化","type":"concrete"},{"name":"架构规划","type":"cause"},{"name":"系统稳定","type":"result"},{"name":"架构价值","type":"intangible"},{"name":"架构交付","type":"tangible"}]'
                                     data-relationships='[{"target":"cpo-node","forward":"提供原型","backward":"提供架构"}]'>
                                    <span class="node-text">产品架构组</span>
                                </div>
                                
                                <!-- 功能协调组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 65%; left: 15%;"
                                     data-title="功能协调组"
                                     data-intro="功能协调组负责协调产品各功能模块之间的交互和流程，确保系统功能的一致性和完整性。"
                                     data-responsibilities="1. 协调功能模块交互<br>2. 优化业务流程<br>3. 解决功能冲突<br>4. 推动功能整合<br>5. 建立功能规范"
                                     data-goals="1. 实现功能无缝集成<br>2. 优化业务流程效率<br>3. 建立功能协调机制<br>4. 提升用户体验<br>5. 打造一体化功能体系"
                                     data-tags='[{"name":"协调思维","type":"subjective"},{"name":"流程优化","type":"objective"},{"name":"系统意识","type":"abstract"},{"name":"功能整合","type":"concrete"},{"name":"需求协调","type":"cause"},{"name":"功能完善","type":"result"},{"name":"协调价值","type":"intangible"},{"name":"功能交付","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供流程","backward":"提供交互"}]'>
                                    <span class="node-text">功能协调组</span>
                                </div>
                                
                                <!-- 用户体验组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 75%; left: 35%;"
                                     data-title="用户体验组"
                                     data-intro="用户体验组负责产品的用户体验设计和测试，确保产品能够提供良好的用户体验。"
                                     data-responsibilities="1. 设计用户界面<br>2. 进行用户体验测试<br>3. 收集用户反馈<br>4. 优化用户流程<br>5. 建立用户体验标准"
                                     data-goals="1. 提升用户满意度<br>2. 降低用户操作难度<br>3. 建立优秀的用户体验体系<br>4. 推动用户体验创新<br>5. 打造用户喜爱的产品"
                                     data-tags='[{"name":"用户思维","type":"subjective"},{"name":"体验设计","type":"objective"},{"name":"创新意识","type":"abstract"},{"name":"测试验证","type":"concrete"},{"name":"需求分析","type":"cause"},{"name":"体验提升","type":"result"},{"name":"品牌价值","type":"intangible"},{"name":"测试报告","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供反馈","backward":"提供测试"}]'>
                                    <span class="node-text">用户体验组</span>
                                </div>
                                
                                <!-- 账户权限组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 85%; left: 25%;"
                                     data-title="账户权限组"
                                     data-intro="账户权限组负责产品的账户管理和权限控制，确保用户账户的安全和权限的合理分配。"
                                     data-responsibilities="1. 设计账户体系<br>2. 管理用户权限<br>3. 确保账户安全<br>4. 优化权限流程<br>5. 建立权限标准"
                                     data-goals="1. 确保账户安全<br>2. 提升权限管理效率<br>3. 建立完善的权限体系<br>4. 推动权限管理创新<br>5. 打造安全可靠的账户系统"
                                     data-tags='[{"name":"安全思维","type":"subjective"},{"name":"权限管理","type":"objective"},{"name":"责任意识","type":"abstract"},{"name":"机制设计","type":"concrete"},{"name":"安全需求","type":"cause"},{"name":"安全保障","type":"result"},{"name":"信任价值","type":"intangible"},{"name":"安全报告","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供机制","backward":"提供信息"}]'>
                                    <span class="node-text">账户权限组</span>
                                </div>
                                
                                <!-- 交易订单组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 82%; left: 35%;"
                                     data-title="交易订单组"
                                     data-intro="交易订单组负责产品的交易管理和订单处理，确保交易的安全和订单的及时处理。"
                                     data-responsibilities="1. 设计交易流程<br>2. 处理订单数据<br>3. 确保交易安全<br>4. 优化订单处理<br>5. 建立交易标准"
                                     data-goals="1. 确保交易安全<br>2. 提升订单处理效率<br>3. 建立完善的交易体系<br>4. 推动交易管理创新<br>5. 打造高效可靠的交易系统"
                                     data-tags='[{"name":"交易思维","type":"subjective"},{"name":"订单管理","type":"objective"},{"name":"服务意识","type":"abstract"},{"name":"等级管理","type":"concrete"},{"name":"交易需求","type":"cause"},{"name":"交易成功","type":"result"},{"name":"服务价值","type":"intangible"},{"name":"订单数据","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供服务","backward":"提供等级"}]'>
                                    <span class="node-text">交易订单组</span>
                                </div>
                                
                                <!-- 任务匹配组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 75%; left: 15%;"
                                     data-title="任务匹配组"
                                     data-intro="任务匹配组负责产品的任务管理和匹配算法，确保任务能够准确匹配给合适的用户。"
                                     data-responsibilities="1. 设计任务体系<br>2. 开发匹配算法<br>3. 优化任务流程<br>4. 管理任务标签<br>5. 建立任务标准"
                                     data-goals="1. 提升任务匹配准确率<br>2. 优化任务执行效率<br>3. 建立完善的任务体系<br>4. 推动任务管理创新<br>5. 打造高效的任务匹配系统"
                                     data-tags='[{"name":"匹配思维","type":"subjective"},{"name":"算法设计","type":"objective"},{"name":"效率意识","type":"abstract"},{"name":"标签管理","type":"concrete"},{"name":"任务需求","type":"cause"},{"name":"匹配成功","type":"result"},{"name":"效率价值","type":"intangible"},{"name":"任务数据","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供链接","backward":"提供标签"}]'>
                                    <span class="node-text">任务匹配组</span>
                                </div>
                                
                                <!-- 消息管理组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 82%; left: 15%;"
                                     data-title="消息管理组"
                                     data-intro="消息管理组负责产品的消息系统和用户画像，确保消息的及时传递和用户画像的准确构建。"
                                     data-responsibilities="1. 设计消息体系<br>2. 管理用户画像<br>3. 优化消息推送<br>4. 分析用户数据<br>5. 建立消息标准"
                                     data-goals="1. 提升消息传递效率<br>2. 优化用户画像准确性<br>3. 建立完善的消息体系<br>4. 推动消息管理创新<br>5. 打造智能的消息管理系统"
                                     data-tags='[{"name":"沟通思维","type":"subjective"},{"name":"画像构建","type":"objective"},{"name":"智能意识","type":"abstract"},{"name":"数据分析","type":"concrete"},{"name":"消息需求","type":"cause"},{"name":"沟通顺畅","type":"result"},{"name":"智能价值","type":"intangible"},{"name":"数据报表","type":"tangible"}]'
                                     data-relationships='[{"target":"pa-node","forward":"提供比例","backward":"提供画像"}]'>
                                    <span class="node-text">消息管理组</span>
                                </div>
                                
                                <div class="node dc-node" onclick="selectNode(this)"
                                     style="top: 25%; left: 78%;"
                                     data-title="数据中心"
                                     data-intro="数据中心负责公司数据的存储、处理和分析，为业务决策提供数据支持，确保数据安全和合规。"
                                     data-responsibilities="1. 管理数据存储和备份<br>2. 处理数据分析和挖掘<br>3. 确保数据安全和隐私<br>4. 优化数据查询性能<br>5. 建立数据治理体系"
                                     data-goals="1. 实现99.99%数据可用性<br>2. 支持PB级数据存储<br>3. 建立完善的数据安全体系<br>4. 实现100ms查询响应<br>5. 打造行业领先数据平台"
                                     data-tags='[{"name":"数据思维","type":"subjective"},{"name":"数据管理","type":"objective"},{"name":"安全意识","type":"abstract"},{"name":"数据处理","type":"concrete"},{"name":"数据需求","type":"cause"},{"name":"数据价值","type":"result"},{"name":"数据资产","type":"intangible"},{"name":"数据产出","type":"tangible"}]'
                                     data-relationships='[{"target":"cto-node","forward":"提供参数","backward":"提供埋点"}]'>
                                    <span class="node-text">数据中心</span>
                                </div>
                                
                                <div class="node td-node" onclick="selectNode(this)"
                                     style="top: 45%; left: 78%;"
                                     data-title="技术开发中心"
                                     data-intro="技术开发中心负责公司产品的技术研发和实现，将产品需求转化为可用的技术解决方案。"
                                     data-responsibilities="1. 开发产品功能模块<br>2. 进行代码审查和质量控制<br>3. 编写技术文档和接口<br>4. 解决技术问题和bug<br>5. 推动技术最佳实践"
                                     data-goals="1. 实现100%需求交付<br>2. 降低bug率至0.1%以下<br>3. 建立高效开发流程<br>4. 培养30+技术专家<br>5. 打造优质技术产品"
                                     data-tags='[{"name":"开发思维","type":"subjective"},{"name":"代码质量","type":"objective"},{"name":"工程意识","type":"abstract"},{"name":"功能开发","type":"concrete"},{"name":"需求实现","type":"cause"},{"name":"产品交付","type":"result"},{"name":"工程文化","type":"intangible"},{"name":"代码提交","type":"tangible"}]'
                                     data-relationships='[{"target":"cto-node","forward":"提供创新","backward":"提供场景"}]'>
                                    <span class="node-text">技术开发中心</span>
                                </div>
                                
                                <!-- 研发效能组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 45%; left: 90%;"
                                     data-title="研发效能组"
                                     data-intro="研发效能组负责提升研发团队的效率和质量，建立完善的研发流程和工具链。"
                                     data-responsibilities="1. 建立研发流程体系<br>2. 开发研发工具平台<br>3. 优化研发效率指标<br>4. 推动研发最佳实践<br>5. 提升研发团队协作"
                                     data-goals="1. 缩短研发周期30%<br>2. 提升代码质量<br>3. 建立高效研发体系<br>4. 打造研发工具平台<br>5. 推动研发文化落地"
                                     data-tags='[{"name":"效能思维","type":"subjective"},{"name":"流程优化","type":"objective"},{"name":"效率意识","type":"abstract"},{"name":"工具开发","type":"concrete"},{"name":"效能需求","type":"cause"},{"name":"效率提升","type":"result"},{"name":"流程价值","type":"intangible"},{"name":"效能报告","type":"tangible"}]'
                                     data-relationships='[{"target":"td-node","forward":"提供制度","backward":"提供周期"}]'>
                                    <span class="node-text">研发效能组</span>
                                </div>
                                
                                <!-- 云端数据组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 55%; left: 90%;"
                                     data-title="云端数据组"
                                     data-intro="云端数据组负责公司云端数据平台的建设和管理，提供强大的计算能力和运维支持。"
                                     data-responsibilities="1. 建设云端数据平台<br>2. 管理云计算资源<br>3. 优化数据存储架构<br>4. 提供运维支持服务<br>5. 确保云端数据安全"
                                     data-goals="1. 提供强大算力支持<br>2. 实现99.99%云端可用性<br>3. 建立高效运维体系<br>4. 优化云端成本<br>5. 打造稳定可靠云平台"
                                     data-tags='[{"name":"云思维","type":"subjective"},{"name":"云平台管理","type":"objective"},{"name":"运维意识","type":"abstract"},{"name":"资源优化","type":"concrete"},{"name":"云端需求","type":"cause"},{"name":"算力提升","type":"result"},{"name":"云价值","type":"intangible"},{"name":"云服务","type":"tangible"}]'
                                     data-relationships='[{"target":"td-node","forward":"提供运维","backward":"提供算力"}]'>
                                    <span class="node-text">云端数据组</span>
                                </div>
                                
                                <!-- 基础设施组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 58%; left: 78%;"
                                     data-title="基础设施组"
                                     data-intro="基础设施组负责公司技术基础设施的建设和管理，为研发提供稳定可靠的运行环境。"
                                     data-responsibilities="1. 建设技术基础设施<br>2. 管理服务器和网络<br>3. 优化基础设施性能<br>4. 提供部署支持服务<br>5. 确保基础设施稳定"
                                     data-goals="1. 提供稳定运行环境<br>2. 实现99.99%基础设施可用性<br>3. 建立高效部署体系<br>4. 优化基础设施成本<br>5. 打造可靠技术底座"
                                     data-tags='[{"name":"基础设施思维","type":"subjective"},{"name":"基础设施管理","type":"objective"},{"name":"稳定意识","type":"abstract"},{"name":"环境建设","type":"concrete"},{"name":"基础设施需求","type":"cause"},{"name":"环境完善","type":"result"},{"name":"基础设施价值","type":"intangible"},{"name":"基础设施服务","type":"tangible"}]'
                                     data-relationships='[{"target":"td-node","forward":"提供部署","backward":"提供条件"}]'>
                                    <span class="node-text">基础设施组</span>
                                </div>
                                
                                <!-- 中间件与架构 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 55%; left: 66%;"
                                     data-title="中间件与架构"
                                     data-intro="中间件与架构组负责公司技术架构设计和中间件开发，为业务系统提供稳定可靠的技术组件。"
                                     data-responsibilities="1. 设计技术架构体系<br>2. 开发中间件组件<br>3. 优化系统架构性能<br>4. 提供架构支持服务<br>5. 确保系统架构稳定"
                                     data-goals="1. 提供稳定技术组件<br>2. 实现99.99%系统可用性<br>3. 建立高效架构体系<br>4. 优化系统架构成本<br>5. 打造可靠技术架构"
                                     data-tags='[{"name":"架构思维","type":"subjective"},{"name":"架构设计","type":"objective"},{"name":"组件意识","type":"abstract"},{"name":"系统建设","type":"concrete"},{"name":"架构需求","type":"cause"},{"name":"组件完善","type":"result"},{"name":"架构价值","type":"intangible"},{"name":"架构服务","type":"tangible"}]'
                                     data-relationships='[{"target":"td-node","forward":"提供系统","backward":"提供组件"}]'>
                                    <span class="node-text">中间件与架构</span>
                                </div>
                                
                                <!-- 安全与风控组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 45%; left: 66%;"
                                     data-title="安全与风控组"
                                     data-intro="安全与风控组负责公司信息安全和风险控制，为业务系统提供安全防护和风险检查服务。"
                                     data-responsibilities="1. 建立安全防护体系<br>2. 进行安全检查和审计<br>3. 管理安全风险和漏洞<br>4. 提供安全支持服务<br>5. 确保系统安全稳定"
                                     data-goals="1. 提供全面安全防护<br>2. 实现100%安全检查覆盖<br>3. 建立高效风控体系<br>4. 优化安全防护成本<br>5. 打造可靠安全防线"
                                     data-tags='[{"name":"安全思维","type":"subjective"},{"name":"安全管理","type":"objective"},{"name":"风控意识","type":"abstract"},{"name":"安全检查","type":"concrete"},{"name":"安全需求","type":"cause"},{"name":"防护完善","type":"result"},{"name":"安全价值","type":"intangible"},{"name":"安全服务","type":"tangible"}]'
                                     data-relationships='[{"target":"td-node","forward":"提供检查","backward":"提供防护"}]'>
                                    <span class="node-text">安全与风控组</span>
                                </div>
                                
                                <!-- 数据治理组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 15%; left: 78%;"
                                     data-title="数据治理组"
                                     data-intro="数据治理组负责制定和执行数据治理策略，确保数据的质量、安全和合规性。"
                                     data-responsibilities="1. 制定数据治理策略<br>2. 建立数据质量标准<br>3. 确保数据安全合规<br>4. 管理数据生命周期<br>5. 推动数据治理落地"
                                     data-goals="1. 提升数据质量<br>2. 确保数据合规性<br>3. 建立完善的数据治理体系<br>4. 推动数据治理创新<br>5. 打造行业领先的数据治理能力"
                                     data-tags='[{"name":"治理思维","type":"subjective"},{"name":"合规管理","type":"objective"},{"name":"标准意识","type":"abstract"},{"name":"质量控制","type":"concrete"},{"name":"治理需求","type":"cause"},{"name":"治理完善","type":"result"},{"name":"合规价值","type":"intangible"},{"name":"治理报告","type":"tangible"}]'
                                     data-relationships='[{"target":"dc-node","forward":"提供规范","backward":"提供底线"}]'>
                                    <span class="node-text">数据治理组</span>
                                </div>
                                
                                <!-- API接口 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 15%; left: 90%;"
                                     data-title="API接口"
                                     data-intro="API接口组负责设计、开发和管理公司的API接口，确保数据的安全传输和系统的集成。"
                                     data-responsibilities="1. 设计API接口规范<br>2. 开发API接口实现<br>3. 管理API接口文档<br>4. 确保API接口安全<br>5. 优化API接口性能"
                                     data-goals="1. 提升API接口稳定性<br>2. 确保API接口安全<br>3. 建立完善的API接口体系<br>4. 推动API接口创新<br>5. 打造高效可靠的API接口平台"
                                     data-tags='[{"name":"接口思维","type":"subjective"},{"name":"API设计","type":"objective"},{"name":"安全意识","type":"abstract"},{"name":"接口开发","type":"concrete"},{"name":"接口需求","type":"cause"},{"name":"接口完善","type":"result"},{"name":"集成价值","type":"intangible"},{"name":"接口文档","type":"tangible"}]'
                                     data-relationships='[{"target":"dc-node","forward":"提供节点","backward":"提供任务"}]'>
                                    <span class="node-text">API接口</span>
                                </div>
                                
                                <!-- 算法优化 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 25%; left: 90%;"
                                     data-title="算法优化"
                                     data-intro="算法优化组负责公司数据算法的设计、开发和优化，提升数据处理和分析的效率和准确性。"
                                     data-responsibilities="1. 设计数据算法<br>2. 开发算法实现<br>3. 优化算法性能<br>4. 管理算法模型<br>5. 推动算法创新"
                                     data-goals="1. 提升算法性能<br>2. 优化算法准确率<br>3. 建立完善的算法体系<br>4. 推动算法创新应用<br>5. 打造行业领先的算法能力"
                                     data-tags='[{"name":"算法思维","type":"subjective"},{"name":"模型开发","type":"objective"},{"name":"创新意识","type":"abstract"},{"name":"性能优化","type":"concrete"},{"name":"算法需求","type":"cause"},{"name":"算法提升","type":"result"},{"name":"技术价值","type":"intangible"},{"name":"算法模型","type":"tangible"}]'
                                     data-relationships='[{"target":"dc-node","forward":"提供模型","backward":"提供迭代"}]'>
                                    <span class="node-text">算法优化</span>
                                </div>
                                
                                <!-- 数据研发组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 35%; left: 90%;"
                                     data-title="数据研发组"
                                     data-intro="数据研发组负责公司数据产品的研发和创新，将数据技术转化为可用的产品和服务。"
                                     data-responsibilities="1. 研发数据产品<br>2. 创新数据技术<br>3. 优化数据服务<br>4. 解决数据问题<br>5. 推动数据研发落地"
                                     data-goals="1. 提升数据产品质量<br>2. 推动数据技术创新<br>3. 建立完善的数据研发体系<br>4. 实现数据产品快速迭代<br>5. 打造行业领先的数据产品"
                                     data-tags='[{"name":"研发思维","type":"subjective"},{"name":"产品开发","type":"objective"},{"name":"创新意识","type":"abstract"},{"name":"问题解决","type":"concrete"},{"name":"研发需求","type":"cause"},{"name":"产品交付","type":"result"},{"name":"创新价值","type":"intangible"},{"name":"产品版本","type":"tangible"}]'
                                     data-relationships='[{"target":"dc-node","forward":"提供版本","backward":"提供问题"}]'>
                                    <span class="node-text">数据研发组</span>
                                </div>
                                
                                <!-- 数仓维护组 -->
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 35%; left: 78%;"
                                     data-title="数仓维护组"
                                     data-intro="数仓维护组负责公司数据仓库的设计、建设和维护，确保数据的高效存储和管理。"
                                     data-responsibilities="1. 设计数据仓库架构<br>2. 建设数据仓库系统<br>3. 维护数据仓库运行<br>4. 优化数据仓库性能<br>5. 管理数据资产"
                                     data-goals="1. 提升数据仓库稳定性<br>2. 优化数据仓库性能<br>3. 建立完善的数据仓库体系<br>4. 推动数据仓库创新<br>5. 打造高效可靠的数据仓库平台"
                                     data-tags='[{"name":"仓库思维","type":"subjective"},{"name":"架构设计","type":"objective"},{"name":"维护意识","type":"abstract"},{"name":"性能优化","type":"concrete"},{"name":"仓库需求","type":"cause"},{"name":"仓库完善","type":"result"},{"name":"资产价值","type":"intangible"},{"name":"仓库报表","type":"tangible"}]'
                                     data-relationships='[{"target":"dc-node","forward":"提供支撑","backward":"提供资产"}]'>
                                    <span class="node-text">数仓维护组</span>
                                </div>
                                
                                <div class="node cpo-node" onclick="selectNode(this)"
                                     style="top: 65%; left: 35%;"
                                     data-title="首席产品官（CPO）"
                                     data-intro="首席产品官（CPO）负责公司产品战略制定和产品线管理，确保产品能够满足市场需求，提升用户体验和产品竞争力。"
                                     data-responsibilities="1. 制定产品发展战略和路线图<br>2. 管理产品全生命周期<br>3. 分析市场需求和用户反馈<br>4. 协调研发、设计、市场团队<br>5. 持续优化产品体验"
                                     data-goals="1. 打造市场领先的产品<br>2. 提升用户满意度和留存率<br>3. 建立高效的产品管理体系<br>4. 推动产品创新和迭代<br>5. 提升产品市场占有率"
                                     data-tags='[{"name":"产品思维","type":"subjective"},{"name":"产品规划","type":"objective"},{"name":"用户体验","type":"abstract"},{"name":"功能实现","type":"concrete"},{"name":"需求分析","type":"cause"},{"name":"产品成功","type":"result"},{"name":"品牌价值","type":"intangible"},{"name":"产品交付","type":"tangible"}]'>
                                    <span class="node-text">首席产品官（CPO）</span>
                                </div>
                                
                                <div class="node chro-node" onclick="selectNode(this)"
                                     style="top: 65%; left: 65%;"
                                     data-title="首席人力资源官（CHRO）"
                                     data-intro="首席人力资源官（CHRO）负责公司的人力资源战略制定和人才管理，确保公司拥有优秀的人才团队，推动组织发展和文化建设。"
                                     data-responsibilities="1. 制定人力资源发展战略<br>2. 负责人才招聘和培养<br>3. 设计薪酬福利体系<br>4. 推动组织文化建设<br>5. 管理员工关系和绩效"
                                     data-goals="1. 建立优秀的人才团队<br>2. 提升员工满意度和敬业度<br>3. 打造积极的企业文化<br>4. 建立完善的HR管理体系<br>5. 支持组织战略发展"
                                     data-tags='[{"name":"人才思维","type":"subjective"},{"name":"人才管理","type":"objective"},{"name":"组织发展","type":"abstract"},{"name":"绩效落地","type":"concrete"},{"name":"人才引进","type":"cause"},{"name":"组织成长","type":"result"},{"name":"企业文化","type":"intangible"},{"name":"人才培养","type":"tangible"}]'>
                                    <span class="node-text">首席人力资源官（CHRO）</span>
                                </div>
                                
                                <!-- 董事长办公室 -->
                                <div class="node ob-node" onclick="selectNode(this)"
                                     style="top: 65%; left: 78%;"
                                     data-title="董事长办公室"
                                     data-intro="董事长办公室负责协助董事长处理日常工作，提供战略指引和决策支持，确保公司重大决策的有效落地。"
                                     data-responsibilities="1. 协助董事长制定战略规划<br>2. 处理董事长日常工作事务<br>3. 协调公司各部门工作<br>4. 推动重大决策落地执行<br>5. 管理董事长日程安排"
                                     data-goals="1. 提供高效决策支持<br>2. 确保战略规划落地<br>3. 建立顺畅沟通机制<br>4. 提升董事长工作效率<br>5. 支持公司战略发展"
                                     data-tags='[{"name":"战略思维","type":"subjective"},{"name":"决策支持","type":"objective"},{"name":"协调意识","type":"abstract"},{"name":"执行落地","type":"concrete"},{"name":"战略需求","type":"cause"},{"name":"决策达成","type":"result"},{"name":"战略价值","type":"intangible"},{"name":"执行报告","type":"tangible"}]'
                                     data-relationships='[{"target":"chro-node","forward":"提供落地","backward":"提供指引"}]'>
                                    <span class="node-text">董事长办公室</span>
                                </div>
                                
                                <!-- 法务部 -->
                                 <div class="node support-node" onclick="selectNode(this)"
                                      style="top: 65%; left: 90%;"
                                      data-title="法务部"
                                      data-intro="法务部负责公司法律事务管理，提供法律咨询和合规支持，确保公司运营符合法律法规要求。"
                                      data-responsibilities="1. 处理公司法律事务<br>2. 提供法律咨询服务<br>3. 审核合同和法律文件<br>4. 管理法律风险<br>5. 确保合规运营"
                                      data-goals="1. 提供专业法律支持<br>2. 确保公司合规运营<br>3. 降低法律风险<br>4. 建立完善法律体系<br>5. 提升法律意识"
                                      data-tags='[{"name":"法律思维","type":"subjective"},{"name":"法律管理","type":"objective"},{"name":"合规意识","type":"abstract"},{"name":"法律咨询","type":"concrete"},{"name":"法律需求","type":"cause"},{"name":"合规达成","type":"result"},{"name":"法律价值","type":"intangible"},{"name":"法律文件","type":"tangible"}]'
                                      data-relationships='[{"target":"ob-node","forward":"提供法规","backward":"提供事项"}]'>
                                     <span class="node-text">法务部</span>
                                 </div>
                                 
                                 <!-- 财务部 -->
                                   <div class="node support-node" onclick="selectNode(this)"
                                        style="top: 75%; left: 78%;"
                                        data-title="财务部"
                                        data-intro="财务部负责公司财务管理、预算编制和资金运作，确保公司财务健康和资金安全。"
                                        data-responsibilities="1. 管理公司财务事务<br>2. 编制财务预算<br>3. 处理资金收付<br>4. 进行财务分析<br>5. 确保财务合规"
                                        data-goals="1. 确保资金安全<br>2. 优化财务结构<br>3. 提升资金使用效率<br>4. 建立完善财务体系<br>5. 支持公司战略发展"
                                        data-tags='[{"name":"财务思维","type":"subjective"},{"name":"财务管理","type":"objective"},{"name":"预算意识","type":"abstract"},{"name":"资金管理","type":"concrete"},{"name":"财务需求","type":"cause"},{"name":"财务健康","type":"result"},{"name":"财务价值","type":"intangible"},{"name":"财务报表","type":"tangible"}]'
                                        data-relationships='[{"target":"ob-node","forward":"提供预算","backward":"提供款项"}]'>
                                       <span class="node-text">财务部</span>
                                   </div>
                                  
                                  <!-- 战略发展部 -->
                                  <div class="node support-node" onclick="selectNode(this)"
                                       style="top: 75%; left: 90%;"
                                       data-title="战略发展部"
                                       data-intro="战略发展部负责公司战略规划和发展策划，推动公司战略投资和业务拓展。"
                                       data-responsibilities="1. 制定公司战略规划<br>2. 进行战略投资分析<br>3. 推动业务拓展<br>4. 评估战略执行效果<br>5. 优化战略发展路径"
                                       data-goals="1. 制定清晰战略规划<br>2. 实现战略投资目标<br>3. 推动业务快速增长<br>4. 建立战略评估体系<br>5. 提升战略执行能力"
                                       data-tags='[{"name":"战略思维","type":"subjective"},{"name":"战略规划","type":"objective"},{"name":"发展意识","type":"abstract"},{"name":"投资分析","type":"concrete"},{"name":"战略需求","type":"cause"},{"name":"业务拓展","type":"result"},{"name":"战略价值","type":"intangible"},{"name":"战略报告","type":"tangible"}]'
                                       data-relationships='[{"target":"ob-node","forward":"提供投资","backward":"提供策划"}]'>
                                      <span class="node-text">战略发展部</span>
                                  </div>
                                
                                <!-- 人力资源部 -->
                                <div class="node hr-node" onclick="selectNode(this)"
                                     style="top: 75%; left: 65%;"
                                     data-title="人力资源部"
                                     data-intro="人力资源部负责公司人才的招聘、培训、绩效管理和薪酬福利管理，确保公司拥有合适的人才队伍。"
                                     data-responsibilities="1. 负责人才招聘和选拔<br>2. 组织员工培训和发展<br>3. 管理员工绩效管理<br>4. 设计薪酬福利体系<br>5. 处理员工关系和离职"
                                     data-goals="1. 招聘100+优秀人才<br>2. 提升员工培训覆盖率<br>3. 建立科学绩效管理体系<br>4. 优化薪酬福利结构<br>5. 提升员工满意度"
                                     data-tags='[{"name":"人才思维","type":"subjective"},{"name":"招聘管理","type":"objective"},{"name":"发展意识","type":"abstract"},{"name":"绩效管理","type":"concrete"},{"name":"人才需求","type":"cause"},{"name":"团队建设","type":"result"},{"name":"人才价值","type":"intangible"},{"name":"入职培训","type":"tangible"}]'
                                     data-relationships='[{"target":"chro-node","forward":"提供职务","backward":"提供人员"}]'>
                                    <span class="node-text">人力资源部</span>
                                </div>
                                
                                <!-- 行政部 -->
                                 <div class="node support-node" onclick="selectNode(this)"
                                      style="top: 85%; left: 78%;"
                                      data-title="行政部"
                                      data-intro="行政部负责公司行政管理和后勤保障，为各部门提供配套服务和后勤支持。"
                                      data-responsibilities="1. 管理公司行政事务<br>2. 提供后勤保障服务<br>3. 管理办公环境和设施<br>4. 组织会议和活动<br>5. 处理行政文件和档案"
                                      data-goals="1. 提供高效行政服务<br>2. 确保后勤保障到位<br>3. 优化办公环境<br>4. 建立完善行政体系<br>5. 提升员工满意度"
                                      data-tags='[{"name":"行政思维","type":"subjective"},{"name":"行政管理","type":"objective"},{"name":"服务意识","type":"abstract"},{"name":"后勤保障","type":"concrete"},{"name":"行政需求","type":"cause"},{"name":"服务达成","type":"result"},{"name":"行政价值","type":"intangible"},{"name":"行政文件","type":"tangible"}]'
                                      data-relationships='[{"target":"hr-node","forward":"提供后勤","backward":"提供配套"}]'>
                                     <span class="node-text">行政部</span>
                                 </div>
                                 
                                 <!-- 传讯部 -->
                                  <div class="node support-node" onclick="selectNode(this)"
                                       style="top: 85%; left: 65%;"
                                       data-title="传讯部"
                                       data-intro="传讯部负责公司宣传推广和素材制作，为各部门提供宣传支持和素材资源。"
                                       data-responsibilities="1. 管理公司宣传推广<br>2. 制作宣传素材和内容<br>3. 维护宣传渠道和平台<br>4. 策划宣传活动<br>5. 管理宣传品牌形象"
                                       data-goals="1. 提升品牌宣传效果<br>2. 优化宣传素材质量<br>3. 扩大宣传覆盖范围<br>4. 建立完善宣传体系<br>5. 提升品牌影响力"
                                       data-tags='[{"name":"宣传思维","type":"subjective"},{"name":"宣传管理","type":"objective"},{"name":"创意意识","type":"abstract"},{"name":"素材制作","type":"concrete"},{"name":"宣传需求","type":"cause"},{"name":"宣传达成","type":"result"},{"name":"宣传价值","type":"intangible"},{"name":"宣传素材","type":"tangible"}]'
                                       data-relationships='[{"target":"hr-node","forward":"提供素材","backward":"提供宣传"}]'>
                                      <span class="node-text">传讯部</span>
                                  </div>
                                  
                                  <!-- 采购部 -->
                                  <div class="node support-node" onclick="selectNode(this)"
                                       style="top: 85%; left: 52%;"
                                       data-title="采购部"
                                       data-intro="采购部负责公司物资采购和设备管理，为各部门提供物资保障和设备支持。"
                                       data-responsibilities="1. 管理公司物资采购<br>2. 维护办公设备设施<br>3. 优化采购流程和成本<br>4. 管理供应商关系<br>5. 确保物资供应及时"
                                       data-goals="1. 提供及时物资供应<br>2. 优化采购成本控制<br>3. 建立完善采购体系<br>4. 提升设备使用效率<br>5. 确保物资质量可靠"
                                       data-tags='[{"name":"采购思维","type":"subjective"},{"name":"采购管理","type":"objective"},{"name":"成本意识","type":"abstract"},{"name":"物资保障","type":"concrete"},{"name":"采购需求","type":"cause"},{"name":"供应达成","type":"result"},{"name":"采购价值","type":"intangible"},{"name":"采购设备","type":"tangible"}]'
                                       data-relationships='[{"target":"hr-node","forward":"提供设备","backward":"提供物资"}]'>
                                      <span class="node-text">采购部</span>
                                  </div>
                                
                                <!-- 公共事业部 -->
                                <div class="node pb-node" onclick="selectNode(this)"
                                     style="top: 70%; left: 55%;"
                                     data-title="公共事业部"
                                     data-intro="公共事业部负责公司的公共关系、品牌建设和企业文化推广，提升公司的社会形象和品牌价值。"
                                     data-responsibilities="1. 管理公司公共关系<br>2. 推动品牌建设和推广<br>3. 组织企业文化活动<br>4. 处理媒体沟通和危机<br>5. 参与社会责任项目"
                                     data-goals="1. 提升品牌知名度50%<br>2. 建立良好公共关系网络<br>3. 打造积极企业文化<br>4. 有效应对媒体危机<br>5. 提升企业社会形象"
                                     data-tags='[{"name":"品牌思维","type":"subjective"},{"name":"公关管理","type":"objective"},{"name":"文化意识","type":"abstract"},{"name":"活动策划","type":"concrete"},{"name":"品牌需求","type":"cause"},{"name":"形象提升","type":"result"},{"name":"品牌价值","type":"intangible"},{"name":"活动执行","type":"tangible"}]'
                                     data-relationships='[{"target":"chro-node","forward":"提供计划","backward":"提供步骤"}]'>
                                    <span class="node-text">公共事业部</span>
                                </div>
                                
                                <!-- 工会 -->
                                 <div class="node support-node" onclick="selectNode(this)"
                                      style="top: 80%; left: 45%;"
                                      data-title="工会"
                                      data-intro="工会负责维护员工权益和福利，组织员工活动，促进员工福利和公益事业发展。"
                                      data-responsibilities="1. 维护员工合法权益<br>2. 组织员工福利活动<br>3. 推动员工公益项目<br>4. 协调员工关系<br>5. 提升员工满意度"
                                      data-goals="1. 维护员工权益100%<br>2. 提升员工福利水平<br>3. 推动公益事业发展<br>4. 建立和谐劳动关系<br>5. 提升员工幸福感"
                                      data-tags='[{"name":"福利思维","type":"subjective"},{"name":"权益管理","type":"objective"},{"name":"公益意识","type":"abstract"},{"name":"活动组织","type":"concrete"},{"name":"福利需求","type":"cause"},{"name":"权益保障","type":"result"},{"name":"公益价值","type":"intangible"},{"name":"福利活动","type":"tangible"}]'
                                      data-relationships='[{"target":"pb-node","forward":"提供公益","backward":"提供单位"}]'>
                                     <span class="node-text">工会</span>
                                 </div>
                                 
                                 <!-- 审计及风控委员会 -->
                                 <div class="node support-node" onclick="selectNode(this)"
                                      style="top: 70%; left: 40%;"
                                      data-title="审计及风控委员会"
                                      data-intro="审计及风控委员会负责公司审计监督和风险控制，提供审计标准和督查服务，确保公司运营合规和风险可控。"
                                      data-responsibilities="1. 进行公司审计监督<br>2. 制定审计标准和规范<br>3. 评估运营风险<br>4. 提供风控建议<br>5. 确保合规运营"
                                      data-goals="1. 提供全面审计监督<br>2. 建立完善审计标准<br>3. 控制运营风险<br>4. 确保公司合规运营<br>5. 提升风控能力"
                                      data-tags='[{"name":"审计思维","type":"subjective"},{"name":"审计管理","type":"objective"},{"name":"风控意识","type":"abstract"},{"name":"监督执行","type":"concrete"},{"name":"审计需求","type":"cause"},{"name":"合规达成","type":"result"},{"name":"审计价值","type":"intangible"},{"name":"审计报告","type":"tangible"}]'
                                      data-relationships='[{"target":"pb-node","forward":"提供督查","backward":"提供标准"}]'>
                                     <span class="node-text">审计及风控委员会</span>
                                 </div>
                                 
                                 <!-- 物流部 -->
                                 <div class="node support-node" onclick="selectNode(this)"
                                      style="top: 62%; left: 42%;"
                                      data-title="物流部"
                                      data-intro="物流部负责公司物流链路管理和对接服务，为各部门提供物流支持和对接保障。"
                                      data-responsibilities="1. 管理公司物流链路<br>2. 提供物流对接服务<br>3. 优化物流运输效率<br>4. 管理仓储和配送<br>5. 确保物流及时送达"
                                      data-goals="1. 建立高效物流链路<br>2. 提供及时物流对接<br>3. 优化运输效率<br>4. 降低物流成本<br>5. 提升物流服务质量"
                                      data-tags='[{"name":"物流思维","type":"subjective"},{"name":"物流管理","type":"objective"},{"name":"效率意识","type":"abstract"},{"name":"链路管理","type":"concrete"},{"name":"物流需求","type":"cause"},{"name":"运输达成","type":"result"},{"name":"物流价值","type":"intangible"},{"name":"物流报告","type":"tangible"}]'
                                      data-relationships='[{"target":"pb-node","forward":"提供对接","backward":"提供链路"}]'>
                                     <span class="node-text">物流部</span>
                                 </div>
                                
                                <div class="node f-node" onclick="selectNode(this)"
                                     style="top: 25%; left: 25%;"
                                     data-title="F端事业部"
                                     data-intro="F端事业部负责面向金融机构的专业服务，为银行、保险、证券等金融客户提供定制化的解决方案和服务。"
                                     data-responsibilities="1. 开发金融行业专属产品<br>2. 维护金融机构客户关系<br>3. 提供专业的金融咨询服务<br>4. 确保金融数据安全合规<br>5. 推动金融科技创新应用"
                                     data-goals="1. 扩大金融机构客户规模<br>2. 提升金融产品市场占有率<br>3. 建立金融行业专业品牌<br>4. 实现金融业务快速增长<br>5. 打造金融科技领先优势"
                                     data-tags='[{"name":"金融思维","type":"subjective"},{"name":"客户服务","type":"objective"},{"name":"合规意识","type":"abstract"},{"name":"业务拓展","type":"concrete"},{"name":"需求挖掘","type":"cause"},{"name":"业绩增长","type":"result"},{"name":"专业形象","type":"intangible"},{"name":"客户签约","type":"tangible"}]'
                                     data-relationships='[{"target":"coo-node","forward":"汇报业务","backward":"提供资源"}]'>
                                    <span class="node-text">F端事业部</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 25%; left: 10%;"
                                     data-title="商务合作部"
                                     data-intro="商务合作部负责F端事业部的商务拓展和合作伙伴关系管理，推动金融业务的合作与发展。"
                                     data-responsibilities="1. 拓展金融机构合作伙伴<br>2. 维护商务合作关系<br>3. 谈判商务合作条款<br>4. 推动业务合作落地<br>5. 优化合作流程体系"
                                     data-goals="1. 建立100+金融机构合作<br>2. 实现50%合作转化率<br>3. 打造行业领先合作网络<br>4. 提升合作伙伴满意度<br>5. 建立标准化合作体系"
                                     data-tags='[{"name":"合作意识","type":"subjective"},{"name":"商务拓展","type":"objective"},{"name":"共赢意识","type":"abstract"},{"name":"合作落地","type":"concrete"},{"name":"合作需求","type":"cause"},{"name":"合作达成","type":"result"},{"name":"合作网络","type":"intangible"},{"name":"合同签署","type":"tangible"}]'
                                     data-relationships='[{"target":"f-node","forward":"提供渠道","backward":"提供范畴"}]'>
                                    <span class="node-text">商务合作部</span>
                                </div>
                                
                                <div class="node g-node" onclick="selectNode(this)"
                                     style="top: 35%; left: 20%;"
                                     data-title="G端事业部"
                                     data-intro="G端事业部负责面向政府机构的公共服务，为各级政府部门提供数字化解决方案和政务服务支持。"
                                     data-responsibilities="1. 开发政府数字化产品<br>2. 维护政府部门合作关系<br>3. 提供政务服务咨询<br>4. 确保政务数据安全<br>5. 推动智慧城市建设"
                                     data-goals="1. 扩大政府客户覆盖面<br>2. 提升政务服务效率<br>3. 建立政务服务品牌<br>4. 实现政务业务突破<br>5. 打造智慧城市标杆"
                                     data-tags='[{"name":"政务思维","type":"subjective"},{"name":"服务交付","type":"objective"},{"name":"公信意识","type":"abstract"},{"name":"项目落地","type":"concrete"},{"name":"政策对接","type":"cause"},{"name":"政务突破","type":"result"},{"name":"政府形象","type":"intangible"},{"name":"项目验收","type":"tangible"}]'
                                     data-relationships='[{"target":"coo-node","forward":"汇报政务","backward":"提供指导"}]'>
                                    <span class="node-text">G端事业部</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 28%; left: 8%;"
                                     data-title="保障服务部"
                                     data-intro="保障服务部负责为G端事业部提供全方位的服务保障支持，确保政务项目的顺利实施和稳定运行。"
                                     data-responsibilities="1. 提供技术保障服务<br>2. 维护系统稳定运行<br>3. 处理应急故障响应<br>4. 优化服务流程<br>5. 提升服务质量标准"
                                     data-goals="1. 确保系统99.9%可用性<br>2. 实现30分钟故障响应<br>3. 建立标准化服务流程<br>4. 提升客户满意度至95%<br>5. 打造专业服务团队"
                                     data-tags='[{"name":"服务意识","type":"subjective"},{"name":"技术保障","type":"objective"},{"name":"责任意识","type":"abstract"},{"name":"故障处理","type":"concrete"},{"name":"服务需求","type":"cause"},{"name":"服务保障","type":"result"},{"name":"服务口碑","type":"intangible"},{"name":"服务交付","type":"tangible"}]'
                                     data-relationships='[{"target":"g-node","forward":"提供权益","backward":"提供痛点"}]'>
                                    <span class="node-text">保障服务部</span>
                                </div>
                                
                                <div class="node c-node" onclick="selectNode(this)"
                                     style="top: 45%; left: 25%;"
                                     data-title="C端事业部"
                                     data-intro="C端事业部负责面向消费者的个人服务，为广大用户提供优质的产品和服务体验，提升用户满意度和忠诚度。"
                                     data-responsibilities="1. 开发个人用户产品<br>2. 维护用户关系和社群<br>3. 提供优质的用户服务<br>4. 分析用户行为数据<br>5. 推动用户体验优化"
                                     data-goals="1. 扩大个人用户规模<br>2. 提升用户活跃度和留存<br>3. 建立用户口碑品牌<br>4. 实现用户价值最大化<br>5. 打造极致用户体验"
                                     data-tags='[{"name":"用户思维","type":"subjective"},{"name":"用户运营","type":"objective"},{"name":"体验意识","type":"abstract"},{"name":"用户增长","type":"concrete"},{"name":"用户洞察","type":"cause"},{"name":"用户满意","type":"result"},{"name":"用户口碑","type":"intangible"},{"name":"用户转化","type":"tangible"}]'
                                     data-relationships='[{"target":"coo-node","forward":"汇报用户","backward":"提供策略"}]'>
                                    <span class="node-text">C端事业部</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 42%; left: 10%;"
                                     data-title="客服中心"
                                     data-intro="客服中心负责为C端用户提供全方位的客户服务支持，解决用户问题，提升用户满意度和忠诚度。"
                                     data-responsibilities="1. 处理用户咨询和投诉<br>2. 提供产品使用指导<br>3. 收集用户反馈建议<br>4. 维护用户关系<br>5. 提升服务质量标准"
                                     data-goals="1. 实现98%问题解决率<br>2. 达到95%用户满意度<br>3. 建立标准化服务流程<br>4. 培养5星级服务团队<br>5. 打造优质服务品牌"
                                     data-tags='[{"name":"客户意识","type":"subjective"},{"name":"问题解决","type":"objective"},{"name":"同理意识","type":"abstract"},{"name":"服务响应","type":"concrete"},{"name":"用户咨询","type":"cause"},{"name":"问题解决","type":"result"},{"name":"用户信任","type":"intangible"},{"name":"服务完成","type":"tangible"}]'
                                     data-relationships='[{"target":"c-node","forward":"提供服务","backward":"反馈问题"}]'>
                                    <span class="node-text">客服中心</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 48%; left: 10%;"
                                     data-title="调节仲裁中心"
                                     data-intro="调节仲裁中心负责处理用户纠纷和争议，通过专业的调解和仲裁服务，维护平台秩序和用户权益。"
                                     data-responsibilities="1. 处理用户纠纷调解<br>2. 执行仲裁裁决<br>3. 维护平台规则<br>4. 保护用户合法权益<br>5. 优化纠纷处理流程"
                                     data-goals="1. 实现90%调解成功率<br>2. 确保24小时响应时效<br>3. 建立公正仲裁体系<br>4. 维护平台良好秩序<br>5. 提升用户信任度"
                                     data-tags='[{"name":"公正意识","type":"subjective"},{"name":"纠纷处理","type":"objective"},{"name":"法治意识","type":"abstract"},{"name":"仲裁执行","type":"concrete"},{"name":"纠纷产生","type":"cause"},{"name":"纠纷解决","type":"result"},{"name":"平台信誉","type":"intangible"},{"name":"裁决执行","type":"tangible"}]'
                                     data-relationships='[{"target":"c-node","forward":"处理纠纷","backward":"提供规则"}]'>
                                    <span class="node-text">调节仲裁中心</span>
                                </div>
                                
                                <div class="node e-node" onclick="selectNode(this)"
                                     style="top: 20%; left: 35%;"
                                     data-title="E端事业部"
                                     data-intro="E端事业部负责面向企业的B2B服务，为企业客户提供专业的解决方案，助力企业数字化转型和业务增长。"
                                     data-responsibilities="1. 开发企业级产品<br>2. 维护企业客户关系<br>3. 提供企业咨询服务<br>4. 确保企业数据安全<br>5. 推动企业数字化升级"
                                     data-goals="1. 扩大企业客户规模<br>2. 提升企业服务满意度<br>3. 建立企业服务品牌<br>4. 实现企业业务增长<br>5. 打造企业数字化标杆"
                                     data-tags='[{"name":"企业思维","type":"subjective"},{"name":"企业服务","type":"objective"},{"name":"价值意识","type":"abstract"},{"name":"企业拓展","type":"concrete"},{"name":"需求分析","type":"cause"},{"name":"企业成功","type":"result"},{"name":"合作伙伴","type":"intangible"},{"name":"企业签约","type":"tangible"}]'
                                     data-relationships='[{"target":"coo-node","forward":"提供合作","backward":"提供区域"}]'>
                                    <span class="node-text">E端事业部</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 15%; left: 50%;"
                                     data-title="培训服务部"
                                     data-intro="培训服务部负责为E端企业客户提供专业的培训服务，提升企业员工技能和业务能力。"
                                     data-responsibilities="1. 设计企业培训课程<br>2. 组织培训实施执行<br>3. 评估培训效果反馈<br>4. 优化培训内容体系<br>5. 建立培训讲师团队"
                                     data-goals="1. 实现100+企业培训覆盖<br>2. 达到95%培训满意度<br>3. 建立行业领先培训体系<br>4. 培养50+专业讲师<br>5. 打造优质培训品牌"
                                     data-tags='[{"name":"培训意识","type":"subjective"},{"name":"技能提升","type":"objective"},{"name":"成长意识","type":"abstract"},{"name":"课程实施","type":"concrete"},{"name":"培训需求","type":"cause"},{"name":"能力提升","type":"result"},{"name":"知识传递","type":"intangible"},{"name":"培训完成","type":"tangible"}]'
                                     data-relationships='[{"target":"e-node","forward":"提供课程","backward":"提供人才"}]'>
                                    <span class="node-text">培训服务部</span>
                                </div>
                                
                                <div class="node support-node" onclick="selectNode(this)"
                                     style="top: 25%; left: 50%;"
                                     data-title="电商服务部"
                                     data-intro="电商服务部负责为E端企业客户提供电商平台搭建和运营服务，助力企业实现线上业务转型。"
                                     data-responsibilities="1. 搭建电商平台系统<br>2. 运营电商业务推广<br>3. 优化电商用户体验<br>4. 分析电商数据报表<br>5. 维护平台稳定运行"
                                     data-goals="1. 搭建50+企业电商平台<br>2. 实现30%业务增长转化<br>3. 建立行业领先电商体系<br>4. 提升95%用户满意度<br>5. 打造优质电商品牌"
                                     data-tags='[{"name":"电商意识","type":"subjective"},{"name":"平台运营","type":"objective"},{"name":"创新意识","type":"abstract"},{"name":"业务推广","type":"concrete"},{"name":"电商需求","type":"cause"},{"name":"业务增长","type":"result"},{"name":"品牌价值","type":"intangible"},{"name":"订单成交","type":"tangible"}]'
                                     data-relationships='[{"target":"e-node","forward":"提供流量","backward":"提供客源"}]'>
                                    <span class="node-text">电商服务部</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 信息框 -->
                    <div class="info-box">
                        <div class="info-tabs">
                            <div class="info-tab active" data-tab="detail" onclick="switchTab('detail')">详情</div>
                            <div class="info-tab" data-tab="qa" onclick="switchTab('qa')">问答</div>
                        </div>
                        <div class="info-content">
                            <div class="info-panel" id="detailPanel">
                                <div class="empty-state">
                                    <div class="empty-icon">👆</div>
                                    <p>点击画布中的节点查看详情</p>
                                </div>
                            </div>
                            <div class="info-panel" id="qaPanel" style="display: none;">
                                <div class="empty-state" id="qaEmptyState">
                                    <div class="empty-icon">👆</div>
                                    <p>点击画布中的节点查看问答</p>
                                </div>
                                <div id="qaInputArea" style="display: none; padding: 15px;">
                                    <div style="margin-bottom: 15px;">
                                        <textarea id="qaInput" placeholder="请输入您的描述或需求，系统将为您匹配最适合的岗位..." 
                                                  style="width: 100%; height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; resize: none; font-size: 14px; line-height: 1.5;"></textarea>
                                    </div>
                                    <button onclick="matchNodeByKeywords()" 
                                            style="width: 100%; padding: 12px; background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                                        智能匹配岗位
                                    </button>
                                </div>
                                <div id="qaResultArea" style="display: none; padding: 15px;">
                                    <div id="qaResultContent"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 会议页面内容 -->
        <div id="meetingPage" class="page-content" style="display:none;">
            <div class="container meeting-container">
                <!-- 会议档案库标题 -->
                <div class="section-title">
                    <div class="title-decoration">
                        <div class="decoration-line left"></div>
                        <div class="decoration-icon">📅</div>
                        <div class="decoration-line right"></div>
                    </div>
                    <svg width="400" height="60" viewBox="0 0 400 60" style="margin:0 auto;">
                        <text x="200" y="45" text-anchor="middle" class="svg-title-meeting" style="font-family:'SimHei','Microsoft YaHei','STHeiti',sans-serif;font-size:36px;font-weight:bold;letter-spacing:12px;fill:#000;">会议档案库</text>
                    </svg>
                    <p class="subtitle">记录每一次重要会议</p>
                </div>
                
                <!-- 文档位容器 -->
                <div class="document-archive">
                    <!-- 左侧文档位 -->
                    <div class="document-slots">
                        <div class="document-slot" data-document="1" onclick="openMeetingDocument(1)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">📄</div>
                                        <div class="document-info">
                                            <div class="document-title">董事会会议纪要</div>
                                            <div class="document-date">2026-01-15</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="2" onclick="openMeetingDocument(2)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">📊</div>
                                        <div class="document-info">
                                            <div class="document-title">季度业务回顾</div>
                                            <div class="document-date">2026-01-20</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="3" onclick="openMeetingDocument(3)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">🎯</div>
                                        <div class="document-info">
                                            <div class="document-title">年度战略规划</div>
                                            <div class="document-date">2026-01-10</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="4" onclick="openMeetingDocument(4)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">🚀</div>
                                        <div class="document-info">
                                            <div class="document-title">产品 roadmap 讨论</div>
                                            <div class="document-date">2026-01-25</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="5" onclick="openMeetingDocument(5)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">💰</div>
                                        <div class="document-info">
                                            <div class="document-title">财务预算评审</div>
                                            <div class="document-date">2026-01-05</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="6" onclick="openMeetingDocument(6)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">👥</div>
                                        <div class="document-info">
                                            <div class="document-title">人才发展规划</div>
                                            <div class="document-date">2026-01-18</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="document-slot" data-document="7" onclick="openMeetingDocument(7)">
                            <div class="document-folder">
                                <div class="folder-tab"></div>
                                <div class="folder-side"></div>
                                <div class="folder-content">
                                    <div class="document-preview">
                                        <div class="document-icon">💻</div>
                                        <div class="document-info">
                                            <div class="document-title">技术架构评审</div>
                                            <div class="document-date">2026-01-22</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧文档详情 -->
                    <div class="document-details">
                        <div class="document-details-content">
                            <div class="document-details-header">
                                <h3>文档详情</h3>
                                <button class="close-details" onclick="closeMeetingDocument()">×</button>
                            </div>
                            <div class="document-details-body" id="documentDetailsBody">
                                <div class="empty-state">
                                    <div class="empty-icon">📄</div>
                                    <p>请从左侧选择一个会议文档查看详情</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 项目页面内容 -->
        <div id="projectPage" class="page-content" style="display:none;">
            <div class="container">
                <!-- 项目页面内容将在后续添加 -->
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeBtn">×</button>
            <div class="newspaper-header">
                <div class="logo-area">
                    <img src="images/9161e9ab-5cac-4f69-b57f-2ca6970b1429.png" alt="智启侨乡日报" style="height:38px; width:auto;">
                    <img src="images/985fb8e021cb545bbb56779357129d7.png?v=1.0" alt="Logo" style="height:38px;">
                </div>
                <div class="divider"></div>
                <div class="info-bar">
                    <span class="issue" id="modalIssue">第 0 期</span>
                    <span class="slogan">智创侨乡 · 砥砺前行</span>
                    <div class="info-bar-actions">
                        <span class="date" id="modalDate">2026年1月1日</span>
                        <button class="share-btn" onclick="shareNewspaper()">📤 转发</button>
                    </div>
                </div>
            </div>
            <div class="newspaper-body" id="modalBody">
            </div>
        </div>
    </div>

    <!-- 实践题放大弹窗 -->
    <div class="quiz-expand-modal" id="quizExpandModal">
        <div class="quiz-expand-content">
            <div class="quiz-expand-header">
                <h3><span>✍️</span> 实践题 - 知识测验</h3>
                <button class="quiz-expand-close" onclick="closeQuizExpandModal()">×</button>
            </div>
            <div class="quiz-expand-body" id="quizExpandBody">
                <!-- 动态插入题目内容 -->
            </div>
        </div>
    </div>

    <div class="video-expand-modal" id="videoExpandModal">
        <div class="video-expand-content">
            <div class="video-expand-header">
                <h3><span>🎬</span> AI工具科普</h3>
                <button class="video-expand-close" onclick="closeVideoExpandModal()">×</button>
            </div>
            <div class="video-expand-body">
                <div style="position:relative;">
                    <video id="videoExpandPlayer" controls>
                        <source id="videoExpandSource" src="" type="video/mp4">
                        您的浏览器不支持视频播放
                    </video>
                    <div class="danmu-container" id="danmuContainer"></div>
                </div>
                <div style="margin-top:20px;">
                    <div style="font-size:14px;color:#666;line-height:1.6;" id="videoExpandDesc"></div>
                    <div style="margin-top:15px;padding:10px 15px;background:linear-gradient(135deg,rgba(200,16,46,0.05) 0%,rgba(255,107,53,0.05) 100%);border-radius:6px;border:1px solid #e8a4ad;">
                        <span style="font-size:13px;color:#c8102e;font-weight:600;">💡 试用工作流</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 答题详情弹窗 -->
    <div class="quiz-detail-modal" id="quizDetailModal">
        <div class="quiz-detail-content">
            <div class="quiz-detail-header">
                <h3><span>📊</span> 答题详情</h3>
                <button class="quiz-detail-close" onclick="closeQuizDetailModal()">×</button>
            </div>
            <div class="quiz-detail-body" id="quizDetailBody">
                <!-- 动态插入答题详情内容 -->
            </div>
        </div>
    </div>

    <footer>
        <p>© 2026 集团日报 | 版权所有</p>
    </footer>

    <script>
        const newspapers = [
            {
                issue: 1,
                date: '2026年2月7日',
                tags: ['头条', '新年'],
                partyCulture: [
                    {
                        title: '坚持党的全面领导',
                        content: '坚决维护党中央权威和集中统一领导，把党的领导贯穿经济社会发展各方面全过程。',
                        title2: '坚持人民至上',
                        content2: '尊重人民主体地位，让现代化建设成果更多更公平惠及全体人民。',
                        author: '党委办公室',
                        media: { type: 'image', label: '学习配图', src: 'images/84889e55e5dc1b4b6cb5209b31db99b.png?v=1.0' }
                    },
                    {
                        title: '坚持高质量发展',
                        content: '以新发展理念引领发展，因地制宜发展新质生产力，推动经济持续健康发展和社会全面进步。',
                        title2: '坚持全面深化改革、扩大高水平开放',
                        content2: '持续增强发展动力和社会活力。',
                        author: '宣传部',
                        media: { type: 'image', label: '学习配图', src: 'images/5b6a8eaada269ccc0687340b3821c18.png?v=1.0' }
                    },
                    {
                        title: '坚持有效市场和有为政府相结合',
                        content: '充分发挥市场在资源配置中的决定性作用，更好发挥政府作用。',
                        title2: '坚持统筹发展和安全',
                        content2: '强化底线思维，有效防范化解各类风险，以新安全格局保障新发展格局。',
                        author: '党群工作部',
                        media: { type: 'image', label: '学习配图', src: 'images/fdacb7ebb7bcdec72519cd790447280.png?v=1.0' }
                    }
                ],
                aiQA: [
                    { q: '什么是生成式AI？', a: '生成式AI是能够创造新内容的人工智能技术，包括文本、图像、音频等。' },
                    { q: 'AI在企业中的应用？', a: '包括智能客服、数据分析、流程自动化、内容生成等。' }
                ],
                aiVideo: {
                    title: 'ai工具教程第1期',
                    desc: '介绍工作流基础概念',
                    videoSrc: 'videos/WeChat_20260208115545.mp4'
                },
                aiNews: [
                    { title: '<a href="https://www.miit.gov.cn/xwfb/gxdt/sjdt/art/2026/art_43d399a607c541e8884a63f835c7a3a4.html" target="_blank" class="news-link">工信部启动国家算力互联互通节点建设，打通跨区域算力调度 "大动脉" ↗</a>', content: '工信部今日发布通知，组织开展国家算力互联互通节点建设，旨在破除算力壁垒、提升算力统筹调度能力，支撑 AI 大模型训练与产业规模化应用。', author: '信息科技部' },
                    { title: '<a href="https://www.163.com/dy/article/KL5JD28E053469RG.html" target="_blank" class="news-link">小马智行获深圳全域 L4 级自动驾驶商业化许可，国产算力赋能自动驾驶规模化落地 ↗</a>', content: '小马智行今日正式取得深圳市全域范围 L4 级无人驾驶出租车商业化收费运营许可，标志深圳成为全球首个超大城市全域开放 L4 级自动驾驶商业化的城市。', author: '人力资源部' }
                ],
                practice: [
                    { question: '扣子工作流中开始节点跟结束节点的作用是什么？', options: ['A. 开始节点接收用户输入，结束节点返回结果', 'B. 开始节点美化界面，结束节点存储数据', 'C. 开始节点加速网络，结束节点减少延迟', 'D. 开始节点显示图片，结束节点播放音频'] },
                    { question: '如果用户输入的是文字，那么需要在开始节点确认什么参数的输入？', options: ['A. 字符串参数', 'B. 数组参数', 'C. 文件参数', 'D. 整数参数'] },
                    { question: '工作流中节点之间的连接意味着什么？', options: ['A. 数据流转', 'B. 节点装饰', 'C. 执行步骤', 'D. 固定排列'] },
                    { question: '为什么需要给AI提供工作流？', options: ['A. 提升AI理解能力', 'B. 减少计算资源', 'C. 固定AI思考逻辑', 'D. 简化代码结构'] },
                    { question: '智能体是什么？', options: ['A. 具备自主决策能力的AI系统', 'B. 普通的聊天机器人', 'C. 数据存储工具', 'D. 网络加速器'] }
                ]
            }
        ];

        let totalViews = parseInt(localStorage.getItem('totalViews')) || 0;
        let totalCompleted = parseInt(localStorage.getItem('totalCompleted')) || 0;

        function initBookshelf() {
            const bookshelf = document.getElementById('bookshelf');
            bookshelf.innerHTML = '';
            
            newspapers.forEach(np => {
                const card = document.createElement('div');
                card.className = 'newspaper-card';
                card.setAttribute('data-issue', np.issue);
                card.onclick = () => openModal(np);
                
                card.innerHTML = `
                    <div class="newspaper-cover">
                        <div class="issue">${np.issue}</div>
                        <div class="label">第 ${np.issue} 期</div>
                    </div>
                    <div class="newspaper-info">
                        <h3>集团日报 · 第${np.issue}期</h3>
                        <div class="date">${np.date}</div>
                        <div class="tags">
                            ${np.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                `;
                
                bookshelf.appendChild(card);
            });

            updateStats();
        }

        function updateStats() {
            document.getElementById('totalIssues').textContent = newspapers.length;
            document.getElementById('totalViews').textContent = totalViews.toLocaleString();
            document.getElementById('totalCompleted').textContent = totalCompleted.toLocaleString();
        }

        function searchNewspaper() {
            const input = document.getElementById('searchInput');
            const filter = input.value.replace(/[^0-9]/g, '');
            const cards = document.getElementsByClassName('newspaper-card');
            const emptyState = document.getElementById('emptyState');
            const bookshelf = document.getElementById('bookshelf');
            
            let found = false;
            
            for (let i = 0; i < cards.length; i++) {
                const issue = cards[i].getAttribute('data-issue');
                if (filter === '' || issue === filter) {
                    cards[i].style.display = '';
                    if (filter !== '') found = true;
                } else {
                    cards[i].style.display = 'none';
                }
            }
            
            if (filter === '') {
                bookshelf.style.display = 'grid';
                emptyState.classList.remove('active');
            } else if (!found) {
                bookshelf.style.display = 'none';
                emptyState.classList.add('active');
            } else {
                bookshelf.style.display = 'grid';
                emptyState.classList.remove('active');
            }
        }

        let currentNewspaper = null;

        function openModal(np) {
            currentNewspaper = np;
            const modal = document.getElementById('modal');
            document.getElementById('modalIssue').textContent = `第 ${np.issue} 期`;
            document.getElementById('modalDate').textContent = np.date;
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = '';
            
            let partyHtml = '<div class="section-block party-section">';
            partyHtml += '<div class="section-title-bar"><span class="icon">📖</span><svg width="320" height="35" viewBox="0 0 320 35" style="flex:1;"><text x="160" y="26" text-anchor="middle" class="svg-title" style="font-family:\'PingFang SC\',\'Microsoft YaHei\',sans-serif;font-size:17px;letter-spacing:2px;">"十五五"时期经济社会发展的六个"坚持"</text></svg><span class="tag">学习专栏</span></div>';
            partyHtml += '<div class="section-content">';
            partyHtml += '<div class="party-pages">';
            np.partyCulture.forEach((item, idx) => {
                partyHtml += `<div class="party-page${idx === 0 ? ' active' : ''}" data-page="${idx}" style="gap:12px;">`;
                partyHtml += '<div class="content-left" style="flex:4;">';
                if (item.title2) {
                    // 显示两个标题，添加关键词高亮
                    const highlightKeywords = (text) => {
                        return text.replace(/(党的领导|人民|高质量发展|改革|开放|市场|政府|发展|安全)/g, '<span style="color:#c8102e;font-weight:bold;background:linear-gradient(180deg,transparent 60%,rgba(200,16,46,0.2) 60%);padding:0 2px;">$1</span>');
                    };
                    partyHtml += `
                        <div class="news-item" style="padding:10px 0;border-bottom:1px dashed #ccc;">
                            <h4 style="font-size:20px;margin-bottom:10px;font-weight:bold;background:linear-gradient(90deg,#c8102e,#ff6b35);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">${item.title}</h4>
                            <p style="font-size:12px;line-height:1.7;color:#444;">${highlightKeywords(item.content)}</p>
                        </div>
                        <div class="news-item" style="padding:10px 0;">
                            <h4 style="font-size:20px;margin-bottom:10px;font-weight:bold;background:linear-gradient(90deg,#c8102e,#ff6b35);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">${item.title2}</h4>
                            <p style="font-size:12px;line-height:1.7;color:#444;">${highlightKeywords(item.content2)}</p>
                        </div>
                    `;
                } else {
                    partyHtml += `
                        <div class="news-item" style="padding:15px 0;">
                            <h4 style="font-size:22px;margin-bottom:12px;font-weight:bold;">${item.title}</h4>
                            <p style="font-size:13px;line-height:1.8;">${item.content}</p>
                            <div class="author" style="font-size:11px;margin-top:10px;">—— ${item.author}</div>
                        </div>
                    `;
                }
                partyHtml += '</div>';
                partyHtml += '<div class="media-right" style="flex:6;width:auto;display:flex;flex-direction:column;justify-content:center;">';
                if ((idx === 0 || idx === 1 || idx === 2) && item.media.src) {
                    // 第1、2、3页显示图片，带有点赞效果
                    const danmuId = `danmuStats${idx}`;
                    let pageTexts;
                    if (idx === 0) {
                        pageTexts = ['我赞同', '跟党走', '不忘初心', '牢记使命', '砥砺前行', '为人民服务', '坚决拥护', '认真学习', '深刻领会', '贯彻落实'];
                    } else if (idx === 1) {
                        pageTexts = ['高质量发展', '改革创新', '开放共赢', '新质生产力', '与时俱进', '开拓进取', '转型升级', '提质增效', '创新驱动', '绿色发展'];
                    } else {
                        pageTexts = ['有效市场', '有为政府', '资源配置', '统筹发展', '安全发展', '底线思维', '风险防范', '新发展格局', '保障安全', '稳定发展'];
                    }
                    partyHtml += `
                        <div class="media-placeholder party-image" style="min-height:150px;padding:0;width:100%;position:relative;overflow:hidden;cursor:pointer;" onclick="showLikeEffect(this, ${idx}, ${JSON.stringify(pageTexts).replace(/"/g, '&quot;')})">
                            <img src="${item.media.src}" style="width:100%;height:100%;object-fit:cover;border-radius:4px;" alt="${item.media.label}">
                            <div class="like-overlay" style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(200,16,46,0.8);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;pointer-events:none;">
                                <span style="color:#fff;font-size:18px;font-weight:bold;">❤️ 我认同！</span>
                            </div>
                        </div>
                        <div class="danmu-stats" id="${danmuId}" style="display:flex;gap:6px;justify-content:center;padding:5px 8px;margin-top:8px;background:rgba(200,16,46,0.05);border-radius:4px;white-space:nowrap;flex-shrink:0;">
                            <span style="font-size:11px;color:#999;">点击上方图片参与互动</span>
                        </div>
                    `;
                } else {
                    partyHtml += `
                        <div class="media-placeholder" style="min-height:150px;padding:40px 10px;width:100%;">
                            <div class="icon" style="font-size:42px;">${item.media.type === 'video' ? '▶' : '📷'}</div>
                            <div style="font-size:12px;margin-top:8px;">${item.media.label}</div>
                        </div>
                    `;
                }
                partyHtml += '</div>';
                partyHtml += '</div>';
            });
            partyHtml += '<div class="party-dots">';
            np.partyCulture.forEach((_, idx) => {
                partyHtml += `<span class="party-dot${idx === 0 ? ' active' : ''}" data-page="${idx}"></span>`;
            });
            partyHtml += '</div>';
            partyHtml += '</div></div></div>';
            
            let qaHtml = '<div class="section-block qa-chat-section">';
            qaHtml += '<div class="section-title-bar" style="justify-content: center;"><svg width="70" height="30" viewBox="0 0 70 30"><text x="35" y="22" text-anchor="middle" class="svg-title" style="font-family:\'PingFang SC\',\'Microsoft YaHei\',sans-serif;">AI问答</text></svg></div>';
            qaHtml += '<div class="section-content qa-chat-container" style="padding:0;display:flex;flex-direction:column;height:calc(100% - 40px);">';
            qaHtml += '<div class="qa-chat-hint" style="padding:8px 12px;background:linear-gradient(135deg,rgba(200,16,46,0.05) 0%,rgba(255,107,53,0.05) 100%);border-bottom:1px dashed #e8a4ad;text-align:center;">';
            qaHtml += '<span style="font-size:11px;color:#c8102e;">💬 点击输入可发送对视频内容的问题，下一期会全部解答</span>';
            qaHtml += '</div>';
            qaHtml += '<div class="qa-chat-messages" id="qaChatMessages" style="flex:1;overflow-y:auto;padding:10px;background:#fafafa;"></div>';
            qaHtml += '<div class="qa-chat-input-area" style="padding:10px 12px;background:#fff;border-top:1px solid #f0f0f0;box-sizing:border-box;">';
            qaHtml += '<div style="display:flex;gap:8px;width:100%;">';
            qaHtml += '<input type="text" id="qaChatInput" placeholder="请输入您的问题..." style="flex:1;min-width:0;padding:10px 14px;border:1px solid #e8a4ad;border-radius:20px;outline:none;font-size:13px;transition:all 0.3s;box-sizing:border-box;" onfocus="this.style.borderColor=\'#c8102e\'" onblur="this.style.borderColor=\'#e8a4ad\'">';
            qaHtml += '<button id="qaChatSend" style="flex-shrink:0;padding:10px 20px;background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);color:#fff;border:none;border-radius:20px;cursor:pointer;font-size:13px;transition:all 0.3s;white-space:nowrap;" onmouseover="this.style.transform=\'scale(1.05)\'" onmouseout="this.style.transform=\'scale(1)\'">发送</button>';
            qaHtml += '</div>';
            qaHtml += '</div>';
            qaHtml += '</div></div>';
            
            let videoHtml = '<div class="section-block">';
            videoHtml += '<div class="section-title-bar"><span class="icon">🎬</span><svg width="100" height="30" viewBox="0 0 100 30" style="flex:1;"><text x="50" y="22" text-anchor="middle" class="svg-title" style="font-family:\'PingFang SC\',\'Microsoft YaHei\',sans-serif;">AI工具科普</text></svg><span class="tag">视频教程</span></div>';
            videoHtml += '<div class="section-content">';
            videoHtml += `
                <div class="video-container" onclick="openVideoExpandModal('${np.aiVideo.videoSrc}', '${np.aiVideo.desc}')" style="position:relative;">
                    <video muted width="100%" height="auto" style="border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);pointer-events:none;">
                        <source src="${np.aiVideo.videoSrc}" type="video/mp4">
                        您的浏览器不支持视频播放
                    </video>
                    <div class="video-hint">点击放大播放</div>
                </div>
            `;
            videoHtml += '</div></div>';
            
            let aiNewsHtml = '<div class="section-block ai-news-section">';
            aiNewsHtml += '<div class="section-title-bar"><span class="icon">📰</span><svg width="70" height="30" viewBox="0 0 70 30" style="flex:1;"><text x="35" y="22" text-anchor="middle" class="svg-title" style="font-family:\'PingFang SC\',\'Microsoft YaHei\',sans-serif;">AI新闻</text></svg><span class="tag">前沿资讯</span></div>';
            aiNewsHtml += '<div class="section-content ai-news-container" style="padding:0;position:relative;overflow:hidden;">';
            aiNewsHtml += '<div class="ai-news-pages">';
            np.aiNews.forEach((item, idx) => {
                aiNewsHtml += `<div class="ai-news-page${idx === 0 ? ' active' : ''}" data-page="${idx}">`;
                aiNewsHtml += `
                    <div class="news-item" style="padding:15px;">
                        <h4 style="font-size:14px;line-height:1.5;margin-bottom:10px;">${item.title}<span class="ai-badge">AI</span></h4>
                        <p style="font-size:12px;line-height:1.7;color:#555;">${item.content}</p>
                        <div class="author" style="font-size:11px;margin-top:10px;color:#999;">—— ${item.author}</div>
                    </div>
                `;
                aiNewsHtml += '</div>';
            });
            aiNewsHtml += '</div>';
            aiNewsHtml += '<div class="ai-news-dots">';
            np.aiNews.forEach((_, idx) => {
                aiNewsHtml += `<span class="ai-news-dot${idx === 0 ? ' active' : ''}" data-page="${idx}"></span>`;
            });
            aiNewsHtml += '</div>';
            aiNewsHtml += '</div></div>';
            
            let practiceHtml = '<div class="section-block practice-quiz-section" style="position:relative;">';
            practiceHtml += '<div class="section-title-bar"><span class="icon">✍️</span><svg width="70" height="30" viewBox="0 0 70 30" style="flex:1;"><text x="35" y="22" text-anchor="middle" class="svg-title" style="font-family:\'PingFang SC\',\'Microsoft YaHei\',sans-serif;">实践题</text></svg><span class="tag">知识测验</span></div>';
            practiceHtml += '<div class="section-content practice-quiz-container" id="practiceQuizContainer" style="padding:20px;display:flex;flex-direction:column;justify-content:center;align-items:center;">';
            // 默认显示：答题进度 + 开始答题按钮
            practiceHtml += '<div id="practicePreview" style="text-align:center;width:100%;">';
            practiceHtml += '<div style="margin-bottom:20px;">';
            practiceHtml += '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">';
            practiceHtml += '<span style="font-size:12px;color:#666;">答题进度</span>';
            practiceHtml += '<span style="font-size:12px;color:#c8102e;font-weight:bold;"><span id="previewScore">0</span>/100分</span>';
            practiceHtml += '</div>';
            practiceHtml += '<div style="width:100%;height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden;">';
            practiceHtml += '<div id="previewProgressBar" style="width:0%;height:100%;background:linear-gradient(90deg,#c8102e,#ff6b35);border-radius:4px;transition:width 0.5s ease;"></div>';
            practiceHtml += '</div>';
            practiceHtml += '</div>';
            practiceHtml += '<button id="startQuizBtn" onclick="openQuizExpandModal()" style="background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);color:#fff;border:none;padding:12px 40px;border-radius:25px;font-size:14px;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 15px rgba(200,16,46,0.3);">开始答题</button>';
            practiceHtml += '<div id="mainNextBtn" style="display:none;margin-top:15px;">';
            practiceHtml += '<button onclick="nextQuestion()" style="width:100%;padding:12px 20px;background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:14px;transition:all 0.3s;white-space:nowrap;" onmouseover="this.style.transform=\'scale(1.05)\'" onmouseout="this.style.transform=\'scale(1)\'">下一题 ➡</button>';
            practiceHtml += '</div>';
            practiceHtml += '</div>';
            // 答题完成后显示：学习得分
            practiceHtml += '<div id="practiceResult" style="text-align:center;width:100%;display:none;">';
            practiceHtml += '<div style="margin-bottom:15px;">';
            practiceHtml += '<div style="font-size:14px;color:#666;margin-bottom:10px;">学习得分</div>';
            practiceHtml += '<div style="font-size:48px;font-weight:bold;background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;"><span id="resultScore">0</span><span style="font-size:20px;">分</span></div>';
            practiceHtml += '</div>';
            practiceHtml += '<div id="resultMessage" style="font-size:13px;color:#c8102e;margin-bottom:15px;"></div>';
            practiceHtml += '<button onclick="openQuizDetailModal()" style="background:#fff;color:#c8102e;border:2px solid #c8102e;padding:10px 30px;border-radius:20px;font-size:13px;cursor:pointer;transition:all 0.3s;">查看详情</button>';
            practiceHtml += '</div>';
            practiceHtml += '</div></div>';
            
            modalBody.innerHTML = partyHtml + '<div class="two-columns">' + qaHtml + videoHtml + '</div>' + '<div class="two-columns equal">' + aiNewsHtml + practiceHtml + '</div>';
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            totalViews++;
            localStorage.setItem('totalViews', totalViews);
            updateStats();
            
            const partyDots = document.querySelectorAll('.party-dot');
            const partyPages = document.querySelectorAll('.party-page');
            let currentPage = 0;
            let autoPlayInterval = null;
            
            // 切换页面函数
            function switchToPage(pageIdx) {
                partyPages.forEach(p => p.classList.remove('active'));
                partyDots.forEach(d => d.classList.remove('active'));
                partyPages[pageIdx].classList.add('active');
                partyDots[pageIdx].classList.add('active');
                currentPage = pageIdx;
            }
            
            // 手动点击切换
            partyDots.forEach((dot, idx) => {
                dot.onclick = function() {
                    switchToPage(idx);
                    // 点击后重置自动轮播计时
                    resetAutoPlay();
                };
            });
            
            // 自动轮播功能
            function startAutoPlay() {
                if (autoPlayInterval) clearInterval(autoPlayInterval);
                autoPlayInterval = setInterval(() => {
                    const nextPage = (currentPage + 1) % partyPages.length;
                    switchToPage(nextPage);
                }, 2000); // 每2秒切换一次
            }
            
            function stopAutoPlay() {
                if (autoPlayInterval) {
                    clearInterval(autoPlayInterval);
                    autoPlayInterval = null;
                }
            }
            
            function resetAutoPlay() {
                stopAutoPlay();
                startAutoPlay();
            }
            
            // 启动自动轮播
            startAutoPlay();
            
            // 鼠标悬停时暂停轮播
            const partySection = document.querySelector('.party-section');
            if (partySection) {
                partySection.addEventListener('mouseenter', stopAutoPlay);
                partySection.addEventListener('mouseleave', startAutoPlay);
            }
            
            // AI问答聊天功能
            initQAChat();
            
            // AI新闻轮播功能
            initAINewsSlider();
        }

        function initAINewsSlider() {
            const aiNewsDots = document.querySelectorAll('.ai-news-dot');
            const aiNewsPages = document.querySelectorAll('.ai-news-page');
            let currentNewsPage = 0;
            let aiNewsInterval = null;
            
            if (aiNewsPages.length <= 1) return;
            
            // 切换页面函数
            function switchToNewsPage(pageIdx) {
                aiNewsPages.forEach(p => p.classList.remove('active'));
                aiNewsDots.forEach(d => d.classList.remove('active'));
                aiNewsPages[pageIdx].classList.add('active');
                aiNewsDots[pageIdx].classList.add('active');
                currentNewsPage = pageIdx;
            }
            
            // 手动点击切换
            aiNewsDots.forEach((dot, idx) => {
                dot.onclick = function() {
                    switchToNewsPage(idx);
                    resetAINewsAutoPlay();
                };
            });
            
            // 自动轮播功能
            function startAINewsAutoPlay() {
                if (aiNewsInterval) clearInterval(aiNewsInterval);
                aiNewsInterval = setInterval(() => {
                    const nextPage = (currentNewsPage + 1) % aiNewsPages.length;
                    switchToNewsPage(nextPage);
                }, 3000); // 每3秒切换一次
            }
            
            function stopAINewsAutoPlay() {
                if (aiNewsInterval) {
                    clearInterval(aiNewsInterval);
                    aiNewsInterval = null;
                }
            }
            
            function resetAINewsAutoPlay() {
                stopAINewsAutoPlay();
                startAINewsAutoPlay();
            }
            
            // 启动自动轮播
            startAINewsAutoPlay();
            
            // 鼠标悬停时暂停轮播
            const aiNewsSection = document.querySelector('.ai-news-section');
            if (aiNewsSection) {
                aiNewsSection.addEventListener('mouseenter', stopAINewsAutoPlay);
                aiNewsSection.addEventListener('mouseleave', startAINewsAutoPlay);
            }
        }

        // AI问答聊天记录存储
        let qaChatMessages = [];

        // 实践题测验状态
        let quizState = {
            currentQuestion: 1,
            totalQuestions: 5,
            score: 0,
            answered: false,
            answers: [],
            questions: [
                {
                    question: '扣子工作流中开始节点跟结束节点的作用是什么？',
                    options: [
                        'A. 开始节点接收用户输入，结束节点返回结果',
                        'B. 开始节点美化界面，结束节点存储数据',
                        'C. 开始节点加速网络，结束节点减少延迟',
                        'D. 开始节点显示图片，结束节点播放音频'
                    ],
                    correct: 'A'
                },
                {
                    question: '如果用户输入的是文字，那么需要在开始节点确认什么参数的输入？',
                    options: [
                        'A. 字符串参数',
                        'B. 数组参数',
                        'C. 文件参数',
                        'D. 整数参数'
                    ],
                    correct: 'A'
                },
                {
                    question: '工作流中节点之间的连接意味着什么？',
                    options: [
                        'A. 数据流转',
                        'B. 节点装饰',
                        'C. 执行步骤',
                        'D. 固定排列'
                    ],
                    correct: 'C'
                },
                {
                    question: '为什么需要给AI提供工作流？',
                    options: [
                        'A. 提升AI理解能力',
                        'B. 减少计算资源',
                        'C. 固定AI思考逻辑',
                        'D. 简化代码结构'
                    ],
                    correct: 'C'
                },
                {
                    question: '智能体是什么？',
                    options: [
                        'A. 具备自主决策能力的AI系统',
                        'B. 普通的聊天机器人',
                        'C. 数据存储工具',
                        'D. 网络加速器'
                    ],
                    correct: 'A'
                }
            ]
        };

        // 生成实践题HTML内容
        function generateQuizContent(isExpanded = false) {
            const padding = isExpanded ? '20px' : '15px';
            const fontSize = isExpanded ? '16px' : '13px';
            const optionFontSize = isExpanded ? '15px' : '12px';
            const optionPadding = isExpanded ? '15px 20px' : '8px 12px';
            const gap = isExpanded ? '12px' : '8px';
            const progressHeight = isExpanded ? '8px' : '5px';
            
            let html = '<div class="quiz-progress" style="margin-bottom:' + (isExpanded ? '20px' : '10px') + ';">';
            html += '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:' + (isExpanded ? '10px' : '6px') + ';">';
            html += '<span style="font-size:' + (isExpanded ? '14px' : '11px') + ';color:#666;">答题进度</span>';
            html += '<span style="font-size:' + (isExpanded ? '14px' : '11px') + ';color:#c8102e;font-weight:bold;"><span id="' + (isExpanded ? 'expandScore' : 'currentScore') + '">' + quizState.score + '</span>/100分</span>';
            html += '</div>';
            html += '<div style="width:100%;height:' + progressHeight + ';background:#f0f0f0;border-radius:3px;overflow:hidden;">';
            html += '<div id="' + (isExpanded ? 'expandProgressBar' : 'progressBar') + '" style="width:' + ((quizState.currentQuestion / quizState.totalQuestions) * 100) + '%;height:100%;background:linear-gradient(90deg,#c8102e,#ff6b35);border-radius:3px;transition:width 0.5s ease;"></div>';
            html += '</div>';
            html += '</div>';
            
            html += '<div class="quiz-question-area">';
            html += '<div class="question-number" style="font-size:' + (isExpanded ? '14px' : '11px') + ';color:#999;margin-bottom:' + (isExpanded ? '12px' : '6px') + ';">第 <span id="' + (isExpanded ? 'expandQNum' : 'currentQNum') + '">' + quizState.currentQuestion + '</span> 题 / 共 ' + quizState.totalQuestions + ' 题</div>';
            html += '<div class="question-text" style="font-size:' + fontSize + ';color:#333;line-height:1.6;margin-bottom:' + (isExpanded ? '20px' : '10px') + ';font-weight:500;">' + quizState.questions[quizState.currentQuestion - 1].question + '</div>';
            html += '<div class="quiz-options-wrapper" style="max-height:' + (isExpanded ? '400px' : '150px') + ';">';
            html += '<div class="options-list" style="display:flex;flex-direction:column;gap:' + gap + ';">';
            
            quizState.questions[quizState.currentQuestion - 1].options.forEach((opt, idx) => {
                const option = ['A', 'B', 'C', 'D'][idx];
                html += '<div class="quiz-option ' + (isExpanded ? 'expand-option' : '') + '" data-option="' + option + '" style="padding:' + optionPadding + ';border:2px solid #e8e8e8;border-radius:' + (isExpanded ? '12px' : '8px') + ';cursor:pointer;transition:all 0.3s;font-size:' + optionFontSize + ';color:#555;" onmouseover="this.style.borderColor=\'#c8102e\';this.style.background=\'rgba(200,16,46,0.05)\'" onmouseout="if(!this.classList.contains(\'selected\')){this.style.borderColor=\'#e8e8e8\';this.style.background=\'transparent\'}">' + opt + '</div>';
            });
            
            html += '</div>';
            html += '</div>';
            html += '<div class="quiz-feedback" id="' + (isExpanded ? 'expandFeedback' : 'quizFeedback') + '" style="border-radius:' + (isExpanded ? '10px' : '6px') + ';display:none;margin-top:' + (isExpanded ? '20px' : '10px') + ';"></div>';
            html += '<div class="quiz-next-btn" id="' + (isExpanded ? 'expandNextBtn' : 'nextBtn') + '" style="display:none;margin-top:' + (isExpanded ? '20px' : '10px') + ';">';
            html += '<button onclick="nextQuestion()" style="width:100%;padding:12px 20px;background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:' + (isExpanded ? '15px' : '13px') + ';transition:all 0.3s;white-space:nowrap;" onmouseover="this.style.transform=\'scale(1.05)\'" onmouseout="this.style.transform=\'scale(1)\'">下一题 ➡</button>';
            html += '</div>';
            html += '</div>';
            
            return html;
        }

        // 打开放大弹窗
        function openQuizExpandModal() {
            const modal = document.getElementById('quizExpandModal');
            const body = document.getElementById('quizExpandBody');
            
            body.innerHTML = generateQuizContent(true);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // 绑定放大弹窗的选项点击事件
            bindExpandQuizEvents();
        }

        // 关闭放大弹窗
        function closeQuizExpandModal() {
            const modal = document.getElementById('quizExpandModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            
            // 同步更新主界面的显示
            updateMainQuizDisplay();
        }

        function openVideoExpandModal(videoSrc, desc) {
            const modal = document.getElementById('videoExpandModal');
            const videoPlayer = document.getElementById('videoExpandPlayer');
            const videoSource = document.getElementById('videoExpandSource');
            const videoDesc = document.getElementById('videoExpandDesc');
            
            videoSource.src = videoSrc;
            videoDesc.textContent = desc;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            videoPlayer.load();
            videoPlayer.muted = false;
            videoPlayer.play();
            
            // 为已有消息创建弹幕
            const danmuContainer = document.getElementById('danmuContainer');
            if (danmuContainer) {
                danmuContainer.innerHTML = '';
                qaChatMessages.forEach((msg, idx) => {
                    setTimeout(() => {
                        createDanmu(msg.text);
                    }, idx * 500 + Math.random() * 1000);
                });
            }
        }

        function closeVideoExpandModal() {
            const modal = document.getElementById('videoExpandModal');
            const videoPlayer = document.getElementById('videoExpandPlayer');
            
            videoPlayer.pause();
            videoPlayer.currentTime = 0;
            
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function openQuizDetailModal() {
            const modal = document.getElementById('quizDetailModal');
            const body = document.getElementById('quizDetailBody');
            
            let html = '<div class="quiz-detail-summary">';
            html += '<div style="font-size:14px;color:#666;margin-bottom:8px;">总得分</div>';
            html += '<div class="score">' + quizState.score + '<span style="font-size:20px;">分</span></div>';
            html += '<div style="margin-top:10px;font-size:13px;color:#999;">共 ' + quizState.totalQuestions + ' 题，答对 ' + quizState.answers.filter(a => a.isCorrect).length + ' 题</div>';
            html += '</div>';
            
            html += '<div style="font-size:15px;font-weight:600;color:#333;margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #f0f0f0;">答题详情</div>';
            
            quizState.answers.forEach((answer, idx) => {
                const question = quizState.questions[answer.questionIndex];
                html += '<div class="quiz-detail-item ' + (answer.isCorrect ? 'correct' : 'wrong') + '">';
                html += '<div class="quiz-detail-question">第 ' + (idx + 1) + ' 题：' + answer.question + '</div>';
                html += '<div class="quiz-detail-answer">';
                html += '<span class="label">您的答案：</span>';
                html += '<span class="value ' + (answer.isCorrect ? 'correct' : 'wrong') + '">' + answer.selectedOption + '</span>';
                html += '</div>';
                html += '<div class="quiz-detail-answer">';
                html += '<span class="label">正确答案：</span>';
                html += '<span class="value correct">' + answer.correctOption + '</span>';
                html += '</div>';
                html += '</div>';
            });
            
            body.innerHTML = html;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeQuizDetailModal() {
            const modal = document.getElementById('quizDetailModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function createDanmu(text) {
            const danmuContainer = document.getElementById('danmuContainer');
            if (!danmuContainer) return;
            
            const danmu = document.createElement('div');
            danmu.className = 'danmu-item';
            danmu.textContent = text;
            
            const containerHeight = danmuContainer.offsetHeight;
            const danmuHeight = 30;
            const maxTop = containerHeight - danmuHeight;
            const randomTop = Math.random() * maxTop;
            
            danmu.style.top = randomTop + 'px';
            danmu.style.left = '100%';
            
            const duration = 5 + Math.random() * 3;
            danmu.style.animationDuration = duration + 's';
            
            danmuContainer.appendChild(danmu);
            
            setTimeout(() => {
                if (danmu.parentNode) {
                    danmu.parentNode.removeChild(danmu);
                }
            }, duration * 1000);
        }

        // 绑定放大弹窗的点击事件
        function bindExpandQuizEvents() {
            const options = document.querySelectorAll('.expand-option');
            const feedback = document.getElementById('expandFeedback');
            const progressBar = document.getElementById('expandProgressBar');
            const currentScore = document.getElementById('expandScore');
            const nextBtn = document.getElementById('expandNextBtn');
            
            if (!options.length) return;
            
            options.forEach(option => {
                option.addEventListener('click', function() {
                    if (quizState.answered) return;
                    
                    const selectedOption = this.dataset.option;
                    const correctOption = quizState.questions[quizState.currentQuestion - 1].correct;
                    
                    quizState.answered = true;
                    
                    // 记录答题情况
                    quizState.answers.push({
                        questionIndex: quizState.currentQuestion - 1,
                        question: quizState.questions[quizState.currentQuestion - 1].question,
                        selectedOption: selectedOption,
                        correctOption: correctOption,
                        isCorrect: selectedOption === correctOption
                    });
                    
                    // 标记选中状态
                    this.classList.add('selected');
                    
                    // 禁用所有选项
                    options.forEach(opt => opt.classList.add('disabled'));
                    
                    // 显示正确答案
                    options.forEach(opt => {
                        if (opt.dataset.option === correctOption) {
                            opt.classList.add('correct');
                        }
                    });
                    
                    // 判断对错
                    if (selectedOption === correctOption) {
                        quizState.score += 20;
                        feedback.innerHTML = '<div style="display:flex;align-items:center;gap:10px;"><span style="font-size:24px;">✅</span><div><div style="font-weight:bold;font-size:16px;">回答正确！</div><div style="font-size:14px;margin-top:5px;">获得 20 分</div></div></div>';
                        feedback.className = 'quiz-feedback correct';
                    } else {
                        this.classList.add('wrong');
                        feedback.innerHTML = '<div style="display:flex;align-items:center;gap:10px;"><span style="font-size:24px;">❌</span><div><div style="font-weight:bold;font-size:16px;">回答错误</div><div style="font-size:14px;margin-top:5px;">正确答案是 ' + correctOption + '</div></div></div>';
                        feedback.className = 'quiz-feedback wrong';
                    }
                    
                    feedback.style.display = 'block';
                    
                    // 更新进度条和分数
                    const progress = (quizState.currentQuestion / quizState.totalQuestions) * 100;
                    progressBar.style.width = progress + '%';
                    currentScore.textContent = quizState.score;
                    
                    // 显示"下一题"按钮
                    if (nextBtn) {
                        if (quizState.currentQuestion < quizState.totalQuestions) {
                            nextBtn.style.display = 'block';
                            nextBtn.querySelector('button').textContent = '下一题 ➡';
                        } else {
                            nextBtn.style.display = 'block';
                            nextBtn.querySelector('button').textContent = '查看结果 🎉';
                        }
                    }
                });
            });
        }

        function nextQuestion() {
            if (quizState.currentQuestion >= quizState.totalQuestions) {
                totalCompleted++;
                localStorage.setItem('totalCompleted', totalCompleted);
                updateStats();
                closeQuizExpandModal();
                return;
            }
            
            quizState.currentQuestion++;
            quizState.answered = false;
            
            const body = document.getElementById('quizExpandBody');
            body.innerHTML = generateQuizContent(true);
            
            bindExpandQuizEvents();
        }

        // 更新主界面实践题显示
        function updateMainQuizDisplay() {
            const previewScore = document.getElementById('previewScore');
            const previewProgress = document.getElementById('previewProgressBar');
            const practicePreview = document.getElementById('practicePreview');
            const practiceResult = document.getElementById('practiceResult');
            const resultScore = document.getElementById('resultScore');
            const resultMessage = document.getElementById('resultMessage');
            const mainNextBtn = document.getElementById('mainNextBtn');
            const startQuizBtn = document.getElementById('startQuizBtn');
            
            // 更新预览区域的进度
            if (previewScore) previewScore.textContent = quizState.score;
            if (previewProgress) previewProgress.style.width = ((quizState.currentQuestion / quizState.totalQuestions) * 100) + '%';
            
            // 如果已答题，切换到结果显示
            if (quizState.answered) {
                if (practicePreview) practicePreview.style.display = 'none';
                if (practiceResult) {
                    practiceResult.style.display = 'block';
                    if (resultScore) resultScore.textContent = quizState.score;
                    if (resultMessage) {
                        if (quizState.score >= 80) {
                            resultMessage.textContent = '太棒了！成绩优秀！🎉';
                        } else if (quizState.score >= 60) {
                            resultMessage.textContent = '不错哦！继续加油！💪';
                        } else {
                            resultMessage.textContent = '再接再厉！下次更好！📚';
                        }
                    }
                }
                
                // 显示"下一题"按钮
                if (mainNextBtn) {
                    if (quizState.currentQuestion < quizState.totalQuestions) {
                        mainNextBtn.style.display = 'block';
                        mainNextBtn.querySelector('button').textContent = '下一题 ➡';
                    } else {
                        mainNextBtn.style.display = 'block';
                        mainNextBtn.querySelector('button').textContent = '查看结果 🎉';
                    }
                }
                
                // 隐藏"开始答题"按钮
                if (startQuizBtn) startQuizBtn.style.display = 'none';
            } else {
                // 未答题时，显示"开始答题"按钮
                if (startQuizBtn) startQuizBtn.style.display = 'block';
                if (mainNextBtn) mainNextBtn.style.display = 'none';
            }
        }

        function initQAChat() {
            const chatInput = document.getElementById('qaChatInput');
            const chatSend = document.getElementById('qaChatSend');
            const chatMessages = document.getElementById('qaChatMessages');
            
            if (!chatInput || !chatSend || !chatMessages) return;
            
            // 从localStorage加载消息
            const savedMessages = localStorage.getItem('qaChatMessages');
            if (savedMessages) {
                try {
                    qaChatMessages = JSON.parse(savedMessages);
                } catch (e) {
                    console.error('加载消息失败:', e);
                    qaChatMessages = [];
                }
            }
            
            // 渲染已有消息
            renderQAMessages();
            
            // 发送消息函数
            function sendMessage() {
                const text = chatInput.value.trim();
                if (!text) return;
                
                // 添加到消息数组
                qaChatMessages.push({
                    text: text,
                    time: new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })
                });
                
                // 保存到localStorage
                localStorage.setItem('qaChatMessages', JSON.stringify(qaChatMessages));
                
                // 创建弹幕
                createDanmu(text);
                
                // 清空输入框
                chatInput.value = '';
                
                // 重新渲染
                renderQAMessages();
                
                // 滚动到底部
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // 渲染消息函数
            function renderQAMessages() {
                if (qaChatMessages.length === 0) {
                    chatMessages.innerHTML = '<div style="text-align:center;color:#999;font-size:12px;padding:20px;">暂无问题，快来提问吧~</div>';
                    return;
                }
                
                chatMessages.innerHTML = qaChatMessages.map((msg, idx) => `
                    <div class="qa-message" style="margin-bottom:10px;display:flex;flex-direction:column;align-items:flex-end;animation:slideInRight 0.3s ease;">
                        <div style="max-width:90%;background:linear-gradient(135deg,#c8102e 0%,#ff6b35 100%);color:#fff;padding:8px 12px;border-radius:16px 16px 4px 16px;font-size:12px;line-height:1.4;word-break:break-all;">
                            ${msg.text}
                        </div>
                        <div style="font-size:10px;color:#999;margin-top:3px;margin-right:4px;">${msg.time}</div>
                    </div>
                `).join('');
            }
            
            // 绑定发送事件
            chatSend.onclick = sendMessage;
            
            // 回车发送
            chatInput.onkeydown = function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            };
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function shareNewspaper() {
            if (!currentNewspaper) {
                alert('请先打开一份日报');
                return;
            }

            // 生成分享链接
            const shareUrl = `${window.location.origin}${window.location.pathname}?page=share&issue=${currentNewspaper.issue}&date=${encodeURIComponent(currentNewspaper.date)}`;

            // 复制链接到剪贴板
            navigator.clipboard.writeText(shareUrl)
                .then(() => {
                    alert('链接已复制到剪贴板，请发送到手机查看！');
                })
                .catch(err => {
                    console.error('复制失败:', err);
                    // 降级方案：显示链接让用户手动复制
                    prompt('请复制以下链接到手机查看:', shareUrl);
                });
        }

        // 弹幕统计对象 - 第1页
        const danmuCountsPage0 = {
            '我赞同': 0,
            '跟党走': 0,
            '不忘初心': 0,
            '牢记使命': 0,
            '砥砺前行': 0,
            '为人民服务': 0,
            '坚决拥护': 0,
            '认真学习': 0,
            '深刻领会': 0,
            '贯彻落实': 0
        };

        // 弹幕统计对象 - 第2页
        const danmuCountsPage1 = {
            '高质量发展': 0,
            '改革创新': 0,
            '开放共赢': 0,
            '新质生产力': 0,
            '与时俱进': 0,
            '开拓进取': 0,
            '转型升级': 0,
            '提质增效': 0,
            '创新驱动': 0,
            '绿色发展': 0
        };

        // 弹幕统计对象 - 第3页
        const danmuCountsPage2 = {
            '有效市场': 0,
            '有为政府': 0,
            '资源配置': 0,
            '统筹发展': 0,
            '安全发展': 0,
            '底线思维': 0,
            '风险防范': 0,
            '新发展格局': 0,
            '保障安全': 0,
            '稳定发展': 0
        };

        function updateTopDanmuTags(pageIdx) {
            // 获取对应的统计区域
            const danmuId = `danmuStats${pageIdx}`;
            const statsContainer = document.getElementById(danmuId);
            if (!statsContainer) return;
            
            // 获取对应的统计对象
            let danmuCounts;
            if (pageIdx === 0) {
                danmuCounts = danmuCountsPage0;
            } else if (pageIdx === 1) {
                danmuCounts = danmuCountsPage1;
            } else {
                danmuCounts = danmuCountsPage2;
            }
            
            // 按点击次数排序，取前4个
            const sortedTags = Object.entries(danmuCounts)
                .filter(([tag, count]) => count > 0)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 4);
            
            // 如果没有点击记录，显示默认提示
            if (sortedTags.length === 0) {
                statsContainer.innerHTML = '<span style="font-size:11px;color:#999;">点击上方图片参与互动</span>';
                return;
            }
            
            // 更新显示
            statsContainer.innerHTML = sortedTags.map(([tag, count]) => `
                <span class="danmu-tag" style="padding:2px 8px;border:1px dashed #c8102e;border-radius:10px;font-size:10px;color:#c8102e;background:#fff;line-height:1.4;">${tag}<b style="color:#ff6b35;margin-left:3px;">${count}</b></span>
            `).join('');
        }

        function showLikeEffect(element, pageIdx, danmuTexts) {
            // 解析弹幕文本数组
            const texts = typeof danmuTexts === 'string' ? JSON.parse(danmuTexts) : danmuTexts;
            
            // 随机选择一个文本
            const randomText = texts[Math.floor(Math.random() * texts.length)];
            
            // 获取对应的统计对象
            let danmuCounts;
            if (pageIdx === 0) {
                danmuCounts = danmuCountsPage0;
            } else if (pageIdx === 1) {
                danmuCounts = danmuCountsPage1;
            } else {
                danmuCounts = danmuCountsPage2;
            }
            
            // 更新统计
            danmuCounts[randomText]++;
            
            // 更新前4个热门标签显示
            updateTopDanmuTags(pageIdx);
            
            // 创建飘出的文字效果
            const likeText = document.createElement('div');
            likeText.className = 'like-float-text';
            likeText.textContent = randomText + ' +' + danmuCounts[randomText];
            likeText.style.cssText = `
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                color: #fff;
                font-size: 18px;
                font-weight: bold;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                pointer-events: none;
                z-index: 100;
                animation: floatUp 1.5s ease forwards;
                white-space: nowrap;
            `;
            
            element.appendChild(likeText);
            
            // 动画结束后移除
            setTimeout(() => {
                likeText.remove();
            }, 1500);
        }

        document.getElementById('closeBtn').onclick = closeModal;

        document.getElementById('modal').onclick = function(e) {
            if (e.target.id === 'modal') {
                closeModal();
            }
        };

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // 页面切换功能
        function switchPage(page) {
            // 隐藏所有页面
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(p => {
                p.style.display = 'none';
            });

            // 显示选中的页面
            const selectedPage = document.getElementById(page + 'Page');
            if (selectedPage) {
                selectedPage.style.display = 'block';
            }

            // 控制搜索栏和组织标题的显示/隐藏
            const searchBox = document.querySelector('.search-box');
            const organizationTitle = document.querySelector('.organization-title');
            if (searchBox && organizationTitle) {
                if (page === 'organization') {
                    searchBox.style.display = 'none';
                    organizationTitle.style.display = 'block';
                } else if (page === 'meeting') {
                    searchBox.style.display = 'none';
                    organizationTitle.style.display = 'none';
                } else {
                    searchBox.style.display = 'block';
                    organizationTitle.style.display = 'none';
                }
            }

            // 更新导航栏激活状态
            const navItems = document.querySelectorAll('.top-nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            const activeNavItem = document.querySelector(`.top-nav-item[data-page="${page}"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
            }
        }

        // 架构目录下拉菜单功能
        function toggleArchitectureMenu() {
            const btn = document.querySelector('.architecture-btn');
            const dropdown = document.getElementById('architectureDropdown');
            if (btn && dropdown) {
                btn.classList.toggle('active');
                dropdown.classList.toggle('active');
            }
        }

        // 二级菜单切换功能
        function toggleSubmenu(element) {
            console.log('toggleSubmenu called');
            console.log('element:', element);
            const submenu = element.nextElementSibling;
            console.log('submenu:', submenu);
            if (submenu && submenu.classList.contains('submenu')) {
                console.log('toggling submenu');
                submenu.classList.toggle('active');
                console.log('submenu classList:', submenu.classList);
            }
        }

        // 节点选中功能
        function selectNode(element) {
            const allNodes = document.querySelectorAll('.node');
            
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                hideNodeDetail();
            } else {
                allNodes.forEach(node => {
                    node.classList.remove('selected');
                });
                element.classList.add('selected');
                showNodeDetail(element);
            }
        }

        // 显示节点详情
        function showNodeDetail(element) {
            const title = element.getAttribute('data-title');
            const intro = element.getAttribute('data-intro');
            const responsibilities = element.getAttribute('data-responsibilities');
            const goals = element.getAttribute('data-goals');
            const tags = JSON.parse(element.getAttribute('data-tags'));

            const detailPanel = document.getElementById('detailPanel');
            
            detailPanel.innerHTML = `
                <div class="node-detail active">
                    <div class="node-detail-title">${title}</div>
                    
                    <div class="node-detail-section">
                        <div class="node-detail-section-title">职位介绍</div>
                        <div class="node-detail-content">${intro}</div>
                    </div>
                    
                    <div class="node-detail-section">
                        <div class="node-detail-section-title">核心职责</div>
                        <div class="node-detail-content">${responsibilities}</div>
                    </div>
                    
                    <div class="node-detail-section">
                        <div class="node-detail-section-title">核心目标</div>
                        <div class="node-detail-content">${goals}</div>
                    </div>
                    
                    <div class="node-detail-section">
                        <div class="node-detail-section-title">职业调性关键词</div>
                        <div class="node-detail-tags">
                            ${tags.map(tag => `<span class="node-detail-tag ${tag.type}">${tag.name}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // 隐藏节点详情
        function hideNodeDetail() {
            const detailPanel = document.getElementById('detailPanel');
            detailPanel.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">👆</div>
                    <p>点击画布中的节点查看详情</p>
                </div>
            `;
        }

        // 切换标签页
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.info-tab');
            const panels = document.querySelectorAll('.info-panel');
            
            tabs.forEach(t => t.classList.remove('active'));
            panels.forEach(p => p.style.display = 'none');
            
            document.querySelector(`.info-tab[data-tab="${tab}"]`).classList.add('active');
            document.getElementById(`${tab}Panel`).style.display = 'block';
            
            if (tab === 'qa') {
                 document.getElementById('qaEmptyState').style.display = 'none';
                 document.getElementById('qaInputArea').style.display = 'block';
                 document.getElementById('qaResultArea').style.display = 'none';
             }
        }

        function matchNodeByKeywords() {
            const inputText = document.getElementById('qaInput').value.trim();
            if (!inputText) {
                alert('请输入您的描述或需求');
                return;
            }

            const nodes = document.querySelectorAll('.node');
            let bestMatch = null;
            let highestScore = 0;
            const matchResults = [];

            nodes.forEach(node => {
                const title = node.getAttribute('data-title');
                const intro = node.getAttribute('data-intro');
                const responsibilities = node.getAttribute('data-responsibilities');
                const goals = node.getAttribute('data-goals');
                const tags = JSON.parse(node.getAttribute('data-tags'));

                let score = 0;
                let matchedKeywords = [];
                const tagScores = {};

                tags.forEach(tag => {
                    let tagScore = 0;
                    
                    if (inputText.includes(tag.name)) {
                        tagScore += 15;
                    }

                    const synonyms = getSynonyms(tag.name);
                    synonyms.forEach(synonym => {
                        if (inputText.includes(synonym)) {
                            tagScore += 10;
                        }
                    });

                    if (tagScore > 0) {
                        tagScores[tag.name] = tagScore;
                        matchedKeywords.push(tag.name);
                    }
                });

                const semanticScore = calculateSemanticScore(inputText, tags);
                Object.keys(semanticScore).forEach(tagName => {
                    if (!tagScores[tagName]) {
                        tagScores[tagName] = semanticScore[tagName];
                    } else {
                        tagScores[tagName] += semanticScore[tagName];
                    }
                });

                const roleKeywords = extractRoleKeywords(inputText);
                roleKeywords.forEach(roleKeyword => {
                    if (title.includes(roleKeyword)) {
                        score += 20;
                        matchedKeywords.push(roleKeyword + '(职位)');
                    }
                });

                const actionKeywords = extractActionKeywords(inputText);
                actionKeywords.forEach(actionKeyword => {
                    const allText = `${intro} ${responsibilities} ${goals}`;
                    if (allText.includes(actionKeyword)) {
                        score += 8;
                        matchedKeywords.push(actionKeyword + '(职责)');
                    }
                });

                Object.values(tagScores).forEach(tagScore => {
                    score += tagScore;
                });

                if (score > 0) {
                    matchResults.push({
                        node: node,
                        score: score,
                        matchedKeywords: matchedKeywords,
                        tagScores: tagScores
                    });
                }

                if (score > highestScore) {
                    highestScore = score;
                    bestMatch = node;
                }
            });

            if (bestMatch) {
                activateNodeAndRelated(bestMatch);
                showMatchResult(bestMatch, matchResults);
            } else {
                alert('未找到匹配的岗位，请尝试其他描述');
            }
        }

        function getSynonyms(keyword) {
            const synonymMap = {
                '策划': ['规划', '设计', '构思', '创意', '方案'],
                '设计': ['创意', '美术', '界面', '交互', '视觉'],
                '管理': ['领导', '组织', '协调', '统筹', '负责'],
                '开发': ['编程', '代码', '技术', '实现', '构建'],
                '运营': ['推广', '营销', '用户', '增长', '活动'],
                '产品': ['规划', '设计', '需求', '功能', '体验'],
                '技术': ['开发', '编程', '代码', '架构', '系统'],
                '服务': ['支持', '帮助', '解决', '响应', '保障'],
                '客户': ['用户', '消费者', '客户', '企业', '机构'],
                '数据': ['分析', '统计', '信息', '报表', '指标'],
                '创新': ['创意', '突破', '改进', '优化', '提升'],
                '责任': ['担当', '负责', '义务', '承诺', '使命'],
                '效率': ['快速', '高效', '及时', '速度', '优化'],
                '质量': ['标准', '品质', '优秀', '卓越', '可靠'],
                '团队': ['协作', '合作', '配合', '沟通', '组织'],
                '沟通': ['交流', '表达', '协调', '联系', '传达'],
                '分析': ['研究', '调研', '评估', '判断', '洞察'],
                '执行': ['实施', '落实', '推进', '完成', '交付'],
                '目标': ['目的', '方向', '愿景', '计划', '指标']
            };
            return synonymMap[keyword] || [];
        }

        function calculateSemanticScore(inputText, tags) {
            const scores = {};
            const semanticPatterns = {
                '策划思维': ['策划', '规划', '设计', '构思', '创意', '方案', '策略', '思路', '产品策划', '产品规划', '产品方案', '架构规划', '战略规划', '发展策划', '活动策划'],
                '产品思维': ['产品', '需求', '功能', '体验', '用户', '市场', '竞争', '产品设计', '产品功能', '产品体验', '产品开发'],
                '用户思维': ['用户', '客户', '体验', '需求', '满意', '反馈', '用户需求', '用户体验'],
                '企业思维': ['企业', '客户', '商业', '业务', '合作', '服务', '企业服务', '商业合作'],
                '金融思维': ['金融', '银行', '证券', '投资', '风险', '合规', '金融业务', '投资管理'],
                '技术思维': ['技术', '开发', '编程', '代码', '架构', '系统', '技术开发', '系统架构'],
                '服务意识': ['服务', '支持', '帮助', '解决', '响应', '满意', '客户服务', '用户服务'],
                '创新意识': ['创新', '创意', '突破', '改进', '优化', '提升', '产品创新', '技术创新'],
                '责任意识': ['责任', '担当', '负责', '义务', '承诺', '使命', '责任担当'],
                '效率意识': ['效率', '快速', '高效', '及时', '速度', '优化', '高效执行'],
                '体验意识': ['体验', '感受', '满意', '舒适', '便捷', '友好', '用户体验'],
                '合规意识': ['合规', '规范', '标准', '制度', '规则', '合法', '合规管理'],
                '风险意识': ['风险', '安全', '保障', '防范', '控制', '预警', '风险控制'],
                '成本意识': ['成本', '预算', '节约', '控制', '效益', '投入', '成本控制'],
                '品牌思维': ['品牌', '形象', '声誉', '知名度', '影响力', '价值', '品牌建设'],
                '客户意识': ['客户', '用户', '服务', '满意', '需求', '关系', '客户关系'],
                '公正意识': ['公正', '公平', '客观', '中立', '透明', '规范', '公正公平'],
                '福利思维': ['福利', '关怀', '保障', '权益', '待遇', '关怀', '员工福利'],
                '审计思维': ['审计', '监督', '检查', '核查', '评估', '合规', '审计监督'],
                '物流思维': ['物流', '运输', '配送', '仓储', '供应链', '流通', '物流配送'],
                '培训意识': ['培训', '学习', '提升', '成长', '发展', '教育', '培训提升'],
                '电商意识': ['电商', '平台', '线上', '交易', '订单', '营销', '电商平台'],
                '发展意识': ['发展', '成长', '进步', '提升', '改进', '创新', '持续发展'],
                '架构思维': ['架构', '设计', '系统', '技术', '规划', '优化', '架构设计', '系统架构', '架构规划'],
                '研发思维': ['研发', '开发', '技术', '创新', '产品', '技术', '产品研发'],
                '协调思维': ['协调', '沟通', '整合', '协作', '配合', '流程', '协调沟通'],
                '用户体验': ['体验', '用户', '界面', '交互', '设计', '感受', '用户体验设计'],
                '账户权限': ['账户', '权限', '安全', '管理', '控制', '认证', '权限管理'],
                '交易订单': ['交易', '订单', '支付', '结算', '流程', '业务', '交易流程'],
                '任务匹配': ['任务', '匹配', '推荐', '算法', '智能', '精准', '任务匹配'],
                '消息管理': ['消息', '通知', '推送', '提醒', '沟通', '信息', '消息推送'],
                '产品开发': ['产品', '开发', '研发', '设计', '实现', '迭代', '产品开发'],
                '流程优化': ['流程', '优化', '改进', '效率', '提升', '规范', '流程优化'],
                '功能整合': ['功能', '整合', '集成', '协调', '统一', '完善', '功能整合'],
                '数据思维': ['数据', '分析', '统计', '挖掘', '洞察', '报表', '数据分析'],
                '数仓思维': ['数仓', '仓库', '存储', '管理', '维护', '优化', '数据仓库'],
                '平台思维': ['平台', '系统', '架构', '技术', '服务', '支撑', '平台架构'],
                '战略思维': ['战略', '规划', '发展', '投资', '分析', '评估', '战略规划', '战略投资'],
                '系统设计': ['系统', '设计', '架构', '技术', '规划', '开发', '系统设计'],
                '战略规划': ['战略', '规划', '发展', '投资', '分析', '评估', '战略规划'],
                '活动策划': ['活动', '策划', '组织', '执行', '推广', '宣传', '活动策划'],
                '稳定意识': ['稳定', '可靠', '持续', '安全', '保障', '稳定运行'],
                '架构规划': ['架构', '规划', '设计', '系统', '技术', '架构规划'],
                '架构优化': ['架构', '优化', '改进', '提升', '完善', '架构优化']
            };

            tags.forEach(tag => {
                if (semanticPatterns[tag.name]) {
                    let patternScore = 0;
                    semanticPatterns[tag.name].forEach(pattern => {
                        if (inputText.includes(pattern)) {
                            patternScore += 8;
                        }
                    });
                    
                    if (inputText.includes('产品策划') && (tag.name === '策划思维' || tag.name === '架构规划' || tag.name === '系统设计')) {
                        patternScore += 15;
                    }
                    
                    if (inputText.includes('产品') && (tag.name === '产品思维' || tag.name === '产品开发')) {
                        patternScore += 10;
                    }
                    
                    if (patternScore > 0) {
                        scores[tag.name] = patternScore;
                    }
                }
            });

            return scores;
        }

        function extractRoleKeywords(inputText) {
            const rolePatterns = [
                '产品', '策划', '设计', '开发', '技术', '运营', '市场', '销售',
                '客服', '人力', '财务', '法务', '审计', '物流', '采购', '行政',
                '培训', '电商', '金融', '数据', '架构', '管理', '主管', '总监',
                '经理', '专员', '助理', '顾问', '分析师', '工程师', '设计师'
            ];
            const foundKeywords = [];
            rolePatterns.forEach(pattern => {
                if (inputText.includes(pattern)) {
                    foundKeywords.push(pattern);
                }
            });
            return foundKeywords;
        }

        function extractActionKeywords(inputText) {
            const actionPatterns = [
                '策划', '设计', '开发', '实现', '管理', '组织', '协调', '沟通',
                '分析', '研究', '评估', '监督', '检查', '培训', '学习', '提升',
                '优化', '改进', '创新', '推广', '营销', '销售', '服务', '支持',
                '解决', '处理', '维护', '保障', '控制', '规划', '制定', '执行',
                '实施', '推进', '完成', '交付', '运营', '管理', '负责', '领导'
            ];
            const foundKeywords = [];
            actionPatterns.forEach(pattern => {
                if (inputText.includes(pattern)) {
                    foundKeywords.push(pattern);
                }
            });
            return foundKeywords;
        }

        function activateNodeAndRelated(targetNode) {
            const allNodes = document.querySelectorAll('.node');
            allNodes.forEach(node => {
                node.classList.remove('selected', 'related-active');
            });

            targetNode.classList.add('selected');

            const relationships = JSON.parse(targetNode.getAttribute('data-relationships'));
            if (relationships && Array.isArray(relationships)) {
                relationships.forEach(rel => {
                    const relatedNode = document.querySelector(`.${rel.target}`);
                    if (relatedNode) {
                        relatedNode.classList.add('related-active');
                    }
                });
            }

            allNodes.forEach(node => {
                if (node !== targetNode) {
                    const nodeRelationships = JSON.parse(node.getAttribute('data-relationships'));
                    if (nodeRelationships && Array.isArray(nodeRelationships)) {
                        nodeRelationships.forEach(rel => {
                            if (rel.target === targetNode.classList[1]) {
                                node.classList.add('related-active');
                            }
                        });
                    }
                }
            });
        }

        function showMatchResult(targetNode, matchResults) {
            const title = targetNode.getAttribute('data-title');
            const intro = targetNode.getAttribute('data-intro');
            const responsibilities = targetNode.getAttribute('data-responsibilities');
            const goals = targetNode.getAttribute('data-goals');
            const tags = JSON.parse(targetNode.getAttribute('data-tags'));

            const sortedResults = matchResults.sort((a, b) => b.score - a.score).slice(0, 5);

            const resultContent = `
                <div style="animation: fadeIn 0.5s ease;">
                    <div style="background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px;">🎯 推荐岗位</div>
                        <div style="font-size: 24px; font-weight: bold;">${title}</div>
                    </div>

                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="font-weight: bold; color: #333; margin-bottom: 10px;">📋 职位介绍</div>
                        <div style="color: #666; line-height: 1.6;">${intro}</div>
                    </div>

                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="font-weight: bold; color: #333; margin-bottom: 10px;">💼 核心职责</div>
                        <div style="color: #666; line-height: 1.6;">${responsibilities}</div>
                    </div>

                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="font-weight: bold; color: #333; margin-bottom: 10px;">🎯 核心目标</div>
                        <div style="color: #666; line-height: 1.6;">${goals}</div>
                    </div>

                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="font-weight: bold; color: #333; margin-bottom: 10px;">🏷️ 职业调性关键词</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${tags.map(tag => `
                                <span style="padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; 
                                    ${tag.type === 'subjective' ? 'background: #ffebee; color: #c62828;' : ''}
                                    ${tag.type === 'objective' ? 'background: #e3f2fd; color: #1565c0;' : ''}
                                    ${tag.type === 'abstract' ? 'background: #f3e5f5; color: #6a1b9a;' : ''}
                                    ${tag.type === 'concrete' ? 'background: #e8f5e9; color: #2e7d32;' : ''}
                                    ${tag.type === 'cause' ? 'background: #fff3e0; color: #ef6c00;' : ''}
                                    ${tag.type === 'result' ? 'background: #fce4ec; color: #c2185b;' : ''}
                                    ${tag.type === 'intangible' ? 'background: #e0f7fa; color: #00838f;' : ''}
                                    ${tag.type === 'tangible' ? 'background: #f1f8e9; color: #558b2f;' : ''}">
                                    ${tag.name}
                                </span>
                            `).join('')}
                        </div>
                    </div>

                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; border-left: 4px solid #ff6b35;">
                        <div style="font-weight: bold; color: #333; margin-bottom: 10px;">📊 匹配度排名</div>
                        ${sortedResults.map((result, index) => `
                            <div style="display: flex; align-items: center; margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                                <div style="width: 24px; height: 24px; background: ${index === 0 ? '#c8102e' : '#ddd'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; margin-right: 10px;">${index + 1}</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: bold; color: #333;">${result.node.getAttribute('data-title')}</div>
                                    <div style="font-size: 12px; color: #666;">匹配关键词: ${result.matchedKeywords.join(', ')}</div>
                                </div>
                                <div style="font-weight: bold; color: #c8102e;">${result.score}分</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.getElementById('qaResultContent').innerHTML = resultContent;
            document.getElementById('qaInputArea').style.display = 'none';
            document.getElementById('qaResultArea').style.display = 'block';

            const resetButton = document.createElement('button');
            resetButton.textContent = '重新查询';
            resetButton.style.cssText = 'width: 100%; padding: 12px; background: #f5f5f5; color: #333; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 15px; transition: all 0.3s ease;';
            resetButton.onclick = function() {
                document.getElementById('qaInput').value = '';
                document.getElementById('qaInputArea').style.display = 'block';
                document.getElementById('qaResultArea').style.display = 'none';
                const allNodes = document.querySelectorAll('.node');
                allNodes.forEach(node => {
                    node.classList.remove('selected', 'related-active');
                });
            };
            document.getElementById('qaResultContent').appendChild(resetButton);
        }

        // 绘制连接线
        function drawConnections() {
            const connectionsSvg = document.getElementById('connections');
            const ceoNode = document.querySelector('.ceo-node');
            const cooNode = document.querySelector('.coo-node');
            const subNodes = document.querySelectorAll('.coo-node, .cto-node, .cpo-node, .chro-node');
            const cooSubNodes = document.querySelectorAll('.f-node, .g-node, .c-node, .e-node, .pa-node, .td-node, .dc-node, .ob-node, .hr-node, .pb-node');
            
            if (!ceoNode || subNodes.length === 0) return;
            
            const graphWidth = 3000;
            const graphHeight = 3000;
            const nodeRadius = 60;
            const subNodeRadius = 45;
            const supportNodeRadius = 37.5;
            const lineSpacing = 8; // 两条平行线之间的间距
            
            const ceoRelationships = JSON.parse(ceoNode.getAttribute('data-relationships'));
            
            let pathsHtml = '';
            let labelsHtml = '';
            
            if (!ceoRelationships || !Array.isArray(ceoRelationships)) {
                console.error('Invalid relationships data');
                return;
            }
            
            const ceoLeft = 50;
            const ceoTop = 50;
            
            const ceoX = (ceoLeft / 100) * graphWidth;
            const ceoY = (ceoTop / 100) * graphHeight;
            
            ceoRelationships.forEach(rel => {
                const targetNode = document.querySelector(`.${rel.target}`);
                if (!targetNode) return;
                
                const nodeStyle = targetNode.style;
                const nodeLeft = parseFloat(nodeStyle.left);
                const nodeTop = parseFloat(nodeStyle.top);
                
                const nodeX = (nodeLeft / 100) * graphWidth;
                const nodeY = (nodeTop / 100) * graphHeight;
                
                const dx = nodeX - ceoX;
                const dy = nodeY - ceoY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                const unitX = dx / distance;
                const unitY = dy / distance;
                
                // 垂直于连接线的单位向量（用于计算平行线）
                const perpX = -unitY;
                const perpY = unitX;
                
                // 计算两条平行线的起点和终点
                const ceoCircleX1 = ceoX + unitX * nodeRadius + perpX * lineSpacing / 2;
                const ceoCircleY1 = ceoY + unitY * nodeRadius + perpY * lineSpacing / 2;
                const ceoCircleX2 = ceoX + unitX * nodeRadius - perpX * lineSpacing / 2;
                const ceoCircleY2 = ceoY + unitY * nodeRadius - perpY * lineSpacing / 2;
                
                const nodeCircleX1 = nodeX - unitX * nodeRadius + perpX * lineSpacing / 2;
                const nodeCircleY1 = nodeY - unitY * nodeRadius + perpY * lineSpacing / 2;
                const nodeCircleX2 = nodeX - unitX * nodeRadius - perpX * lineSpacing / 2;
                const nodeCircleY2 = nodeY - unitY * nodeRadius - perpY * lineSpacing / 2;
                
                // 计算标签位置（每条线的3/5位置）
                const forwardLabelX = ceoX + (nodeX - ceoX) * 0.6;
                const forwardLabelY = ceoY + (nodeY - ceoY) * 0.6;
                const backwardLabelX = nodeX + (ceoX - nodeX) * 0.6;
                const backwardLabelY = nodeY + (ceoY - nodeY) * 0.6;
                
                // 绘制两条平行线
                pathsHtml += `<path d="M ${ceoCircleX1} ${ceoCircleY1} L ${nodeCircleX1} ${nodeCircleY1}" fill="none" stroke="rgba(200, 16, 46, 0.4)" stroke-width="2" marker-end="url(#arrowhead-red)" />`;
                pathsHtml += `<path d="M ${nodeCircleX2} ${nodeCircleY2} L ${ceoCircleX2} ${ceoCircleY2}" fill="none" stroke="rgba(255, 107, 53, 0.4)" stroke-width="2" marker-end="url(#arrowhead-orange)" />`;
                
                // 添加标签
                labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
            });
            
            if (cooNode && cooSubNodes.length > 0) {
                const cooStyle = cooNode.style;
                const cooLeft = parseFloat(cooStyle.left);
                const cooTop = parseFloat(cooStyle.top);
                
                const cooX = (cooLeft / 100) * graphWidth;
                const cooY = (cooTop / 100) * graphHeight;
                
                cooSubNodes.forEach(subNode => {
                    const subNodeStyle = subNode.style;
                    const subNodeLeft = parseFloat(subNodeStyle.left);
                    const subNodeTop = parseFloat(subNodeStyle.top);
                    
                    const subNodeX = (subNodeLeft / 100) * graphWidth;
                    const subNodeY = (subNodeTop / 100) * graphHeight;
                    
                    const subRelationships = JSON.parse(subNode.getAttribute('data-relationships'));
                    
                    if (subRelationships && Array.isArray(subRelationships)) {
                        subRelationships.forEach(rel => {
                            if (rel.target !== 'coo-node') return;
                            
                            const dx = cooX - subNodeX;
                            const dy = cooY - subNodeY;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            const unitX = dx / distance;
                            const unitY = dy / distance;
                            
                            // 垂直于连接线的单位向量
                            const perpX = -unitY;
                            const perpY = unitX;
                            
                            // 计算两条平行线的起点和终点
                            const subCircleX1 = subNodeX + unitX * subNodeRadius + perpX * lineSpacing / 2;
                            const subCircleY1 = subNodeY + unitY * subNodeRadius + perpY * lineSpacing / 2;
                            const subCircleX2 = subNodeX + unitX * subNodeRadius - perpX * lineSpacing / 2;
                            const subCircleY2 = subNodeY + unitY * subNodeRadius - perpY * lineSpacing / 2;
                            
                            const cooCircleX1 = cooX - unitX * nodeRadius + perpX * lineSpacing / 2;
                            const cooCircleY1 = cooY - unitY * nodeRadius + perpY * lineSpacing / 2;
                            const cooCircleX2 = cooX - unitX * nodeRadius - perpX * lineSpacing / 2;
                            const cooCircleY2 = cooY - unitY * nodeRadius - perpY * lineSpacing / 2;
                            
                            // 计算标签位置（每条线的3/5位置）
                            const forwardLabelX = subNodeX + (cooX - subNodeX) * 0.6;
                            const forwardLabelY = subNodeY + (cooY - subNodeY) * 0.6;
                            const backwardLabelX = cooX + (subNodeX - cooX) * 0.6;
                            const backwardLabelY = cooY + (subNodeY - cooY) * 0.6;
                            
                            // 绘制两条平行线
                            pathsHtml += `<path d="M ${subCircleX1} ${subCircleY1} L ${cooCircleX1} ${cooCircleY1}" fill="none" stroke="rgba(255, 138, 128, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-red)" />`;
                            pathsHtml += `<path d="M ${cooCircleX2} ${cooCircleY2} L ${subCircleX2} ${subCircleY2}" fill="none" stroke="rgba(255, 171, 145, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-orange)" />`;
                            
                            // 添加标签
                            labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                            labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
                        });
                    }
                });
            }
            
            // 处理CTO与数据中心、产品架构组、技术开发中心的连接
            const ctoNode = document.querySelector('.cto-node');
            if (ctoNode && cooSubNodes.length > 0) {
                const ctoStyle = ctoNode.style;
                const ctoLeft = parseFloat(ctoStyle.left);
                const ctoTop = parseFloat(ctoStyle.top);
                
                const ctoX = (ctoLeft / 100) * graphWidth;
                const ctoY = (ctoTop / 100) * graphHeight;
                
                cooSubNodes.forEach(subNode => {
                    const subNodeStyle = subNode.style;
                    const subNodeLeft = parseFloat(subNodeStyle.left);
                    const subNodeTop = parseFloat(subNodeStyle.top);
                    
                    const subNodeX = (subNodeLeft / 100) * graphWidth;
                    const subNodeY = (subNodeTop / 100) * graphHeight;
                    
                    const subRelationships = JSON.parse(subNode.getAttribute('data-relationships'));
                    
                    if (subRelationships && Array.isArray(subRelationships)) {
                        subRelationships.forEach(rel => {
                            if (rel.target !== 'cto-node') return;
                            
                            const dx = ctoX - subNodeX;
                            const dy = ctoY - subNodeY;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            const unitX = dx / distance;
                            const unitY = dy / distance;
                            
                            // 垂直于连接线的单位向量
                            const perpX = -unitY;
                            const perpY = unitX;
                            
                            // 计算两条平行线的起点和终点
                            const subCircleX1 = subNodeX + unitX * subNodeRadius + perpX * lineSpacing / 2;
                            const subCircleY1 = subNodeY + unitY * subNodeRadius + perpY * lineSpacing / 2;
                            const subCircleX2 = subNodeX + unitX * subNodeRadius - perpX * lineSpacing / 2;
                            const subCircleY2 = subNodeY + unitY * subNodeRadius - perpY * lineSpacing / 2;
                            
                            const ctoCircleX1 = ctoX - unitX * nodeRadius + perpX * lineSpacing / 2;
                            const ctoCircleY1 = ctoY - unitY * nodeRadius + perpY * lineSpacing / 2;
                            const ctoCircleX2 = ctoX - unitX * nodeRadius - perpX * lineSpacing / 2;
                            const ctoCircleY2 = ctoY - unitY * nodeRadius - perpY * lineSpacing / 2;
                            
                            // 计算标签位置（每条线的3/5位置）
                            const forwardLabelX = subNodeX + (ctoX - subNodeX) * 0.6;
                            const forwardLabelY = subNodeY + (ctoY - subNodeY) * 0.6;
                            const backwardLabelX = ctoX + (subNodeX - ctoX) * 0.6;
                            const backwardLabelY = ctoY + (subNodeY - ctoY) * 0.6;
                            
                            // 绘制两条平行线
                            pathsHtml += `<path d="M ${subCircleX1} ${subCircleY1} L ${ctoCircleX1} ${ctoCircleY1}" fill="none" stroke="rgba(255, 138, 128, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-red)" />`;
                            pathsHtml += `<path d="M ${ctoCircleX2} ${ctoCircleY2} L ${subCircleX2} ${subCircleY2}" fill="none" stroke="rgba(255, 171, 145, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-orange)" />`;
                            
                            // 添加标签
                            labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                            labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
                        });
                    }
                });
            }
            
            // 处理CPO与产品架构组的连接
            const cpoNode = document.querySelector('.cpo-node');
            if (cpoNode && cooSubNodes.length > 0) {
                const cpoStyle = cpoNode.style;
                const cpoLeft = parseFloat(cpoStyle.left);
                const cpoTop = parseFloat(cpoStyle.top);
                
                const cpoX = (cpoLeft / 100) * graphWidth;
                const cpoY = (cpoTop / 100) * graphHeight;
                
                cooSubNodes.forEach(subNode => {
                    const subNodeStyle = subNode.style;
                    const subNodeLeft = parseFloat(subNodeStyle.left);
                    const subNodeTop = parseFloat(subNodeStyle.top);
                    
                    const subNodeX = (subNodeLeft / 100) * graphWidth;
                    const subNodeY = (subNodeTop / 100) * graphHeight;
                    
                    const subRelationships = JSON.parse(subNode.getAttribute('data-relationships'));
                    
                    if (subRelationships && Array.isArray(subRelationships)) {
                        subRelationships.forEach(rel => {
                            if (rel.target !== 'cpo-node') return;
                            
                            const dx = cpoX - subNodeX;
                            const dy = cpoY - subNodeY;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            const unitX = dx / distance;
                            const unitY = dy / distance;
                            
                            // 垂直于连接线的单位向量
                            const perpX = -unitY;
                            const perpY = unitX;
                            
                            // 计算两条平行线的起点和终点
                            const subCircleX1 = subNodeX + unitX * subNodeRadius + perpX * lineSpacing / 2;
                            const subCircleY1 = subNodeY + unitY * subNodeRadius + perpY * lineSpacing / 2;
                            const subCircleX2 = subNodeX + unitX * subNodeRadius - perpX * lineSpacing / 2;
                            const subCircleY2 = subNodeY + unitY * subNodeRadius - perpY * lineSpacing / 2;
                            
                            const cpoCircleX1 = cpoX - unitX * nodeRadius + perpX * lineSpacing / 2;
                            const cpoCircleY1 = cpoY - unitY * nodeRadius + perpY * lineSpacing / 2;
                            const cpoCircleX2 = cpoX - unitX * nodeRadius - perpX * lineSpacing / 2;
                            const cpoCircleY2 = cpoY - unitY * nodeRadius - perpY * lineSpacing / 2;
                            
                            // 计算标签位置（每条线的3/5位置）
                            const forwardLabelX = subNodeX + (cpoX - subNodeX) * 0.6;
                            const forwardLabelY = subNodeY + (cpoY - subNodeY) * 0.6;
                            const backwardLabelX = cpoX + (subNodeX - cpoX) * 0.6;
                            const backwardLabelY = cpoY + (subNodeY - cpoY) * 0.6;
                            
                            // 绘制两条平行线
                            pathsHtml += `<path d="M ${subCircleX1} ${subCircleY1} L ${cpoCircleX1} ${cpoCircleY1}" fill="none" stroke="rgba(255, 138, 128, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-red)" />`;
                            pathsHtml += `<path d="M ${cpoCircleX2} ${cpoCircleY2} L ${subCircleX2} ${subCircleY2}" fill="none" stroke="rgba(255, 171, 145, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-orange)" />`;
                            
                            // 添加标签
                            labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                            labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
                        });
                    }
                });
            }
            
            // 处理CHRO与子节点的连接
            const chroNode = document.querySelector('.chro-node');
            if (chroNode && cooSubNodes.length > 0) {
                const chroStyle = chroNode.style;
                const chroLeft = parseFloat(chroStyle.left);
                const chroTop = parseFloat(chroStyle.top);
                
                const chroX = (chroLeft / 100) * graphWidth;
                const chroY = (chroTop / 100) * graphHeight;
                
                cooSubNodes.forEach(subNode => {
                    const subNodeStyle = subNode.style;
                    const subNodeLeft = parseFloat(subNodeStyle.left);
                    const subNodeTop = parseFloat(subNodeStyle.top);
                    
                    const subNodeX = (subNodeLeft / 100) * graphWidth;
                    const subNodeY = (subNodeTop / 100) * graphHeight;
                    
                    const subRelationships = JSON.parse(subNode.getAttribute('data-relationships'));
                    
                    if (subRelationships && Array.isArray(subRelationships)) {
                        subRelationships.forEach(rel => {
                            if (rel.target !== 'chro-node') return;
                            
                            const dx = chroX - subNodeX;
                            const dy = chroY - subNodeY;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            const unitX = dx / distance;
                            const unitY = dy / distance;
                            
                            // 垂直于连接线的单位向量
                            const perpX = -unitY;
                            const perpY = unitX;
                            
                            // 计算两条平行线的起点和终点
                            const subCircleX1 = subNodeX + unitX * subNodeRadius + perpX * lineSpacing / 2;
                            const subCircleY1 = subNodeY + unitY * subNodeRadius + perpY * lineSpacing / 2;
                            const subCircleX2 = subNodeX + unitX * subNodeRadius - perpX * lineSpacing / 2;
                            const subCircleY2 = subNodeY + unitY * subNodeRadius - perpY * lineSpacing / 2;
                            
                            const chroCircleX1 = chroX - unitX * nodeRadius + perpX * lineSpacing / 2;
                            const chroCircleY1 = chroY - unitY * nodeRadius + perpY * lineSpacing / 2;
                            const chroCircleX2 = chroX - unitX * nodeRadius - perpX * lineSpacing / 2;
                            const chroCircleY2 = chroY - unitY * nodeRadius - perpY * lineSpacing / 2;
                            
                            // 计算标签位置（每条线的3/5位置）
                            const forwardLabelX = subNodeX + (chroX - subNodeX) * 0.6;
                            const forwardLabelY = subNodeY + (chroY - subNodeY) * 0.6;
                            const backwardLabelX = chroX + (subNodeX - chroX) * 0.6;
                            const backwardLabelY = chroY + (subNodeY - chroY) * 0.6;
                            
                            // 绘制两条平行线
                            pathsHtml += `<path d="M ${subCircleX1} ${subCircleY1} L ${chroCircleX1} ${chroCircleY1}" fill="none" stroke="rgba(255, 138, 128, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-red)" />`;
                            pathsHtml += `<path d="M ${chroCircleX2} ${chroCircleY2} L ${subCircleX2} ${subCircleY2}" fill="none" stroke="rgba(255, 171, 145, 0.4)" stroke-width="2" marker-end="url(#arrowhead-light-orange)" />`;
                            
                            // 添加标签
                            labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                            labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
                        });
                    }
                });
            }
            
            const supportNodes = document.querySelectorAll('.support-node');
            if (supportNodes.length > 0) {
                supportNodes.forEach(supportNode => {
                    const supportNodeStyle = supportNode.style;
                    const supportNodeLeft = parseFloat(supportNodeStyle.left);
                    const supportNodeTop = parseFloat(supportNodeStyle.top);
                    
                    const supportNodeX = (supportNodeLeft / 100) * graphWidth;
                    const supportNodeY = (supportNodeTop / 100) * graphHeight;
                    
                    const supportRelationships = JSON.parse(supportNode.getAttribute('data-relationships'));
                    
                    if (supportRelationships && Array.isArray(supportRelationships)) {
                        supportRelationships.forEach(rel => {
                            const parentNode = document.querySelector(`.${rel.target}`);
                            if (!parentNode) return;
                            
                            const parentStyle = parentNode.style;
                            const parentLeft = parseFloat(parentStyle.left);
                            const parentTop = parseFloat(parentStyle.top);
                            
                            const parentX = (parentLeft / 100) * graphWidth;
                            const parentY = (parentTop / 100) * graphHeight;
                            
                            const dx = parentX - supportNodeX;
                            const dy = parentY - supportNodeY;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            const unitX = dx / distance;
                            const unitY = dy / distance;
                            
                            // 垂直于连接线的单位向量
                            const perpX = -unitY;
                            const perpY = unitX;
                            
                            // 计算两条平行线的起点和终点
                            const supportCircleX1 = supportNodeX + unitX * supportNodeRadius + perpX * lineSpacing / 2;
                            const supportCircleY1 = supportNodeY + unitY * supportNodeRadius + perpY * lineSpacing / 2;
                            const supportCircleX2 = supportNodeX + unitX * supportNodeRadius - perpX * lineSpacing / 2;
                            const supportCircleY2 = supportNodeY + unitY * supportNodeRadius - perpY * lineSpacing / 2;
                            
                            const parentCircleX1 = parentX - unitX * subNodeRadius + perpX * lineSpacing / 2;
                            const parentCircleY1 = parentY - unitY * subNodeRadius + perpY * lineSpacing / 2;
                            const parentCircleX2 = parentX - unitX * subNodeRadius - perpX * lineSpacing / 2;
                            const parentCircleY2 = parentY - unitY * subNodeRadius - perpY * lineSpacing / 2;
                            
                            // 计算标签位置（每条线的3/5位置）
                            const forwardLabelX = supportNodeX + (parentX - supportNodeX) * 0.6;
                            const forwardLabelY = supportNodeY + (parentY - supportNodeY) * 0.6;
                            const backwardLabelX = parentX + (supportNodeX - parentX) * 0.6;
                            const backwardLabelY = parentY + (supportNodeY - parentY) * 0.6;
                            
                            // 绘制两条平行线
                            pathsHtml += `<path d="M ${supportCircleX1} ${supportCircleY1} L ${parentCircleX1} ${parentCircleY1}" fill="none" stroke="rgba(255, 171, 145, 0.4)" stroke-width="2" marker-end="url(#arrowhead-pale-red)" />`;
                            pathsHtml += `<path d="M ${parentCircleX2} ${parentCircleY2} L ${supportCircleX2} ${supportCircleY2}" fill="none" stroke="rgba(255, 204, 188, 0.4)" stroke-width="2" marker-end="url(#arrowhead-pale-orange)" />`;
                            
                            // 添加标签
                            labelsHtml += `<text x="${forwardLabelX}" y="${forwardLabelY - 5}" text-anchor="middle" class="connection-label">${rel.forward}</text>`;
                            labelsHtml += `<text x="${backwardLabelX}" y="${backwardLabelY + 10}" text-anchor="middle" class="connection-label">${rel.backward}</text>`;
                        });
                    }
                });
            }
            
            connectionsSvg.innerHTML = `
                <defs>
                    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(200, 16, 46, 0.4)" />
                    </marker>
                    <marker id="arrowhead-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 107, 53, 0.4)" />
                    </marker>
                    <marker id="arrowhead-light-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 138, 128, 0.4)" />
                    </marker>
                    <marker id="arrowhead-light-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 171, 145, 0.4)" />
                    </marker>
                    <marker id="arrowhead-pale-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 171, 145, 0.4)" />
                    </marker>
                    <marker id="arrowhead-pale-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255, 204, 188, 0.4)" />
                    </marker>
                </defs>
                ${pathsHtml}
                ${labelsHtml}
            `;
        }

        // 画布交互功能
        const canvasWrapper = document.getElementById('canvasWrapper');
        const knowledgeGraph = document.getElementById('knowledgeGraph');
        let scale = 1;
        let translateX = 0;
        let translateY = 0;
        let isDragging = false;
        let startX, startY;
        let lastTranslateX = 0;
        let lastTranslateY = 0;

        // 拖动功能
        knowledgeGraph.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('node') || e.target.classList.contains('node-text')) {
                return;
            }
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            lastTranslateX = translateX;
            lastTranslateY = translateY;
            knowledgeGraph.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            translateX = lastTranslateX + deltaX;
            translateY = lastTranslateY + deltaY;
            updateCanvasTransform();
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            knowledgeGraph.style.cursor = 'grab';
        });

        // 缩放功能
        canvasWrapper.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            const newScale = scale * delta;
            
            if (newScale >= 0.3 && newScale <= 3) {
                scale = newScale;
                updateCanvasTransform();
            }
        });

        function updateCanvasTransform() {
            knowledgeGraph.style.transform = `translate(calc(-50% + ${translateX}px), calc(-50% + ${translateY}px)) scale(${scale})`;
            drawConnections();
        }

        // 页面加载完成后绘制连接线
        window.addEventListener('load', () => {
            setTimeout(drawConnections, 100);
        });

        // 监听窗口大小变化
        window.addEventListener('resize', () => {
            drawConnections();
        });

        initBookshelf();

        // 会议文档数据
        const meetingDocuments = {
            1: {
                title: '董事会会议纪要',
                date: '2026-01-15',
                time: '14:00-16:30',
                location: '公司会议室A',
                attendees: '董事会成员、CEO、CFO',
                content: '本次董事会会议主要讨论了公司2026年度战略规划、财务预算、高管任免等重要事项。会议一致通过了公司新的战略发展方向，批准了2026年度财务预算，并对部分高管职位进行了调整。会议强调，公司将继续加强核心业务的发展，同时积极探索新的业务增长点，确保公司可持续发展。',
                attachments: '会议议程、财务报告、战略规划文档'
            },
            2: {
                title: '季度业务回顾',
                date: '2026-01-20',
                time: '10:00-12:00',
                location: '公司会议室B',
                attendees: '各部门负责人、CEO',
                content: '本次季度业务回顾会议总结了上季度各部门的工作成果和存在的问题，分析了市场形势和竞争对手动态，并对本季度的工作重点进行了部署。会议要求各部门要加强协作，提高执行力，确保完成本季度的各项工作目标。',
                attachments: '季度业务报告、市场分析报告'
            },
            3: {
                title: '年度战略规划',
                date: '2026-01-10',
                time: '09:00-12:30',
                location: '公司大会议室',
                attendees: '高管团队、战略规划部',
                content: '本次年度战略规划会议制定了公司2026年度的战略目标和实施路径，包括市场拓展、产品创新、技术研发、人才培养等方面的具体规划。会议强调，公司要以客户为中心，以创新为驱动，不断提升核心竞争力，实现公司的长期发展目标。',
                attachments: '战略规划文档、市场调研数据'
            },
            4: {
                title: '产品 roadmap 讨论',
                date: '2026-01-25',
                time: '13:30-15:30',
                location: '产品部会议室',
                attendees: '产品团队、研发团队、市场团队',
                content: '本次产品roadmap讨论会议梳理了现有产品的发展状况，讨论了新产品的研发计划和时间节点，并对产品功能优先级进行了排序。会议要求产品团队要密切关注市场需求和用户反馈，不断优化产品设计，提高产品的市场竞争力。',
                attachments: '产品roadmap文档、用户反馈报告'
            },
            5: {
                title: '财务预算评审',
                date: '2026-01-05',
                time: '14:00-16:00',
                location: '财务部会议室',
                attendees: '高管团队、财务部、各部门负责人',
                content: '本次财务预算评审会议对各部门提交的2026年度预算进行了审核和调整，确保预算的合理性和可行性。会议要求各部门要严格控制成本，提高资金使用效率，确保公司财务状况的健康稳定。',
                attachments: '2026年度预算草案、财务分析报告'
            },
            6: {
                title: '人才发展规划',
                date: '2026-01-18',
                time: '15:00-17:00',
                location: '人力资源部会议室',
                attendees: '高管团队、人力资源部、各部门负责人',
                content: '本次人才发展规划会议分析了公司当前的人才状况，制定了2026年度的人才招聘、培养和激励计划。会议强调，公司要加强人才队伍建设，优化人才结构，为公司的发展提供强有力的人才支撑。',
                attachments: '人才发展规划文档、人力资源分析报告'
            },
            7: {
                title: '技术架构评审',
                date: '2026-01-22',
                time: '10:30-12:30',
                location: '技术部会议室',
                attendees: '技术团队、产品团队、CTO',
                content: '本次技术架构评审会议对公司现有系统的技术架构进行了评估，讨论了技术升级和架构优化的方案，并对新技术的应用进行了探讨。会议要求技术团队要不断提升技术能力，确保系统的稳定性和可扩展性，为业务发展提供有力的技术支持。',
                attachments: '技术架构评估报告、技术升级方案'
            }
        };

        // 打开会议文档
        function openMeetingDocument(documentId) {
            // 添加飞出动画
            const documentSlot = document.querySelector(`.document-slot[data-document="${documentId}"]`);
            if (documentSlot) {
                documentSlot.classList.add('flying');
                
                // 动画结束后移除类
                setTimeout(() => {
                    documentSlot.classList.remove('flying');
                }, 1000);
            }
            
            // 获取文档数据
            const documentData = meetingDocuments[documentId];
            if (!documentData) return;
            
            // 更新文档详情
            const documentDetailsBody = document.getElementById('documentDetailsBody');
            if (documentDetailsBody) {
                documentDetailsBody.innerHTML = `
                    <div class="document-content">
                        <h4>${documentData.title}</h4>
                        <p>${documentData.content}</p>
                        <div class="meta-info">
                            <div class="meta-item">
                                <span class="icon">📅</span>
                                <span>日期：${documentData.date}</span>
                            </div>
                            <div class="meta-item">
                                <span class="icon">⏰</span>
                                <span>时间：${documentData.time}</span>
                            </div>
                            <div class="meta-item">
                                <span class="icon">📍</span>
                                <span>地点：${documentData.location}</span>
                            </div>
                            <div class="meta-item">
                                <span class="icon">👥</span>
                                <span>参会人员：${documentData.attendees}</span>
                            </div>
                            <div class="meta-item">
                                <span class="icon">📎</span>
                                <span>附件：${documentData.attachments}</span>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // 关闭会议文档
        function closeMeetingDocument() {
            const documentDetailsBody = document.getElementById('documentDetailsBody');
            if (documentDetailsBody) {
                documentDetailsBody.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">📄</div>
                        <p>请从左侧选择一个会议文档查看详情</p>
                    </div>
                `;
            }
        }

        // 处理URL参数，显示移动端海报
        function handleSharePage() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('page') === 'share') {
                const issue = urlParams.get('issue');
                const date = urlParams.get('date');
                
                if (issue) {
                    // 查找对应的日报
                    const newspaper = newspapers.find(np => np.issue === issue);
                    if (newspaper) {
                        // 创建移动端海报页面
                        createMobilePoster(newspaper);
                    }
                }
            }
        }

        // 创建移动端海报页面
        function createMobilePoster(newspaper) {
            // 清空页面内容
            document.body.innerHTML = '';
            
            // 添加移动端海报样式
            const style = document.createElement('style');
            style.textContent = `
                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }
                
                body {
                    font-family: 'SimHei', 'Microsoft YaHei', sans-serif;
                    background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
                    min-height: 100vh;
                    padding: 20px;
                }
                
                .mobile-poster {
                    max-width: 400px;
                    margin: 0 auto;
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                    overflow: hidden;
                    animation: fadeIn 1s ease-out;
                }
                
                .poster-header {
                    background: linear-gradient(90deg, #c8102e 0%, #ff6b35 100%);
                    color: white;
                    padding: 30px 20px;
                    text-align: center;
                    animation: slideDown 0.8s ease-out;
                }
                
                .poster-title {
                    font-size: 24px;
                    font-weight: bold;
                    margin-bottom: 10px;
                }
                
                .poster-issue {
                    font-size: 16px;
                    opacity: 0.9;
                }
                
                .poster-date {
                    font-size: 14px;
                    opacity: 0.8;
                    margin-top: 5px;
                }
                
                .poster-content {
                    padding: 20px;
                    animation: slideUp 0.8s ease-out 0.3s both;
                }
                
                .section {
                    margin-bottom: 30px;
                }
                
                .section-title {
                    font-size: 18px;
                    font-weight: bold;
                    color: #c8102e;
                    margin-bottom: 15px;
                    padding-bottom: 8px;
                    border-bottom: 2px solid #f0f0f0;
                }
                
                .news-item {
                    margin-bottom: 20px;
                }
                
                .news-item h4 {
                    font-size: 16px;
                    font-weight: bold;
                    margin-bottom: 10px;
                    color: #333;
                }
                
                .news-item p {
                    font-size: 14px;
                    line-height: 1.6;
                    color: #666;
                }
                
                .news-item .author {
                    font-size: 12px;
                    color: #999;
                    margin-top: 10px;
                    text-align: right;
                }
                
                .media-placeholder {
                    margin: 15px 0;
                    padding: 40px 20px;
                    background: #f5f5f5;
                    border-radius: 8px;
                    text-align: center;
                }
                
                .media-placeholder .icon {
                    font-size: 48px;
                    margin-bottom: 10px;
                }
                
                .media-placeholder img {
                    max-width: 100%;
                    border-radius: 8px;
                }
                
                .tags {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 8px;
                    margin-top: 15px;
                }
                
                .tag {
                    background: linear-gradient(135deg, #c8102e 0%, #ff6b35 100%);
                    color: white;
                    padding: 4px 12px;
                    border-radius: 12px;
                    font-size: 12px;
                }
                
                @keyframes fadeIn {
                    from {
                        opacity: 0;
                        transform: scale(0.9);
                    }
                    to {
                        opacity: 1;
                        transform: scale(1);
                    }
                }
                
                @keyframes slideDown {
                    from {
                        opacity: 0;
                        transform: translateY(-50px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                @keyframes slideUp {
                    from {
                        opacity: 0;
                        transform: translateY(50px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                @media (max-width: 375px) {
                    body {
                        padding: 10px;
                    }
                    
                    .mobile-poster {
                        margin: 0;
                    }
                    
                    .poster-header {
                        padding: 20px 15px;
                    }
                    
                    .poster-content {
                        padding: 15px;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // 创建海报HTML
            let html = `
                <div class="mobile-poster">
                    <div class="poster-header">
                        <img src="images/9161e9ab-5cac-4f69-b57f-2ca6970b1429.png" alt="智启侨乡日报" style="height:24px; width:auto; margin:0;">
                        <div class="poster-issue">第 ${newspaper.issue} 期</div>
                        <div class="poster-date">${newspaper.date}</div>
                    </div>
                    <div class="poster-content">
                        <div class="section">
                            <div class="section-title">📖 学习专栏</div>
            `;
            
            // 添加学习专栏内容
            newspaper.partyCulture.forEach((item, idx) => {
                html += `
                    <div class="news-item">
                        <h4>${item.title}</h4>
                        <p>${item.content}</p>
                        ${item.author ? `<div class="author">—— ${item.author}</div>` : ''}
                        ${item.media.src ? `<div class="media-placeholder"><img src="${item.media.src}" alt="${item.media.label}"></div>` : ''}
                    </div>
                `;
            });
            
            html += `
                        </div>
                        <div class="section">
                            <div class="section-title">🏢 组织动态</div>
            `;
            
            // 添加组织动态内容
            newspaper.organizationNews.forEach((item, idx) => {
                html += `
                    <div class="news-item">
                        <h4>${item.title}</h4>
                        <p>${item.content}</p>
                        ${item.author ? `<div class="author">—— ${item.author}</div>` : ''}
                        ${item.media.src ? `<div class="media-placeholder"><img src="${item.media.src}" alt="${item.media.label}"></div>` : ''}
                    </div>
                `;
            });
            
            html += `
                        </div>
                        <div class="section">
                            <div class="section-title">🏆 实践题</div>
                            <div class="news-item">
                                <h4>${newspaper.quiz.title}</h4>
                                <p>${newspaper.quiz.question}</p>
                                ${newspaper.quiz.options.map((option, idx) => `
                                    <p>${String.fromCharCode(65 + idx)}. ${option}</p>
                                `).join('')}
                            </div>
                        </div>
                        <div class="section">
                            <div class="section-title">🏷️ 标签</div>
                            <div class="tags">
                                ${newspaper.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.innerHTML = html;
        }

        // 页面加载时处理URL参数
        window.addEventListener('load', () => {
            handleSharePage();
        });
    </script>
</body>
</html>